<script type="text/javascript">
	var classActionMap = new Map();

	const SUPPORTED_G2S_CLASSES = [	{value:"G2S_adr", text:"G2S_adr"},
									{value:"G2S_cabinet", text:"G2S_cabinet"},
									{value:"G2S_communications", text:"G2S_communications"},
									{value:"G2S_eventHandler", text:"G2S_eventHandler"},
									{value:"G2S_meters", text:"G2S_meters"},
									{value:"G2S_gamePlay", text:"G2S_gamePlay"},
									{value:"G2S_commConfig", text:"G2S_commConfig"},
									{value:"G2S_optionConfig", text:"G2S_optionConfig"},
									{value:"G2S_download", text:"G2S_download"},
									{value:"G2S_handpay", text:"G2S_handpay"},
									{value:"G2S_coinAcceptor", text:"G2S_coinAcceptor"},
									{value:"G2S_noteAcceptor", text:"G2S_noteAcceptor"},
									{value:"G2S_hopper", text:"G2S_hopper"},
									{value:"G2S_noteDispenser", text:"G2S_noteDispenser"},
									{value:"G2S_printer", text:"G2S_printer"},
									{value:"G2S_progressive", text:"G2S_progressive"},
									{value:"G2S_idReader", text:"G2S_idReader"},
									{value:"G2S_bonus", text:"G2S_bonus"},
									{value:"G2S_player", text:"G2S_player"},
									{value:"G2S_voucher", text:"G2S_voucher"},
									{value:"G2S_wat", text:"G2S_wat"},
									{value:"G2S_gat", text:"G2S_gat"},
									{value:"G2S_central", text:"G2S_central"},
									{value:"G2S_storage", text:"G2S_storage"},
									{value:"G2S_informedPlayer", text:"G2S_informedPlayer"},
									{value:"G2S_gameTheme", text:"G2S_gameTheme"},
									{value:"G2S_auditMeter", text:"G2S_auditMeter"},
									{value:"G2S_employee", text:"G2S_employee"},
									{value:"G2S_tournament", text:"G2S_tournament"},
									{value:"G2S_hardware", text:"G2S_hardware"},
									{value:"G2S_dft", text:"G2S_dft"},
									{value:"G2S_spc", text:"G2S_spc"},
									{value:"G2S_mystery", text:"G2S_mystery"},
									{value:"G2S_sign", text:"G2S_sign"},
									{value:"G2S_handpay", text:"G2S_handpay"},
									{value:"GTK_cashout", text:"GTK_cashout"},
									{value:"IGT_smartCard", text:"IGT_smartCard"},
									{value:"IGT_mediaDisplay", text:"IGT_mediaDisplay"}];

	// Keeping the below code in case I ever figure out the rest
	// issue with loading at runtime is that the nodes int he node red are displayed before all of the g2s utils are loaded
	// causing the labels to not properly use the getNodeLabel from the g2s utils until Node red redraws/regeenrates the workspace
	// function loadG2SApi(api_name, done){
	// 	console.log("Loading " + api_name);
	// 	$.getScript('/g2s_api/js/' + api_name + '.js')
	// 		.done(function(data, textStatus, jqxhr) {
	// 			console.log(api_name + " loaded");
	// 			if(done)
	// 				done();
	// 		}).
	// 		fail(function(jqxhr, settings, exception ){
	// 			console.log("Failed loading " + api_name);
	// 			console.log(exception);
	// 			console.log(exception.stack);
	// 			if(done)
	// 				done();
	// 		});
	// }

	// loadG2SApi('g2sCommonAPI', function(){
	// 	loadG2SApi('g2sCabinetAPI', function(){
	// 		loadG2SApi('g2sCoinAcceptorAPI', function(){
	// 			loadG2SApi('g2sNoteAcceptorAPI', function(){
	// 				loadG2SApi('g2sCommunicationsAPI', function(){
	// 					console.log("Done loading g2s utils, forcing redraw");
	// 					$("#red-ui-workspace-chart").hide(0, function(){
	// 						console.log("Done hiding...");
	// 						$("#red-ui-workspace-chart").show();
	// 					})
	// 				});
	// 			});
	// 		});
	// 	});
	// });

	var g2sUtils = (function() {
		'use strict';

		var publicAPIs = {};

		publicAPIs.startRow = function(info){
			return $("<div>").addClass("form-row")
					.append($("<label>").attr("for", info.id)
					.append($("<i>").addClass("icon-tag")).text(" " + info.text));
		};
		publicAPIs.selectInput = function(selections, info){
			let this_select = $("<select>").attr("id", info.id);
			selections.forEach(function(item){
				this_select.append($("<option>").attr("value", item.value).text(item.text));
			});

			let this_row = publicAPIs.startRow(info)
				.append(this_select);

			return this_row;
		};
		publicAPIs.checkboxInput = function(info){
			let this_div = publicAPIs.startRow(info)
				.append($("<input>").attr("type", "checkbox").attr("id", info.id).css({"display":"inline-block", "width":"auto", "vertical-align":"top"}));

			return this_div;
		};
		publicAPIs.inputWithDataList = function(data_list, options){
			let this_data_list = $("<datalist>").attr("id", options.id + "_data_list");
				data_list.forEach(function(item){
					this_data_list.append($("<option>").attr("value", item.value).attr("label", item.text).text(item.text));
				});

			let this_row = publicAPIs.startRow(options)
				.append($("<input>").attr("type", options.type).attr("list", options.id + "_data_list").attr("id", options.id))
				.append(this_data_list);

			return this_row;
		};
		publicAPIs.errorListInput = function(error_code_list, add_check){
			let error_list = $("<datalist>").attr("id", "error_list");
			error_code_list.forEach(function(item){
					error_list.append($("<option>").attr("value", item.value).attr("label", item.text).text(item.text));
				});

			let this_row = publicAPIs.startRow({id:"node-input-error_code", text:"Error Code"})
				.append($("<input>").attr("type", "number").attr("list", "error_list").attr("id", "node-input-error_code"))
				.append(error_list);

			if(add_check === undefined || add_check)
				this_row.append(g2sUtils.checkboxInput({id:"node-input-err_set_flag", text:"Set Flag"}));

			return this_row;
		};
		publicAPIs.input = function(info){
			let this_input = $("<input>").attr("type", info.type).attr("id", info.id);
			if(info.placeholder)
				this_input.attr("placeholder", info.placeholder);

			let this_row = publicAPIs.startRow(info)
				.append(this_input);

			return this_row;
		};
		publicAPIs.helperProp = function(propList, name, type, text){
			propList.append($("<dt>").text(name).append($("<span>").addClass("property-type").text(type)));
			propList.append($("<dd>").text(text));
			return propList;
		};

		return publicAPIs;
	})();


	//////////////////////////////////
	// Below are... a simplified node implementation... I guess
	// The idea here was to put everything into 1 custom Node red node
	// For that node to then expose all of the G2S APIs
	// Each map item is basically a node implementation, but trying to simplify it
	// and to have common utils (above) to make things look the same for all exposed
	// APIs
	/////////////////////////////////
	var g2sDataMap = new Map();
	g2sDataMap.set("game_info", {
		dataPanel: function(){
			let game_info = $("<div>")
				.append(g2sUtils.input({id:"node-input-sel_theme_id", text:"Theme Id", type:"text", placeholder:"Theme"}))
				.append(g2sUtils.input({id:"node-input-sel_paytable_id", text:"Paytable Id", type:"text", placeholder:"Paytable"}))
				.append(g2sUtils.input({id:"node-input-sel_denom_id", text:"Denom Id", type:"number", placeholder:"Denom"}));

			return game_info;
		},
		getNodeLabel: function(data){
			return "Game Info (" + (data.theme||"*") + "/" + (data.paytable||"*") + "/" + (data.denom||"*") + ")";
		},
		getData: function(){
			let _game_info = {};
			if($("#node-input-sel_theme_id").val().length > 0)
				_game_info.theme = $("#node-input-sel_theme_id").val();
			if($("#node-input-sel_paytable_id").val().length > 0)
				_game_info.paytable = $("#node-input-sel_paytable_id").val();
			if($("#node-input-sel_denom_id").val().length > 0)
				_game_info.denom = Number($("#node-input-sel_denom_id").val());

			return _game_info;
		},
		setData: function(data){
			if(data.theme !== undefined)
				$("#node-input-sel_theme_id").val(data.theme);
			if(data.paytable !== undefined)
				$("#node-input-sel_paytable_id").val(data.paytable);
			if(data.denom !== undefined)
				$("#node-input-sel_denom_id").val(data.denom);
		},
		helper: function(helper_panel){
			let properties = $("<dl>").addClass("message-properties");
			properties = this.append_helper_properties(properties);
			
			helper_panel
			.append($("<p>").text("Defines the data for a game combo").append("<br>"))			
			.append($("<h3>").text("Inputs"))
			.append(properties);				
		},
		append_helper_properties: function(helper_panel){
			g2sUtils.helperProp(helper_panel, "Theme Id", "String", "Name of the game to use");
			g2sUtils.helperProp(helper_panel, "Paytable Id", "String", "Identification of the paytable to use");
			g2sUtils.helperProp(helper_panel, "Denom Id", "Integer", "Denomination of the game to use");
						
			return helper_panel;
		}
	});
	g2sDataMap.set("game_theme_info", {
		dataPanel: function(){
			let game_info = $("<div>")
				.append(g2sUtils.input({id:"node-input-sel_theme_id", text:"Theme Id", type:"text", placeholder:"Theme"}))
				.append(g2sUtils.input({id:"node-input-sel_paytable_id", text:"Paytable Id", type:"text", placeholder:"Paytable"}))				

			return game_info;
		},
		getNodeLabel: function(data){
			return "Game Info (" + (data.theme||"*") + "/" + (data.paytable||"*") + "/" + (data.denom||"*") + ")";
		},
		getData: function(){
			let _game_info = {};
			if($("#node-input-sel_theme_id").val().length > 0)
				_game_info.theme = $("#node-input-sel_theme_id").val();
			if($("#node-input-sel_paytable_id").val().length > 0)
				_game_info.paytable = $("#node-input-sel_paytable_id").val();
			
			return _game_info;
		},
		setData: function(data){
			if(data.theme !== undefined)
				$("#node-input-sel_theme_id").val(data.theme);
			if(data.paytable !== undefined)
				$("#node-input-sel_paytable_id").val(data.paytable);			
		},
		helper: function(helper_panel){
			let properties = $("<dl>").addClass("message-properties");
			properties = this.append_helper_properties(properties);
			
			helper_panel
			.append($("<p>").text("Defines the data for a game theme").append("<br>"))			
			.append($("<h3>").text("Inputs"))
			.append(properties);				
		},
		append_helper_properties: function(helper_panel){
			g2sUtils.helperProp(helper_panel, "Theme Id", "String", "Name of the game to use");
			g2sUtils.helperProp(helper_panel, "Paytable Id", "String", "Identification of the paytable to use");
						
			return helper_panel;
		}
	});
	g2sDataMap.set("device_info", {
		dataPanel: function(){
			let sorted_classes = SUPPORTED_G2S_CLASSES;
			sorted_classes.sort(function(a,b){return a.value.localeCompare(b.value);});

			let device_info = $("<div>")
				.append(g2sUtils.inputWithDataList(sorted_classes, {id:"node-input-g2s_class_name", type:"text", text: "Class name"}))
				.append(g2sUtils.input({id:"node-input-device_uid", type:"text", text: "Device UID", placeholder:"Unique Identifer"}))
				.append(g2sUtils.input({id:"node-input-device_id", type:"number", text: "Device ID", placeholder:"G2S device identifer"}))

			return device_info;
		},
		getNodeLabel: function(data){
			return "Device Info (" + (data.class_name||"*") + "/" + (data.uid || data.id) + ")";
		},
		getData: function(){
			let _device_info = {};
			console.log('$("#node-input-g2s_class_name").val(): ' + $("#node-input-g2s_class_name").val());
			console.log('$("#node-input-g2s_class_name").val().length: ' + $("#node-input-g2s_class_name").val().length);
			if($("#node-input-g2s_class_name").val().length > 0)
				_device_info.class_name = $("#node-input-g2s_class_name").val();
			if($("#node-input-device_uid").val().length > 0)
				_device_info.uid = $("#node-input-device_uid").val();
			if($("#node-input-device_id").val().length > 0)
				_device_info.id = Number($("#node-input-device_id").val());
				
			return _device_info;
		},
		setData: function(data){
			if(data.class_name !== undefined)
				$("#node-input-g2s_class_name").val(data.class_name);
			if(data.uid !== undefined)
				$("#node-input-device_uid").val(data.uid);
			if(data.id !== undefined)
				$("#node-input-device_id").val(data.id);
		},
		helper: function(helper_panel){
			let properties = $("<dl>").addClass("message-properties");
			properties = this.append_helper_properties(properties);
			
			helper_panel
			.append($("<p>").text("Defines the data for a specific device within the G2S data model").append("<br>"))
			.append($("<h3>").text("Inputs"))
			.append(properties);				
		},
		append_helper_properties: function(helper_panel){
			g2sUtils.helperProp(helper_panel, "Class Name", "String", "Name of the class to use");
			g2sUtils.helperProp(helper_panel, "Device UID", "String", "Unique Identification of the device to use. If using within the G2S simulator, this is the name associted and shown with the device id in the device list");
			g2sUtils.helperProp(helper_panel, "Device Id", "Integer", "G2S device id assigned to the device to use");
			
			return helper_panel;
		}
	});

	var cabinetActionMap = new Map();
	cabinetActionMap.set("Error", {
		id: "Error",
		method: "g2s.egm.G2S_cabinet.errors.set_error",
		// Below is how this g2s API can display it's required data
		buildDataPanel: function(container){
			$("<div>").append($("<h3>").text("Error Information"))
				.append(g2sUtils.errorListInput([	{value:1, text:"Hard meter disconnected"},
													{value:2, text:"Video display error"},
													{value:3, text:"Non-volatile storage error"},
													{value:4, text:"General memory error"}]))
				.appendTo(container);
		},
		// returns the json representation of the data for this exposed API
		getData: function(){
			return {error_info:{error_code: Number($("#node-input-error_code").val()), set_flag:$("#node-input-err_set_flag").prop('checked')}};
		},
		// recovery from a json representation of the data last set
		setData: function(data){
			$("#node-input-error_code").val(data.error_info.error_code);
			$("#node-input-err_set_flag").prop('checked', data.error_info.set_flag);
		},
		// Allows this node to use this node's specific data to generate some meaningful label name for the flow nodes
		getNodeLabel: function(data){
			let error_txt = "";
			switch(data.error_info.error_code){
				case 1:
					error_txt = "Hard meter disconnected";
					break;
				case 2:
					error_txt = "Video display error";
					break;
				case 3:
					error_txt = "Non-volatile storage error";
					break;
				case 4:
					error_txt = "General memory error";
					break;
				default:
					error_txt = "Generic (" + data.error_info.error_code + ")";
			}
			return "G2S_cabinet " + (data.error_info.set_flag ? "Set " : "Clear " ) + error_txt;
		},
		helper: function(helper_panel){
			let properties = $("<dl>").addClass("message-properties");

			g2sUtils.helperProp(properties, "Error Code", "Integer", "Error code to trigger on the cabinet. Any value outside of the drop down list is considered a generic error code");
			g2sUtils.helperProp(properties, "Set Flag", "Boolean", "Whether to set or clear the error specified");
			
			helper_panel
			.append($("<p>").text("Triggers a cabinet device error").append("<br>"))
			.append($("<h3>").text("Inputs"))
			.append(properties);
		}
	});
	cabinetActionMap.set("Door Access", {
		id: "Door Access",
		method: "g2s.egm.G2S_cabinet.doors.access",
		buildDataPanel: function(container){
			$("<div>").append($("<h3>").text("Door Information"))
				.append(g2sUtils.selectInput([	{value:"1", text:"Cabinet"},
												{value:"2", text:"Logic"},
												{value:"3", text:"Auxilary"}],{id:"node-input-cabinet_door_id", text:"Door"}))
				.append(g2sUtils.checkboxInput({id:"node-input-cabinet_door_set_flag", text:"Openned"}))
				.appendTo(container);
		},
		getData: function(){
			return {
				door_info:{
					door_id: Number($("#node-input-cabinet_door_id").val()),
					set_flag:$("#node-input-cabinet_door_set_flag").is(":checked")
				}
			}
		},
		setData: function(data){
			$("#node-input-cabinet_door_id").val(data.door_info.door_id);
			$("#node-input-cabinet_door_set_flag").prop("checked", data.door_info.set_flag);
		},
		getNodeLabel: function(data){
			let door_txt = "";
			switch(data.door_info.door_id){
				case 1:
					door_txt = "Cabinet";
					break;
				case 2:
					door_txt = "Logic";
					break;
				case 3:
					door_txt = "Auxilary";
					break;
			}
			return "G2S_cabinet " + (data.door_info.set_flag ? "Open " : "Close " ) + door_txt;
		},
		helper: function(helper_panel){
			let properties = $("<dl>").addClass("message-properties");

			g2sUtils.helperProp(properties, "Door", "String", "Which door to trigger the access to");
			g2sUtils.helperProp(properties, "Openned", "Boolean", "Whether this action node represents opening (checked) or closing (unchecked) door access");
			
			helper_panel
			.append($("<p>").text("Triggers a door access for the specified door").append("<br>"))
			.append($("<h3>").text("Inputs"))
			.append(properties);
		}
	});
	cabinetActionMap.set("Game Selected", {
		id: "Game Selected",
		method: "g2s.egm.G2S_cabinet.selected_game_change",
		buildDataPanel: function(container){
			$("<div>").append($("<h3>").text("Selected Game Information"))
				.append(g2sDataMap.get("game_info").dataPanel())
				.append($("<h3>").text("Selected Game Source Information"))
				.append(g2sUtils.selectInput([	{value:"1", text:"By Player"},
												{value:"2", text:"By EGM"}],{id:"node-input-sel_game_src", text:"Source"}))
				.appendTo(container);
		},
		getData: function(){
			let data = {};
			data.game_info = g2sDataMap.get("game_info").getData();
			data.selected_by = Number($("#node-input-sel_game_src").val());

			return data;
		},
		setData: function(data){
			g2sDataMap.get("game_info").setData(data.game_info);
			$("#node-input-sel_game_src").val(data.selected_by);
		},
		getNodeLabel: function(data){
			let label = "G2S_cabinet Game Selected";
			if((data.game_info.theme && data.game_info.theme != "") && (data.game_info.paytable && data.game_info.paytable != ""))
				label += " (" + data.game_info.theme + "/" + data.game_info.paytable + "/" + data.game_info.denom + ")";
			else
				label += " (chooser) ";
				
			label += (data.selected_by == 1 ? " By player" : " By EGM");

			return label;
		},
		helper: function(helper_panel){
			let properties = $("<dl>").addClass("message-properties");
			
			properties.append($("<b>").text("Selected Game Information"));
			g2sDataMap.get("game_info").append_helper_properties(properties);
			
			properties.append($("<b>").text("Selected Game Source Information"));
			g2sUtils.helperProp(properties, "Source", "String", "The source for which this game selection was triggered by");
			
			helper_panel
			.append($("<p>").text("Triggers a Game selected. The defined game may also be passed in with the message (see Action Data Node). To trigger a back to a game chooser or no games selected, keep the theme, paytable and denoms fields empty").append("<br>"))
			.append($("<h3>").text("Inputs"))
			.append(properties);
		}
	});
	cabinetActionMap.set("Locale Id Changed", {
		id: "Locale Id Changed",
		method: "g2s.egm.G2S_cabinet.locale.changed",
		buildDataPanel: function(container){
			$("<div>").append($("<h3>").text("Locale Information"))
				.append(g2sUtils.input({id:"node-input-locale_lang_id", type:"text", text: "Language Code (ISO-639)", placeholder:""}))
				.append(g2sUtils.input({id:"node-input-locale_country_id", type:"text", text: "Country Code (ISO-3166)", placeholder:""}))
				.appendTo(container);
		},
		getData: function(){
			let data = {};
			data.language_code = $("#node-input-locale_lang_id").val();			
			data.country_code = $("#node-input-locale_country_id").val()
			
			return data;
		},
		setData: function(data){
			$("#node-input-locale_lang_id").val(data.language_code);
			$("#node-input-locale_country_id").val(data.country_code);
		},
		getNodeLabel: function(data){
			let label = "G2S_cabinet Locale Changed (" + data.language_code;
			if(data.country_code && data.country_code != "")
				label += "_" + data.country_code;
			
			label += ")";
			
			return label;
		},
		helper: function(helper_panel){
			let properties = $("<dl>").addClass("message-properties");
			
			properties.append($("<b>").text("Locale ID Information"));
			
			g2sUtils.helperProp(properties, "Language Code", "String", "The language component is REQUIRED. ISO-639 defines the language codes");
			g2sUtils.helperProp(properties, "Country Code", "String", "The country component is OPTIONAL. ISO-3166 defines the country codes");
			
			helper_panel
			.append($("<p>").text("Triggers a Locale Id Changed").append("<br>"))
			.append($("<h3>").text("Inputs"))
			.append(properties);
		}
	});	
	cabinetActionMap.set("In Playable State", {
		id: "In Playable State", 
		method: "g2s.egm.state.playable",		
		helper: function(helper_panel){
			helper_panel
			.append($("<p>").text("Notifies when the EGM is in a playable state (NOTE this simulates when the Error App disapears for example)").append("<br>"));
		}
	});
	cabinetActionMap.set("In Disabled State", {
		id: "In Disabled State", 
		method: "g2s.egm.state.disabled",
		helper: function(helper_panel){
			helper_panel
			.append($("<p>").text("Notifies when the EGM is in a disabled state (NOTE this simulates when the Error App is shown for example)").append("<br>"));
		}
	});
	cabinetActionMap.set("In Operator Menu", {
		id: "In Operator Menu",
		method: "g2s.egm.state.operator_menu",
		buildDataPanel: function(container){
			$("<div>").append($("<h3>").text("State Information"))
				.append(g2sUtils.checkboxInput({id:"node-input-cabinet_state_set_flag", text:"Enter"}))
				.appendTo(container);
		},
		getData: function(){
			return {
				set_flag:$("#node-input-cabinet_state_set_flag").is(":checked")
			}
		},
		setData: function(data){
			$("#node-input-cabinet_state_set_flag").prop("checked", data.set_flag);
		},
		getNodeLabel: function(data){
			return "G2S_cabinet " + (data.set_flag ? "Enter " : "Exit " ) + "Operator Menu";
		},
		helper: function(helper_panel){
			let properties = $("<dl>").addClass("message-properties");
			
			g2sUtils.helperProp(properties, "Enter", "Boolean", "Whether to simulate entering or exiting the operator menus");
			
			helper_panel
			.append($("<p>").text("Triggers the notification that the EGM accessed the operator menu (a.k.a. backoffice Lvl 2)").append("<br>"))
			.append($("<h3>").text("Inputs"))
			.append(properties);
		}
	});
	cabinetActionMap.set("In Meter Audit State", {
		id: "In Meter Audit State",
		method: "g2s.egm.state.meter_audit",
		buildDataPanel: function(container){
			$("<div>").append($("<h3>").text("State Information"))
				.append(g2sUtils.checkboxInput({id:"node-input-cabinet_state_set_flag", text:"Enter"}))
				.appendTo(container);
		},
		getData: function(){
			return {
				set_flag:$("#node-input-cabinet_state_set_flag").is(":checked")
			}
		},
		setData: function(data){
			$("#node-input-cabinet_state_set_flag").prop("checked", data.set_flag);
		},
		getNodeLabel: function(data){
			return "G2S_cabinet " + (data.set_flag ? "Enter " : "Exit " ) + "Meter Audit State";
		},
		helper: function(helper_panel){
			let properties = $("<dl>").addClass("message-properties");
			
			g2sUtils.helperProp(properties, "Enter", "Boolean", "Whether to simulate entering or exiting the audit menus");
			
			helper_panel
			.append($("<p>").text("Triggers the notification that the EGM accessed the audit menu (a.k.a. backoffice)").append("<br>"))
			.append($("<h3>").text("Inputs"))
			.append(properties);
		}
	});
	cabinetActionMap.set("In Operator Locked State", {
		id: "In Operator Locked State",
		method: "g2s.egm.state.operator_locked",
		buildDataPanel: function(container){
			$("<div>").append($("<h3>").text("State Information"))
				.append(g2sUtils.checkboxInput({id:"node-input-cabinet_state_set_flag", text:"Enter"}))
				.appendTo(container);
		},
		getData: function(){
			return {
				set_flag:$("#node-input-cabinet_state_set_flag").is(":checked")
			}
		},
		setData: function(data){
			$("#node-input-cabinet_state_set_flag").prop("checked", data.set_flag);
		},
		getNodeLabel: function(data){
			return "G2S_cabinet " + (data.set_flag ? "Enter " : "Exit " ) + "Operator Locked State";
		},
		helper: function(helper_panel){
			let properties = $("<dl>").addClass("message-properties");
			
			g2sUtils.helperProp(properties, "Enter", "Boolean", "Whether to simulate a locked by operator state");
			
			helper_panel
			.append($("<p>").text("Triggers the notification that an operator has locked the EGM").append("<br>"))
			.append($("<h3>").text("Inputs"))
			.append(properties);
		}
	});
	cabinetActionMap.set("In Operator Disabled State", {
		id: "In Operator Disabled State",
		method: "g2s.egm.state.operator_disabled",
		buildDataPanel: function(container){
			$("<div>").append($("<h3>").text("State Information"))
				.append(g2sUtils.checkboxInput({id:"node-input-cabinet_state_set_flag", text:"Enter"}))
				.appendTo(container);
		},
		getData: function(){
			return {
				set_flag:$("#node-input-cabinet_state_set_flag").is(":checked")
			}
		},
		setData: function(data){
			$("#node-input-cabinet_state_set_flag").prop("checked", data.set_flag);
		},
		getNodeLabel: function(data){
			return "G2S_cabinet " + (data.set_flag ? "Enter " : "Exit " ) + "Operator Disabled State";
		},
		helper: function(helper_panel){
			let properties = $("<dl>").addClass("message-properties");
			
			g2sUtils.helperProp(properties, "Enter", "Boolean", "Whether to simulate a disabled by operator state");
			
			helper_panel
			.append($("<p>").text("Triggers the notification that an operator has disabled the EGM").append("<br>"))
			.append($("<h3>").text("Inputs"))
			.append(properties);
		}
	});
	cabinetActionMap.set("Cashout Button Pressed", {
		id: "Cashout Button Pressed", 
		method: "g2s.egm.G2S_cabinet.cashout_button_pressed",		
		helper: function(helper_panel){
			helper_panel
			.append($("<p>").text("Notifies when a player has pressed the cashout button").append("<br>"));
		}
	});
	cabinetActionMap.set("Service Button Pressed", {
		id: "Service Button Pressed", 
		method: "g2s.egm.G2S_cabinet.service_button_pressed",		
		helper: function(helper_panel){
			helper_panel
			.append($("<p>").text("Notifies when a player has pressed the service button").append("<br>"));
		}
	});
	cabinetActionMap.set("Service Lamp Activation", {
		id: "Service Lamp Activation",
		method: "g2s.egm.G2S_cabinet.service_lamp.set_state",
		buildDataPanel: function(container){
			$("<div>").append($("<h3>").text("State Information"))
				.append(g2sUtils.checkboxInput({id:"node-input-cabinet_state_set_flag", text:"Lamp On"}))
				.appendTo(container);
		},
		getData: function(){
			return {
				on:$("#node-input-cabinet_state_set_flag").is(":checked")
			}
		},
		setData: function(data){
			$("#node-input-cabinet_state_set_flag").prop("checked", data.on);
		},
		getNodeLabel: function(data){
			return "G2S_cabinet Service Lamp " + (data.on ? " On" : " Off" );
		},
		helper: function(helper_panel){
			let properties = $("<dl>").addClass("message-properties");
			
			g2sUtils.helperProp(properties, "Lamp On", "Boolean", "Whether the EGM lamps are on (true/checked) or off");
			
			helper_panel
			.append($("<p>").text("Triggers the notification that the EGM lamps are either on or off").append("<br>"))
			.append($("<h3>").text("Inputs"))
			.append(properties);
		}
	});
	classActionMap.set("G2S_cabinet", cabinetActionMap);

	var watActionMap = new Map();
	watActionMap.set("Non G2S WAT Transfer completed", {
		id: "Non G2S WAT Transfer completed",
		method: "g2s.egm.G2S_wat.transfer.non_g2s",
		buildDataPanel: function(container){
			$("<div>").append($("<h3>").text("WAT "))				
				.append($("<h3>").text("WAT Transfer Details"))
				.append(g2sUtils.checkboxInput({id:"node-input-to_egm_flag", text:"To EGM"}))
				.append(g2sUtils.input({id:"node-input-cash", type:"number", text: "Cash Amt", placeholder:"Cashable amount"}))
				.append(g2sUtils.input({id:"node-input-promo", type:"number", text: "Promo Amt", placeholder:"Promotional amount"}))
				.append(g2sUtils.input({id:"node-input-non_cash", type:"number", text: "Non-Cash Amt", placeholder:"Non-Cashable amount"}))
				.append(g2sUtils.selectInput([	
											{value:"G2S_payCredit", text:"To Credit Bank"},
											{value:"G2S_payVoucher", text:"To a voucher"},
											{value:"G2S_payWat", text:"To a wagering account"},
											{value:"G2S_payHandpay", text:"To hand pay"}], {id:"node-input-pay_method_used", text: "Pay Method"}))
				
				.appendTo(container);
		},
		getData: function(){
			let data = {
				to_egm: $("#node-input-to_egm_flag").prop('checked'),
				amounts: {
					cash: Number($("#node-input-cash").val()),
					promo: Number($("#node-input-promo").val()),
					non_cash: Number($("#node-input-non_cash").val())
				},
				pay_method_used: $("#node-input-pay_method_used").val()
			};

			return data;
		},
		setData: function(data){
			$("#node-input-to_egm_flag").prop('checked', data.to_egm);
			$("#node-input-cash").val(data.amounts.cash);
			$("#node-input-promo").val(data.amounts.promo);
			$("#node-input-non_cash").val(data.amounts.non_cash);
			if(data.pay_method_used !== undefined)
				$("#node-input-pay_method_used").val(data.pay_method_used);
		},
		getNodeLabel: function(data){			
			return "Non G2S WAT Transfer " + (data.to_egm ? "To EGM" : "From EGM" ) +  " completed";
		},
		helper: function(helper_panel){
			let properties = $("<dl>").addClass("message-properties");
			
			properties.append($("<b>").text("WAT Transfer Details"));			
			g2sUtils.helperProp(properties, "To EGM", "Boolean", "Direction of the transfer, TO EGM means a transfer to the EGM bank, otherwise it is a transfer from the EGM back out to a WAT account");
			g2sUtils.helperProp(properties, "Cashable amount", "Integer", "Amount of cash in millicents that was issued");
			g2sUtils.helperProp(properties, "Promotional amount", "Integer", "Amount of promotional credits in millicents that was issued");
			g2sUtils.helperProp(properties, "Non-Cashable amount", "Integer", "Amount of non cashable credits in millicents that was issued");
			g2sUtils.helperProp(properties, "Pay Method", "String", "How the award was paid to the player");
			
			helper_panel
			.append($("<p>").text("Triggers a notification that a WAT transfer was accepted by the EGM outside of the G2S protocol ownership").append("<br>"))
			.append($("<h3>").text("Inputs"))
			.append(properties);
		}
	});
	classActionMap.set("G2S_wat", watActionMap);
	
	var commsActionMap = new Map();
	commsActionMap.set("Force Close", {
		id: "Force Close",
		method: "g2s.egm.G2S_communications.force_close",
		buildDataPanel: function(container){
			$("<div>").append($("<h3>").text("Host Information"))
				.append(g2sUtils.input({id:"node-input-host_id", type:"number", text:"Host Id", placeholder:"Host Device Id"}))
				.appendTo(container);
		},
		getData: function(){
			return {device_info:{
				id: Number($("#node-input-host_id").val())
			}};
		},
		setData: function(data){
			$("#node-input-host_id").val(data.device_info.id);
		},
		getNodeLabel: function(data){
			return "G2S_communications Force close host " + data.device_info.id;
		},
		helper: function(helper_panel){
			let properties = $("<dl>").addClass("message-properties");
			
			g2sUtils.helperProp(properties, "Host Id", "Integer", "Id of the G2S host (which communication device Id) to send to restart comms to");
			
			helper_panel
			.append($("<p>").text("Tells the G2S engine to force a specific host communication to go to the close state. This will cause the comms to restart").append("<br>"))
			.append($("<h3>").text("Inputs"))
			.append(properties);
		}
	});
	commsActionMap.set("Send Raw", {
		id: "Send Raw",
		method: "g2s.egm.sim.send_raw_g2s_cmd",
		buildDataPanel: function(container){
			$("<div>").append($("<h3>").text("Error Information"))
				.append(g2sUtils.input({id:"node-input-host_id", type:"number", text:"Host Id", placeholder:"Host Device Id"}))
				.append(g2sUtils.startRow({id: "node-input-g2s_cmd_xml", text:"Cmd XML"})
					.append($("<textarea>").attr("id", "node-input-g2s_cmd_xml").attr("type", "text").attr("rows", 10).attr("cols", 300)))
				.appendTo(container);
		},
		getData: function(){
			return {
				destination: Number($("#node-input-host_id").val()),
				g2s_cmd:$("#node-input-g2s_cmd_xml").val()
			};
		},
		setData: function(data){
			$("#node-input-host_id").val(data.destination);
			$("#node-input-g2s_cmd_xml").val(data.g2s_cmd);
		},
		getNodeLabel: function(data){
			return "G2S_communications Send Raw Msg to host " + data.destination;
		},
		helper: function(helper_panel){
			let properties = $("<dl>").addClass("message-properties");
			
			g2sUtils.helperProp(properties, "Host Id", "Integer", "Id of the G2S host (which communication device Id) to send the raw XML to");
			g2sUtils.helperProp(properties, "Cmd XML", "String", "Raw XML to be sent to the specified G2S Host");
			
			helper_panel
			.append($("<p>").text("Tells the G2S engine to send the specified raw xml to a specific host").append("<br>"))
			.append($("<h3>").text("Inputs"))
			.append(properties);
		}
	});
	commsActionMap.set("Force MSX", {
		id: "Force MSX",
		method: "gsa.transport.inject_nack",
		buildDataPanel: function(container){
			$("<div>").append($("<h3>").text("MSX Information"))
				.append(g2sUtils.input({id:"node-input-end_point_id", type:"text", text:"End Point Id", placeholder:"Host/EGM Device Id"}))
				.append(g2sUtils.input({id:"node-input-nack_code", type:"text", text:"MSX Code", placeholder:""}))
				.append(g2sUtils.input({id:"node-input-nack_text", type:"text", text:"Error Text", placeholder:""}))
				.append(g2sUtils.input({id:"node-input-nack_count", type:"number", text:"Nack Count", placeholder:"1"}))
				.appendTo(container);
		},
		getData: function(){
			return {
				end_point_id: $("#node-input-end_point_id").val(),
				nack:{				
					code: $("#node-input-nack_code").val(),
					text: $("#node-input-nack_text").val()
				},
				count: Number($("#node-input-nack_count").val())				
			};
		},
		setData: function(data){			
			$("#node-input-end_point_id").val(data.end_point_id);
			$("#node-input-nack_code").val(data.nack.code);
			$("#node-input-nack_text").val(data.nack.text);
			$("#node-input-nack_count").val(data.count);
		},
		getNodeLabel: function(data){
			return "Force MSX " + data.nack.code + " to " + data.end_point_id;
		},
		helper: function(helper_panel){
			let properties = $("<dl>").addClass("message-properties");
			
			g2sUtils.helperProp(properties, "End point id (a.k.a. Host Id)", "String", "Id of the G2S end point Id to nack inbound messages");
			g2sUtils.helperProp(properties, "Nack Code", "String", "MSX error code to send as a nack");
			g2sUtils.helperProp(properties, "Nack Text", "String", "Text to send as errorText with the nack");
			g2sUtils.helperProp(properties, "Count", "Integer", "Number of inbound messages to send nack's to");
			
			helper_panel
			.append($("<p>").text("Tells the G2S engine to have the transport used by the specified G2S host communications to send Nacks (message level negative aknowledgements) on subsequent inbound messages received").append("<br>"))
			.append($("<h3>").text("Inputs"))
			.append(properties);
		}
	});
	classActionMap.set("G2S_communications", commsActionMap);

	var caActionMap = new Map();
	caActionMap.set("Error", {
		id: "Error",
		method:"g2s.egm.G2S_coinAcceptor.errors.set_error",
		buildDataPanel: function(container){
			$("<div>").append($("<h3>").text("Device Information"))
				.append(g2sUtils.input({id:"node-input-device_uid", type:"text", text: "Device UID", placeholder:"Unique Identifer"}))
				.append($("<h3>").text("Error Information"))
				.append(g2sUtils.errorListInput([   {value:1, text:"Illegal Activity Detected"},
													{value:2, text:"Jammed"},
													{value:3, text:"Disconnected"},
													{value:4, text:"Firmware Error"},
													{value:5, text:"Mechanical Error"},
													{value:6, text:"Optical Error"},
													{value:7, text:"Non volatile memory Error"},
													{value:8, text:"Lockout Malfunction"},
													{value:9, text:"Acceptor Error"},
													{value:10, text:"Diverter Error"}])).appendTo(container);
		},
		getData: function(){
			return {
				device_info: {
					uid: $("#node-input-device_uid").val()
				},
				error_info:{
					error_code: Number($("#node-input-error_code").val()),
					set_flag:$("#node-input-err_set_flag").prop('checked')}
				}
		},
		setData: function(data){
			$("#node-input-device_uid").val(data.device_info.uid);
			$("#node-input-error_code").val(data.error_info.error_code);
			$("#node-input-err_set_flag").prop('checked', data.error_info.set_flag);
		},
		getNodeLabel: function(data){
			let error_txt = "";
			switch(data.error_info.error_code){
				case 1:	error_txt = "Illegal Activity Detected"; break;
				case 2:	error_txt = "Jammed"; break;
				case 3:	error_txt = "Disconnected";	break;
				case 4:	error_txt = "Firmware Error"; break;
				case 5: error_txt = "Mechanical Error"; break;
				case 6: error_txt = "Optical Error"; break;
				case 7: error_txt = "Non volatile memory Error"; break;
				case 8: error_txt = "Lockout Malfunction"; break;
				case 9: error_txt = "Acceptor Error"; break;
				case 10: error_txt = "Diverter Error"; break;
				default: error_txt = "Generic (" + data.error_info.error_code + ")";
			}
			return "G2S_coinAcceptor (" + data.device_info.uid + ")" + (data.error_info.set_flag ? "Set " : "Clear " ) + error_txt;
		},
		helper: function(helper_panel){
			let properties = $("<dl>").addClass("message-properties");
			
			g2sUtils.helperProp(properties, "Device UID", "String", "Unique Identifier string of the coin acceptor device to simulate (within the EGM simulator, this is the name fo the device to simulate)");
			g2sUtils.helperProp(properties, "Error Code", "Integer", "Error Code to simulate. Any error code value not in the drop down list is treated as a generic error");
			g2sUtils.helperProp(properties, "Set Flag", "Boolean", "Whether to set or clear the error code");
			
			helper_panel
			.append($("<p>").text("Simulates an error comming from the physical coin acceptor").append("<br>"))
			.append($("<h3>").text("Inputs"))
			.append(properties);
		}
	});
	caActionMap.set("Door Access", {
		id: "Door Access",
		method:"g2s.egm.G2S_coinAcceptor.door.access",
		buildDataPanel: function(container){
			$("<div>").append($("<h3>").text("Device Information"))
				.append(g2sUtils.input({id:"node-input-device_uid", type:"text", text: "Device UID", placeholder:"Unique Identifer"}))
				.append($("<h3>").text("Door Information"))
				.append(g2sUtils.checkboxInput({id:"node-input-door_openned", text: "Is Open"}))
				.appendTo(container);
		},
		getData: function(){
			return {device_info:{
					uid:$("#node-input-device_uid").val()
				},
				door_openned:$("#node-input-door_openned").prop('checked')};
		},
		setData: function(data){
			$("#node-input-device_uid").val(data.device_info.uid);
			$("#node-input-door_openned").prop('checked', data.door_openned);
		},
		getNodeLabel: function(data){
			return "G2S_coinAcceptor (" + data.device_info.uid + ") " + (data.door_openned ? "Openned" : "Closed" );
		},
		helper: function(helper_panel){
			let properties = $("<dl>").addClass("message-properties");
			
			g2sUtils.helperProp(properties, "Device UID", "String", "Unique Identifier string of the coin acceptor device to simulate (within the EGM simulator, this is the name fo the device to simulate)");
			g2sUtils.helperProp(properties, "Is Open", "Boolean", "Whether the door is opened or closed");
			
			helper_panel
			.append($("<p>").text("Simulates a physical coin acceptor door access").append("<br>"))
			.append($("<h3>").text("Inputs"))
			.append(properties);
		}
	});
	caActionMap.set("Coin Inserted", {
		id:"Coin Inserted",
		method:"g2s.egm.G2S_coinAcceptor.coin_inserted",
		buildDataPanel: function(container){
			$("<div>").append($("<h3>").text("Device Information"))
				.append(g2sUtils.input({id:"node-input-device_uid", type:"text", text: "Device UID", placeholder:"Unique Identifer"}))
				.append($("<h3>").text("Coin Information"))
				.append(g2sUtils.selectInput([{value:"0", text:"Hopper"}, {value:"1", text:"Drop Box"}], {id:"node-input-destination", text: "Destination"}))
				.append(g2sUtils.input({id:"node-input-egm_tx_id", type:"number", text:"TxId of escrowed coin", placeholder:"Transaction Id, empty for auto generation"}))
				.append($("<I>").append($("<b>").text("Currency Information")))
				.append(g2sUtils.input({id:"node-input-currency_id", type:"text", text:"Currency Id", placeholder:"currency id"}))
				.append(g2sUtils.input({id:"node-input-denom", type:"number", text:"Denom", placeholder:"denomination millicents"}))
				.append(g2sUtils.selectInput([{value:"G2S_coin", text:"Coin"}, {value:"G2S_token", text:"Token"}], {id:"node-input-currency_type", text: "Type"}))
				.appendTo(container);
		},
		getData: function(){
			let data = {
				device_info:{
					uid: $("#node-input-device_uid").val()
				},
				currency_info:{
					currency_id: $("#node-input-currency_id").val(),
					denom: Number($("#node-input-denom").val()),
					type: $("#node-input-currency_type").val()
				},
				destination: Number($("#node-input-destination").val())
			};
			
			if($("#node-input-egm_tx_id").val().length > 0)
				data.egm_tx_id = Number($("#node-input-egm_tx_id").val());
			else
				data.egm_tx_id = -1;
				
			return data;
		},
		setData: function(data){
			$("#node-input-device_uid").val(data.device_info.uid);
			$("#node-input-currency_id").val(data.currency_info.currency_id);
			$("#node-input-denom").val(data.currency_info.denom);
			$("#node-input-type").val(data.currency_info.type);
			$("#node-input-destination").val(data.destination);
			
			if(data.egm_tx_id != -1)
				$("#node-input-escrowed_coin_txid").val(data.egm_tx_id);
		},
		getNodeLabel: function(data){
			return "G2S_coinAcceptor (" + data.device_info.uid + ") Insert " + data.currency_info.denom + " " + data.currency_info.currency_id;
		},
		helper: function(helper_panel){
			let properties = $("<dl>").addClass("message-properties");
			
			g2sUtils.helperProp(properties, "Device UID", "String", "Unique Identifier string of the coin acceptor device to simulate (within the EGM simulator, this is the name fo the device to simulate)");
			g2sUtils.helperProp(properties, "Destination", "Integer", "Where the coin is being directed to. (Hopper or Dropbox)");
			g2sUtils.helperProp(properties, "Currency Id", "String", "Id of the currency type of the coin being inserted");
			g2sUtils.helperProp(properties, "Denom Id", "Integer", "Id of the denomination being inserted");
			g2sUtils.helperProp(properties, "Type", "String", "The type of coin being inserted, token or actual coin");
			
			helper_panel
			.append($("<p>").text("Simulates a physical coin insertion into the specific coin acceptor. <b>NOTE</b> TO be accepted the defined " +
			"coin must reflect of the supported coins for the specified device. The list of supported coins for a device in th EGM simulator can " +
			"be viewed in the options for that device").append("<br>"))
			.append($("<h3>").text("Inputs"))
			.append(properties);
		}
	});
	caActionMap.set("Coin Limit Reached", {
		id:"Coin Limit Reached",
		method:"g2s.egm.G2S_coinAcceptor.coin_limit_reached",
		buildDataPanel: function(container){
			$("<div>").append($("<h3>").text("Device Information"))
				.append(g2sUtils.input({id:"node-input-device_uid", type:"text", text: "Device UID", placeholder:"Unique Identifer"}))
				.appendTo(container);
		},
		getData: function(){
			return {
				device_info:{
					uid: $("#node-input-device_uid").val()
				}
			};
		},
		setData: function(data){
			$("#node-input-device_uid").val(data.device_info.uid);
		},
		getNodeLabel: function(data){
			return "G2S_coinAcceptor (" + data.device_info.uid + ") Coin Limit Reached";
		},
		helper: function(helper_panel){
			let properties = $("<dl>").addClass("message-properties");
			
			g2sUtils.helperProp(properties, "Device UID", "String", "Unique Identifier string of the coin acceptor device to simulate (within the EGM simulator, this is the name fo the device to simulate)");
			
			helper_panel
			.append($("<p>").text("Simulates a coin limit reached for the specific coin acceptor.").append("<br>"))
			.append($("<h3>").text("Inputs"))
			.append(properties);
		}
	});
	classActionMap.set("G2S_coinAcceptor", caActionMap);

	var naActionMap = new Map();
	naActionMap.set("Error", {
		id: "Error",
		method:"g2s.egm.G2S_noteAcceptor.errors.set_error",
		buildDataPanel: function(container){
			$("<div>").append($("<h3>").text("Device Information"))
				.append(g2sUtils.input({id:"node-input-device_uid", type:"text", text: "Device UID", placeholder:"Unique Identifer"}))
				.append($("<h3>").text("Error Information"))
				.append(g2sUtils.errorListInput([   {value:1, text:"Illegal Activity Detected"},
													{value:2, text:"Jammed"},
													{value:3, text:"Disconnected"},
													{value:4, text:"Firmware Error"},
													{value:5, text:"Mechanical Error"},
													{value:6, text:"Optical Error"},
													{value:7, text:"Non volatile memory Error"},
													{value:8, text:"Acceptor Fault"},
													{value:9, text:"Stacker Removed"},
													{value:10, text:"Stacker Full"},
													{value:11, text:"Stacker Jammed"},
													{value:12, text:"Stacker Fault"}]))
				.appendTo(container);
		},
		getData: function(){
			return {
				device_info: {
					uid:$("#node-input-device_uid").val()
				},
				error_info:{
					error_code: Number($("#node-input-error_code").val()),
					set_flag:$("#node-input-err_set_flag").prop('checked')}
				}
		},
		setData: function(data){
			$("#node-input-device_uid").val(data.device_info.uid);
			$("#node-input-error_code").val(data.error_info.error_code);
			$("#node-input-err_set_flag").prop('checked', data.error_info.set_flag);
		},
		getNodeLabel: function(data){
			let error_txt = "";
			switch(data.error_info.error_code){
				case 1:	error_txt = "Illegal Activity Detected"; break;
				case 2:	error_txt = "Jammed"; break;
				case 3:	error_txt = "Disconnected";	break;
				case 4:	error_txt = "Firmware Error"; break;
				case 5: error_txt = "Mechanical Error"; break;
				case 6: error_txt = "Optical Error"; break;
				case 7: error_txt = "Non volatile memory Error"; break;
				case 8: error_txt = "Acceptor Fault"; break;
				case 9: error_txt = "Stacker Removed"; break;
				case 10: error_txt = "Stacker Full"; break;
				case 11: error_txt = "Stacker Jammed"; break;
				case 12: error_txt = "Stacker Fault"; break;
				default: error_txt = "Generic (" + data.error_info.error_code + ")";
			}
			return "G2S_noteAcceptor (" + data.device_info.uid + ")" + (data.error_info.set_flag ? "Set " : "Clear " ) + error_txt;
		},
		helper: function(helper_panel){
			let properties = $("<dl>").addClass("message-properties");
			
			g2sUtils.helperProp(properties, "Device UID", "String", "Unique Identifier string of the note acceptor device to simulate (within the EGM simulator, this is the name fo the device to simulate)");
			g2sUtils.helperProp(properties, "Error Code", "Integer", "Error Code to simulate. Any error code value not in the drop down list is treated as a generic error");
			g2sUtils.helperProp(properties, "Set Flag", "Boolean", "Whether to set or clear the error code");
			
			helper_panel
			.append($("<p>").text("Simulates an error comming from the physical note acceptor").append("<br>"))
			.append($("<h3>").text("Inputs"))
			.append(properties);
		}
	});
	naActionMap.set("Stacker Door Access", {
		id:"Stacker Door Access",
		method:"g2s.egm.G2S_noteAcceptor.stacker.door.access",
		buildDataPanel: function(container){
			$("<div>").append($("<h3>").text("Device Information"))
				.append(g2sUtils.input({id:"node-input-device_uid", type:"text", text: "Device UID", placeholder:"Unique Identifer"}))
				.append($("<h3>").text("Door Information"))
				.append(g2sUtils.checkboxInput({id:"node-input-door_openned", text: "Is Open"}))
				.appendTo(container);
		},
		getData: function(){
			return {device_info:{
					uid:$("#node-input-device_uid").val()
				},
				door_openned:$("#node-input-door_openned").prop('checked')};
		},
		setData: function(data){
			$("#node-input-device_uid").val(data.device_info.uid);			
			$("#node-input-door_openned").prop('checked', data.door_openned);
		},
		getNodeLabel: function(data){
			return "G2S_noteAcceptor (" + data.device_info.uid + ") Stacker " + (data.door_openned ? "Openned" : "Closed" );
		},
		helper: function(helper_panel){
			let properties = $("<dl>").addClass("message-properties");
			
			g2sUtils.helperProp(properties, "Device UID", "String", "Unique Identifier string of the note acceptor device to simulate (within the EGM simulator, this is the name fo the device to simulate)");
			g2sUtils.helperProp(properties, "Is Open", "Boolean", "Whether the door is opened or closed");
			
			helper_panel
			.append($("<p>").text("Simulates a physical note acceptor stacker door access").append("<br>"))
			.append($("<h3>").text("Inputs"))
			.append(properties);
		}
	});
	naActionMap.set("Note Escrowed", {
		id:"Note Escrowed",
		method:"g2s.egm.G2S_noteAcceptor.note.escrowed",
		buildDataPanel: function(container){
			$("<div>").append($("<h3>").text("Device Information"))
				.append(g2sUtils.input({id:"node-input-device_uid", type:"text", text: "Device UID", placeholder:"Unique Identifer"}))
				.append($("<h3>").text("Note Information"))
				.append(g2sUtils.input({id:"node-input-egm_tx_id", type:"number", text:"TxId of escrowed note", placeholder:"Transaction Id -1 for auto generation"}))
				.append($("<I>").append($("<b>").text("Currency Information")))
				.append(g2sUtils.input({id:"node-input-currency_id", type:"text", text:"Currency Id", placeholder:"currency id"}))
				.append(g2sUtils.input({id:"node-input-denom", type:"number", text:"Denom", placeholder:"denomination millicents"}))
				.appendTo(container);
		},
		getData: function(){
			let data = {
				device_info:{
					uid: $("#node-input-device_uid").val()
				},
				currency_info:{
					currency_id: $("#node-input-currency_id").val(),
					denom: Number($("#node-input-denom").val()),
					type: $("#node-input-currency_type").prop('checked')
				}				
			};
			
			if($("#node-input-egm_tx_id").val().length > 0)
				data.egm_tx_id = Number($("#node-input-egm_tx_id").val());
			else
				data.egm_tx_id = -1;
				
			return data;
		},
		setData: function(data){
			$("#node-input-device_uid").val(data.device_info.uid);
			$("#node-input-currency_id").val(data.currency_info.currency_id);
			$("#node-input-denom").val(data.currency_info.denom);

			if(data.egm_tx_id != -1)
				$("#node-input-egm_tx_id").val(data.egm_tx_id);
		},
		getNodeLabel: function(data){
			return "G2S_noteAcceptor (" + data.device_info.uid + ") Escrow " + data.currency_info.denom + " " + data.currency_info.currency_id;
		},
		helper: function(helper_panel){
			let properties = $("<dl>").addClass("message-properties");
			
			g2sUtils.helperProp(properties, "Device UID", "String", "Unique Identifier string of the note acceptor device to simulate (within the EGM simulator, this is the name fo the device to simulate)");
			g2sUtils.helperProp(properties, "TxId of escrowed note", "Integer", "EGM transaction id of this action. This id must differ from the last escrowed note to be accepted. Leave empty to have simulator " + 
			"generate a valid id");
			g2sUtils.helperProp(properties, "Currency Id", "String", "Id of the currency type of the note being inserted");
			g2sUtils.helperProp(properties, "Denom Id", "Integer", "Id of the denomination being inserted");
			
			helper_panel
			.append($("<p>").html("Simulates a physical note insertion (escrow) into the specific note acceptor." +
			"<br><br><b>NOTE</b> To be accepted the defined note must reflect of the supported notes for the specified device. The " +
			"list of supported notes for a device in th EGM simulator can be viewed in the options for that device" +
			"<br><br><b>NOTE</b> This is part of a 2 part transaction. 1) escrowing the bill, then 2) stacking the bill. This action " +
			"require a transaction id to be passed in. User can specify their own in either part of the 2 actions, or leave empty to " +
			"let the simulation geenrate the id. The id must remain the same between the 2 part of this action").append("<br>"))
			.append($("<h3>").text("Inputs"))
			.append(properties);
		}
	});
	naActionMap.set("Note Stacked", {
		id:"Note Stacked",
		method:"g2s.egm.G2S_noteAcceptor.note.stacked",
		buildDataPanel: function(container){
			$("<div>").append($("<h3>").text("Device Information"))
				.append(g2sUtils.input({id:"node-input-device_uid", type:"text", text: "Device UID", placeholder:"Unique Identifer"}))
				.append($("<h3>").text("Note Information"))
				.append(g2sUtils.input({id:"node-input-egm_tx_id", type:"number", text:"TxId of escrowed note", placeholder:"Transaction Id -1 for auto generation"}))
				.append(g2sUtils.selectInput([{value:"0", text:"Dispenser"}, {value:"1", text:"Drop Box"}], {id:"node-input-note_destination", text: "Destination"}))
				.appendTo(container);
		},
		getData: function(){
			let data = {
				device_info:{
					uid: $("#node-input-device_uid").val()
				},
				destination: Number($("#node-input-note_destination").val())
			};
			
			if($("#node-input-egm_tx_id").val().length > 0)
				data.egm_tx_id = Number($("#node-input-egm_tx_id").val());
			else
				data.egm_tx_id = -1;

			return data;
		},
		setData: function(data){
			$("#node-input-device_uid").val(data.device_info.uid);
			if(data.egm_tx_id != -1)
				$("#node-input-egm_tx_id").val(data.egm_tx_id);
			$("#node-input-note_destination").val(data.destination);
		},
		getNodeLabel: function(data){
			return "G2S_noteAcceptor (" + data.device_info.uid + ") Stack note to " + (data.destination == 1 ? "Drop box" : "Dispenser");
		},
		helper: function(helper_panel){
			let properties = $("<dl>").addClass("message-properties");
			
			g2sUtils.helperProp(properties, "Device UID", "String", "Unique Identifier string of the note acceptor device to simulate (within the EGM simulator, this is the name fo the device to simulate)");
			g2sUtils.helperProp(properties, "TxId of escrowed note", "Integer", "EGM transaction id of this action. This id must be the same as the transaction used during the escro of the note to be accepted. " +
			"Leave empty to allow the simualtor send the escrowed id used");
			
			helper_panel
			.append($("<p>").html("Simulates a physical note stacked into the specific note acceptor." +
			"<br><br><b>NOTE</b> This is part of a 2 part transaction. 1) escrowing the bill, then 2) stacking the bill. This action " +
			"require a transaction id to be passed in. User can specify their own in either part of the 2 actions, or leave empty to " +
			"let the simulation generate the id. The id must remain the same between the 2 part of this action").append("<br>"))
			.append($("<h3>").text("Inputs"))
			.append(properties);
		}
	});
	naActionMap.set("Note Returned", {
		id:"Note Returned",
		method:"g2s.egm.G2S_noteAcceptor.note.returned",
		buildDataPanel: function(container){
			$("<div>").append($("<h3>").text("Device Information"))
				.append(g2sUtils.input({id:"node-input-device_uid", type:"text", text: "Device UID", placeholder:"Unique Identifer"}))
				.append($("<h3>").text("Note Information"))
				.append(g2sUtils.input({id:"node-input-egm_tx_id", type:"number", text:"TxId of escrowed note", placeholder:"Transaction Id, empty for auto generation"}))
				.appendTo(container);
		},
		getData: function(){
			let data = {
				device_info:{
					uid: $("#node-input-device_uid").val()
				}
			};
			
			if($("#node-input-egm_tx_id").val().length > 0)
				data.egm_tx_id = Number($("#node-input-egm_tx_id").val());
			else
				data.egm_tx_id = -1;
				
			return data;
		},
		setData: function(data){
			$("#node-input-device_uid").val(data.device_info.uid);
			
			if(data.egm_tx_id != -1)
				$("#node-input-egm_tx_id").val(data.egm_tx_id);
		},
		getNodeLabel: function(data){
			return "G2S_noteAcceptor (" + data.device_info.uid + ") Return note";
		},
		helper: function(helper_panel){
			let properties = $("<dl>").addClass("message-properties");
			
			g2sUtils.helperProp(properties, "Device UID", "String", "Unique Identifier string of the note acceptor device to simulate (within the EGM simulator, this is the name fo the device to simulate)");
			g2sUtils.helperProp(properties, "TxId of escrowed note", "Integer", "EGM transaction id of this action. This id must be the same as the transaction used during the escro of the note to be accepted. " +
				"Leave empty to allow the simualtor send the escrowed id used");
			
			helper_panel
			.append($("<p>").html("Simulates a physical note returned into the specific note acceptor." +
			"<br><br><b>NOTE</b> This is part of a 2 part transaction. 1) escrowing the bill, then 2) stacking the bill. This action " +
			"require a transaction id to be passed in. User can specify their own in either part of the 2 actions, or leave empty to " +
			"let the simulation generate the id. The id must remain the same between the 2 part of this action").append("<br>"))
			.append($("<h3>").text("Inputs"))
			.append(properties);
		}
	});
	naActionMap.set("Note Rejected", {
		id:"Note Rejected",
		method:"g2s.egm.G2S_noteAcceptor.note.rejected",
		buildDataPanel: function(container){
			$("<div>").append($("<h3>").text("Device Information"))
				.append(g2sUtils.input({id:"node-input-device_uid", type:"text", text: "Device UID", placeholder:"Unique Identifer"}))
				.appendTo(container);
		},
		getData: function(){
			return {
				device_info:{
					uid: $("#node-input-device_uid").val()
				}
			};
		},
		setData: function(data){
			$("#node-input-device_uid").val(data.device_info.uid);
		},
		getNodeLabel: function(data){
			return "G2S_noteAcceptor (" + data.device_info.uid + ") Note rejected";
		},
		helper: function(helper_panel){
			let properties = $("<dl>").addClass("message-properties");
			
			g2sUtils.helperProp(properties, "Device UID", "String", "Unique Identifier string of the note acceptor device to simulate (within the EGM simulator, this is the name fo the device to simulate)");
			
			helper_panel
			.append($("<p>").text("Simulates a rejection of a physical note. This occurs when the note is not recognized as a valid note").append("<br>"))
			.append($("<h3>").text("Inputs"))
			.append(properties);
		}
	});
	classActionMap.set("G2S_noteAcceptor", naActionMap);

	var handpayActionMap = new Map();
	handpayActionMap.set("Handpay Lock", {
		id: "Handpay Lock",
		method:"g2s.egm.G2S_handpay.lock",
		buildDataPanel: function(container){
			$("<div>").append($("<h3>").text("Device Information"))
				.append(g2sUtils.input({id:"node-input-cash", type:"number", text: "Lock Cash Amt", placeholder:"Lock Cashable amount"}))
				.append(g2sUtils.input({id:"node-input-promo", type:"number", text: "Lock Promo Amt", placeholder:"Lock Promotional amount"}))
				.append(g2sUtils.input({id:"node-input-non_cash", type:"number", text: "Lock Non-Cash Amt", placeholder:"Lock Non-Cashable amount"}))
				.append(g2sUtils.input({id:"node-input-egm_tx_id", type:"number", text: "EGM Tx Id", placeholder:"Transaction Id, empty for auto generation"}))
				.appendTo(container);
		},
		getData: function(){
			let this_data = {};
			this_data.requested_amts = {
				cash: Number($("#node-input-cash").val()),
				promo: Number($("#node-input-promo").val()),
				non_cash: Number($("#node-input-non_cash").val())
			};
			if($("#node-input-egm_tx_id").val().length > 0)
				this_data.egm_tx_id = Number($("#node-input-egm_tx_id").val());
			else
				this_data.egm_tx_id = -1;
				
			return this_data;
		},
		setData: function(data){
			$("#node-input-cash").val(data.requested_amts.cash);
			$("#node-input-promo").val(data.requested_amts.promo);
			$("#node-input-non_cash").val(data.requested_amts.non_cash);

			if(data.egm_tx_id != -1)
				$("#node-input-egm_tx_id").val(data.egm_tx_id);
		},
		getNodeLabel: function(data){
			
			return "G2S_handpay Lock";
		},
		helper: function(helper_panel){
			let properties = $("<dl>").addClass("message-properties");
			
			properties.append($("<b>").text("Amounts Info"));
			g2sUtils.helperProp(properties, "Cash Amount", "Integer", "Amount of cash credits being locked in handpay");
			g2sUtils.helperProp(properties, "Promo Amount", "Integer", "Amount of promotional credits being locked in handpay");
			g2sUtils.helperProp(properties, "Non-Cash Amount", "Integer", "Amount of non-cashable credits being locked in handpay");
			
			properties.append($("<b>").text("Transaction Info"));
			g2sUtils.helperProp(properties, "EGM Tx Id", "Integer", "EGM transaction id of this action. Leave empty to allow the simulator send the escrowed id used");
			
			helper_panel
			.append($("<p>").text("Simulates an Handpay lock, for example for a Large Win").append("<br>"))
			.append($("<h3>").text("Inputs"))
			.append(properties);
		}
	});

	handpayActionMap.set("Handpay KeyOff", {
		id: "Handpay KeyOff",
		method: "g2s.egm.G2S_handpay.keyoff",		
		getNodeLabel: function(data){
			if(data.keyoff_type != "")
				return "Keyoff to " + data.keyoff_type;
			else
				return "Keyoff Pending Handpay";
		},
		buildDataPanel: function(container){
			$("<div>").append($("<h3>").text("Keyoff Information"))
				.append(g2sUtils.selectInput([
					{value:"G2S_localHandpay", text:"Local Handpay"},
					{value:"G2S_localVoucher", text:"Local Voucher"}
					], {id:"node-input-keyoff_type", text: "Keyoff type"}))			
				.appendTo(container);
		},
		getData: function(){
			return {
				keyoff_type: $("#node-input-keyoff_type").val()				
			}; 
		},
		// recovery from a json representation of the data last set
		setData: function(data){
			$("#node-input-keyoff_type").val(data.keyoff_type);
		},
		helper: function(helper_panel){
			let properties = $("<dl>").addClass("message-properties");
			
			g2sUtils.helperProp(properties, "Keyoff type", "String", "Key off type (See G2S handpay for details on handpay types");
			
			helper_panel
			.append($("<p>").html("Simulates the manual handpay key offs at the EGM").append("<br>"))
			.append($("<h3>").text("Inputs"))
			.append(properties);
		}
	});
	classActionMap.set("G2S_handpay", handpayActionMap);

	var gpActionMap = new Map();
	gpActionMap.set("Error", {
		id: "Error",
		method:"g2s.egm.G2S_gamePlay.errors.set_error",
		buildDataPanel: function(container){
			$("<div>").append($("<h3>").text("Device Information"))
				.append(g2sDataMap.get("game_theme_info").dataPanel())
				.append($("<h3>").text("Error Information"))
				.append(g2sUtils.errorListInput([{value:1, text:"Illegal Activity Detected"}]))
				.appendTo(container);
		},
		getData: function(){
			let this_data = {};
			this_data.game_info = g2sDataMap.get("game_theme_info").getData();
			this_data.error_info = {
				error_code: Number($("#node-input-error_code").val()),
				set_flag:$("#node-input-err_set_flag").prop('checked')}			
			
			return this_data;
		},
		setData: function(data){
			g2sDataMap.get("game_theme_info").setData(data.game_info);
			$("#node-input-error_code").val(data.error_info.error_code);
			$("#node-input-err_set_flag").prop('checked', data.error_info.set_flag);
		},
		getNodeLabel: function(data){
			let error_txt = "";
			switch(data.error_info.error_code){
				case 1:	error_txt = "Illegal Activity Detected"; break;
				default: error_txt = "Generic (" + data.error_info.error_code + ")";
			}
			return "G2S_gamePlay (" + data.game_info.theme + ")" + (data.error_info.set_flag ? "Set " : "Clear " ) + error_txt;
		},
		helper: function(helper_panel){
			let properties = $("<dl>").addClass("message-properties");
			
			properties.append($("<b>").text("Game Info"))
			.append(g2sDataMap.get("game_info").append_helper_properties(properties));
						
			properties.append($("<b>").text("Wager Info"));
			g2sUtils.helperProp(properties, "Error Code", "Integer", "Error Code to simulate. Any error code value not in the drop down list is treated as a generic error");
			g2sUtils.helperProp(properties, "Set Flag", "Boolean", "Whether to set or clear the error code");
			
			helper_panel
			.append($("<p>").text("Simulates a fault comming from the assoicated game").append("<br>"))
			.append($("<h3>").text("Inputs"))
			.append(properties);
		}
	});
	gpActionMap.set("Primary Game Started", {
		id: "Primary Game Started",
		method:"g2s.egm.G2S_gamePlay.primary_game_started",
		buildDataPanel: function(container){
			$("<div>").append($("<h3>").text("Game Information"))
				.append(g2sDataMap.get("game_info").dataPanel())
				.append($("<h3>").text("Wager Information"))
				.append(g2sUtils.input({id:"node-input-category_id", type:"text", text: "Category Id", placeholder:"Category"}))
				.append(g2sUtils.input({id:"node-input-cash_amt", type:"number", text: "Cash", placeholder:"0"}))
				.append(g2sUtils.input({id:"node-input-promo_amt", type:"number", text: "Promotional", placeholder:"0"}))
				.append(g2sUtils.input({id:"node-input-non_cash_amt", type:"number", text: "Non-cash", placeholder:"0"}))
				.append($("<h3>").text("Transaction Information"))
				.append(g2sUtils.input({id:"node-input-egm_tx_id", type:"number", text: "EGM Tx Id", placeholder:"Transaction Id, empty for auto generation"}))
				.appendTo(container);
		},
		getData: function(){
			let this_data = {};
			this_data.game_info = g2sDataMap.get("game_info").getData();
			this_data.wager = {
				category: $("#node-input-category_id").val(),
				cash: Number($("#node-input-cash_amt").val()),
				promo: Number($("#node-input-promo_amt").val()),
				non_cash: Number($("#node-input-non_cash_amt").val())
			};
			if($("#node-input-egm_tx_id").val().length > 0)
				this_data.egm_tx_id = Number($("#node-input-egm_tx_id").val());
			else
				this_data.egm_tx_id = -1;
				
			return this_data;
		},
		setData: function(data){
			g2sDataMap.get("game_info").setData(data.game_info);

			$("#node-input-category_id").val(data.wager.category);
			$("#node-input-cash_amt").val(data.wager.cash);
			$("#node-input-promo_amt").val(data.wager.promo);
			$("#node-input-non_cash_amt").val(data.wager.non_cash);

			if(data.egm_tx_id != -1)
				$("#node-input-egm_tx_id").val(data.egm_tx_id);
		},
		getNodeLabel: function(data){
			if(data.game_info.theme !== undefined)
				return "G2S_gamePlay Primary Game Started (" + data.game_info.theme + ")";
			else
				return "G2S_gamePlay Primary Game Started";
		},
		helper: function(helper_panel){
			let properties = $("<dl>").addClass("message-properties");

			properties.append($("<b>").text("Game Info"))
			.append(g2sDataMap.get("game_info").append_helper_properties(properties));
			
			properties.append($("<b>").text("Wager Info"));
			g2sUtils.helperProp(properties, "Cash Amount", "Integer", "Amount of cash credits being wagered on the game");
			g2sUtils.helperProp(properties, "Promo Amount", "Integer", "Amount of promotional credits being wagered on the game");
			g2sUtils.helperProp(properties, "Non-Cash Amount", "Integer", "Amount of non-cashable credits being wagered ont the game");
			
			properties.append($("<b>").text("Transaction Info"));
			g2sUtils.helperProp(properties, "EGM Tx Id", "Integer", "EGM transaction id of this action. Leave empty to allow the simualtor send the escrowed id used");
				
			helper_panel
			.append($("<p>").html("Simulates the start of a game cycle. To see the entire flow of a game cycle, refer to G2S Section 6.5 playState Transition." + 
			"<br><br><b>NOTE</b> This is a multi part transaction. This action and subsequen game state transition action require a transaction id to be passed " +
            "in. User can specify their own, or leave empty to let the simulation generate the id. The id must increment for each subseque game play transation action").append("<br>"))
			.append($("<h3>").text("Inputs"))			
			
			.append(properties);
		}
	});
	gpActionMap.set("Primary Game Ended", {
		id: "Primary Game Ended",
		method:"g2s.egm.G2S_gamePlay.primary_game_ended",
		buildDataPanel: function(container){
			$("<div>").append($("<h3>").text("Game Information"))
				.append(g2sDataMap.get("game_info").dataPanel())
				.append($("<h3>").text("Win Information"))
					.append(g2sUtils.input({id:"node-input-win_amt", type:"number", text: "Won Amount", placeholder:"Denom"}))
					.append($("<h3>").text("Win Levels"))
					.append($("<div>").addClass("form-row")
						.append($("<ol>").attr("id", "node-input-win_levels-container")))
					.append($("<h3>").text("Transaction Information"))
					.append(g2sUtils.input({id:"node-input-egm_tx_id", type:"number", text: "EGM Tx Id", placeholder:"Transaction Id, empty for auto generation"}))
				.appendTo(container);

			$("#node-input-win_levels-container").css('min-height','200px').css('min-width','400px').editableList({
				addItem: function(container,i,opt) {
					var dflt_index = 0;
					if(opt.hasOwnProperty("index"))
						dflt_index = opt.index;

					container.css({
                        overflow: 'hidden',
                        whiteSpace: 'nowrap'
                    });
                    var row = $('<div/>').appendTo(container);
					$('<label for="win_level_index"><i class="icon-tag"></i> Index</label>').appendTo(row);
					$('<input type="number" id="node-input-win_level_index">').val(dflt_index).appendTo(row);
				},
				removeItem: function(opt) {
				},
				removable: true
			});
		},
		getData: function(){
			let this_data = {};
			this_data.game_info = g2sDataMap.get("game_info").getData();
			
			var win_levels_list = $("#node-input-win_levels-container").editableList('items');
            let current_win_levels = [];

			var num = 0;
			win_levels_list.each(function(i) {
				var index = $(this).find("input").val();
				current_win_levels.push(index);
			});

			this_data.win_levels = current_win_levels;
			
			if($("#node-input-win_amt").val().length > 0)
				this_data.win_amt = Number($("#node-input-win_amt").val());
			
			if($("#node-input-egm_tx_id").val().length > 0)
				this_data.egm_tx_id = Number($("#node-input-egm_tx_id").val());
			else
				this_data.egm_tx_id = -1;
				
			return this_data;
		},
		setData: function(data){
			g2sDataMap.get("game_info").setData(data.game_info);
			
			if(data.win_amt !== undefined)
				$("#node-input-win_amt").val(data.win_amt);
				
			for (var i=0;i < data.win_levels.length; i++) {
                var index_val = data.win_levels[i];
                $("#node-input-win_levels-container").editableList('addItem',{index:index_val});
			}
			
			if(data.egm_tx_id != -1)
				$("#node-input-egm_tx_id").val(data.egm_tx_id);
		},
		getNodeLabel: function(data){
			if(data.win_amt !== undefined)
				return "Primary Game Ended (win " + data.win_amt + ")";
			else
				return "Primary Game Ended";
		},
		helper: function(helper_panel){
			let properties = $("<dl>").addClass("message-properties");

			properties.append($("<b>").text("Game Info"))
			.append(g2sDataMap.get("game_info").append_helper_properties(properties));
			
			properties.append($("<b>").text("Win Info"));
			g2sUtils.helperProp(properties, "Win Amount", "Integer", "Amount won during the primary game play");
			
			properties.append($("<b>").text("Win Levels"));
			g2sUtils.helperProp(properties, "Level Indexes", "Array", "List of win level Indexes");
			
			properties.append($("<b>").text("Transaction Info"));
			g2sUtils.helperProp(properties, "EGM Tx Id", "Integer", "EGM transaction id of this action. Leave empty to allow the simualtor send the escrowed id used");
			
			helper_panel
			.append($("<p>").html("Simulates the end of the primary game state. To see the entire flow of a game cycle, refer to G2S Section 6.5 playState Transition." + 
			"<br><br><b>NOTE</b> This is a multi part transaction. This action and subsequen game state transition action require a transaction id to be passed " +
            "in. User can specify their own, or leave empty to let the simulation generate the id. The id must increment for each subsequent game play transation action").append("<br>"))
			.append($("<h3>").text("Inputs"))
			.append(properties);
		}
	});
	gpActionMap.set("Secondary Game Choice", {
		id: "Secondary Game Choice",
		method:"g2s.egm.G2S_gamePlay.sec_game_choice",
		buildDataPanel: function(container){
			$("<div>").append($("<h3>").text("Game Information"))
				.append(g2sDataMap.get("game_info").dataPanel())		
				.append($("<h3>").text("Transaction Information"))
					.append(g2sUtils.input({id:"node-input-egm_tx_id", type:"number", text: "EGM Tx Id", placeholder:"Transaction Id, empty for auto generation"}))
				.appendTo(container);
		},
		getData: function(){
			let this_data = {};
			this_data.game_info = g2sDataMap.get("game_info").getData();
			
			if($("#node-input-egm_tx_id").val().length > 0)
				this_data.egm_tx_id = Number($("#node-input-egm_tx_id").val());
			else
				this_data.egm_tx_id = -1;
				
			return this_data;
		},
		setData: function(data){
			g2sDataMap.get("game_info").setData(data.game_info);
						
			if(data.egm_tx_id != -1)
				$("#node-input-egm_tx_id").val(data.egm_tx_id);
		},
		getNodeLabel: function(data){
			return "Secondary Game Choice";
		},
		helper: function(helper_panel){
			let properties = $("<dl>").addClass("message-properties");

			properties.append($("<b>").text("Game Info"))
			.append(g2sDataMap.get("game_info").append_helper_properties(properties));
			
			properties.append($("<b>").text("Transaction Info"));
			g2sUtils.helperProp(properties, "EGM Tx Id", "Integer", "EGM transaction id of this action. Leave empty to allow the simualtor send the escrowed id used");
			
			helper_panel
			.append($("<p>").html("Simulates a secondary game choice state. To see the entire flow of a game cycle, refer to G2S Section 6.5 playState Transition." + 
			"<br><br><b>NOTE</b> This is a multi part transaction. This action and subsequen game state transition action require a transaction id to be passed " +
            "in. User can specify their own, or leave empty to let the simulation generate the id. The id must increment for each subsequent game play transation action").append("<br>"))
			.append($("<h3>").text("Inputs"))
			.append(properties);
		}
	});
	gpActionMap.set("Secondary Game Started", {
		id: "Secondary Game Started",
		method:"g2s.egm.G2S_gamePlay.sec_game_started",
		buildDataPanel: function(container){
			$("<div>").append($("<h3>").text("Game Information"))
				.append(g2sDataMap.get("game_info").dataPanel())
				.append($("<h3>").text("Wager Information"))
					.append(g2sUtils.input({id:"node-input-wager_amt", type:"number", text: "Wager Amount", placeholder:"Wager"}))					
				.append($("<h3>").text("Transaction Information"))
					.append(g2sUtils.input({id:"node-input-egm_tx_id", type:"number", text: "EGM Tx Id", placeholder:"Transaction Id, empty for auto generation"}))
				.appendTo(container);
		},
		getData: function(){
			let this_data = {};
			this_data.game_info = g2sDataMap.get("game_info").getData();
						
			if($("#node-input-wager_amt").val().length > 0)
				this_data.wager_amt = Number($("#node-input-wager_amt").val());
			
			if($("#node-input-egm_tx_id").val().length > 0)
				this_data.egm_tx_id = Number($("#node-input-egm_tx_id").val());
			else
				this_data.egm_tx_id = -1;
				
			return this_data;
		},
		setData: function(data){
			g2sDataMap.get("game_info").setData(data.game_info);
			
			if(data.wager_amt !== undefined)
				$("#node-input-wager_amt").val(data.wager_amt);
				
			if(data.egm_tx_id != -1)
				$("#node-input-egm_tx_id").val(data.egm_tx_id);
		},
		getNodeLabel: function(data){
			if(data.wager_amt !== undefined)
				return "Secondary Game Started (wager " + data.wager_amt + ")";
			else
				return "Secondary Game Started";
		},
		helper: function(helper_panel){
			let properties = $("<dl>").addClass("message-properties");

			properties.append($("<b>").text("Game Info"))
			.append(g2sDataMap.get("game_info").append_helper_properties(properties));
			
			properties.append($("<b>").text("Wager Info"));
			g2sUtils.helperProp(properties, "Wager Amount", "Integer", "Amount wagered for this secondary game");
			
			properties.append($("<b>").text("Transaction Info"));
			g2sUtils.helperProp(properties, "EGM Tx Id", "Integer", "EGM transaction id of this action. Leave empty to allow the simualtor send the escrowed id used");
			
			helper_panel
			.append($("<p>").html("Simulates the start of a secondary game state. To see the entire flow of a game cycle, refer to G2S Section 6.5 playState Transition." + 
			"<br><br><b>NOTE</b> This is a multi part transaction. This action and subsequen game state transition action require a transaction id to be passed " +
            "in. User can specify their own, or leave empty to let the simulation generate the id. The id must increment for each subsequent game play transation action").append("<br>"))
			.append($("<h3>").text("Inputs"))
			.append(properties);
		}
	});
	gpActionMap.set("Secondary Game Ended", {
		id: "Secondary Game Ended",
		method:"g2s.egm.G2S_gamePlay.sec_game_ended",
		buildDataPanel: function(container){
			$("<div>").append($("<h3>").text("Game Information"))
				.append(g2sDataMap.get("game_info").dataPanel())
				.append($("<h3>").text("Win Information"))
					.append(g2sUtils.input({id:"node-input-win_amt", type:"number", text: "Won Amount", placeholder:"Amount"}))
					.append($("<h3>").text("Win Levels"))
					.append($("<div>").addClass("form-row")
						.append($("<ol>").attr("id", "node-input-win_levels-container")))
					.append($("<h3>").text("Transaction Information"))
					.append(g2sUtils.input({id:"node-input-egm_tx_id", type:"number", text: "EGM Tx Id", placeholder:"Transaction Id, empty for auto generation"}))
				.appendTo(container);

			$("#node-input-win_levels-container").css('min-height','200px').css('min-width','400px').editableList({
				addItem: function(container,i,opt) {
					var dflt_index = 0;
					if(opt.hasOwnProperty("index"))
						dflt_index = opt.index;

					container.css({
                        overflow: 'hidden',
                        whiteSpace: 'nowrap'
                    });
                    var row = $('<div/>').appendTo(container);
					$('<label for="win_level_index"><i class="icon-tag"></i> Index</label>').appendTo(row);
					$('<input type="number" id="node-input-win_level_index">').val(dflt_index).appendTo(row);
				},
				removeItem: function(opt) {
				},
				removable: true
			});
		},
		getData: function(){
			let this_data = {};
			this_data.game_info = g2sDataMap.get("game_info").getData();
			
			var win_levels_list = $("#node-input-win_levels-container").editableList('items');
            let current_win_levels = [];

			var num = 0;
			win_levels_list.each(function(i) {
				var index = $(this).find("input").val();
				current_win_levels.push(index);
			});

			this_data.win_levels = current_win_levels;
			
			if($("#node-input-win_amt").val().length > 0)
				this_data.win_amt = Number($("#node-input-win_amt").val());
			
			if($("#node-input-egm_tx_id").val().length > 0)
				this_data.egm_tx_id = Number($("#node-input-egm_tx_id").val());
			else
				this_data.egm_tx_id = -1;
				
			return this_data;
		},
		setData: function(data){
			g2sDataMap.get("game_info").setData(data.game_info);
			
			if(data.win_amt !== undefined)
				$("#node-input-win_amt").val(data.win_amt);
				
			for (var i=0;i < data.win_levels.length; i++) {
                var index_val = data.win_levels[i];
                $("#node-input-win_levels-container").editableList('addItem',{index:index_val});
			}
			
			if(data.egm_tx_id != -1)
				$("#node-input-egm_tx_id").val(data.egm_tx_id);
		},
		getNodeLabel: function(data){
			if(data.win_amt !== undefined)
				return "Secondary Game Ended (win " + data.win_amt + ")";
			else
				return "Secondary Game Ended";
		},
		helper: function(helper_panel){
			let properties = $("<dl>").addClass("message-properties");

			properties.append($("<b>").text("Game Info"))
			.append(g2sDataMap.get("game_info").append_helper_properties(properties));
			
			properties.append($("<b>").text("Win Info"));
			g2sUtils.helperProp(properties, "Win Amount", "Integer", "Amount won during the secondary game play");
			
			properties.append($("<b>").text("Win Levels"));
			g2sUtils.helperProp(properties, "Level Indexes", "Array", "List of win level Indexes");
			
			properties.append($("<b>").text("Transaction Info"));
			g2sUtils.helperProp(properties, "EGM Tx Id", "Integer", "EGM transaction id of this action. Leave empty to allow the simualtor send the escrowed id used");
			
			helper_panel
			.append($("<p>").html("Simulates the end of the secondary game state. To see the entire flow of a game cycle, refer to G2S Section 6.5 playState Transition." + 
			"<br><br><b>NOTE</b> This is a multi part transaction. This action and subsequen game state transition action require a transaction id to be passed " +
            "in. User can specify their own, or leave empty to let the simulation generate the id. The id must increment for each subsequent game play transation action").append("<br>"))
			.append($("<h3>").text("Inputs"))
			.append(properties);
		}
	});
	gpActionMap.set("Pay Game Result", {
		id: "Pay Game Result",
		method:"g2s.egm.G2S_gamePlay.pay_game_result",
		buildDataPanel: function(container){
		$("<div>").append($("<h3>").text("Game Information"))
			.append(g2sDataMap.get("game_info").dataPanel())
			.append($("<h3>").text("Transaction Information"))
				.append(g2sUtils.input({id:"node-input-egm_tx_id", type:"number", text: "EGM Tx Id", placeholder:"Transaction Id, empty for auto generation"}))
				.appendTo(container);
		},
		getData: function(){
			let this_data = {};
			this_data.game_info = g2sDataMap.get("game_info").getData();
			if($("#node-input-egm_tx_id").val().length > 0)
				this_data.egm_tx_id = Number($("#node-input-egm_tx_id").val());
			else
				this_data.egm_tx_id = -1;
				
			return this_data;
		},
		setData: function(data){
			g2sDataMap.get("game_info").setData(data.game_info);
			if(data.egm_tx_id != -1)
				$("#node-input-egm_tx_id").val(data.egm_tx_id);
		},
		helper: function(helper_panel){
			let properties = $("<dl>").addClass("message-properties");

			properties.append($("<b>").text("Game Info"))
			.append(g2sDataMap.get("game_info").append_helper_properties(properties));
			
			properties.append($("<b>").text("Transaction Info"));
			g2sUtils.helperProp(properties, "EGM Tx Id", "Integer", "EGM transaction id of this action. Leave empty to allow the simualtor send the escrowed id used");
			
			helper_panel
			.append($("<p>").html("Simulates the state where a player is paid the winning of the game. To see the entire flow of a game cycle, refer to G2S Section 6.5 playState Transition." + 
			"<br><br><b>NOTE</b> This is a multi part transaction. This action and subsequen game state transition action require a transaction id to be passed " +
            "in. User can specify their own, or leave empty to let the simulation generate the id. The id must increment for each subseque game play transation action").append("<br>"))
			.append($("<h3>").text("Inputs"))
			.append(properties);
		}
	});
	gpActionMap.set("Game Ended", {
		id: "Game Ended",
		method:"g2s.egm.G2S_gamePlay.game_ended",
		buildDataPanel: function(container){
			$("<div>").append($("<h3>").text("Game Information"))
				.append(g2sDataMap.get("game_info").dataPanel())
				.append($("<h3>").text("Transaction Information"))
					.append(g2sUtils.input({id:"node-input-egm_tx_id", type:"number", text: "EGM Tx Id", placeholder:"Transaction Id, empty for auto generation"}))
					.appendTo(container);
		},
		getData: function(){
			let this_data = {};
			this_data.game_info = g2sDataMap.get("game_info").getData();
			if($("#node-input-egm_tx_id").val().length > 0)
				this_data.egm_tx_id = Number($("#node-input-egm_tx_id").val());
			else
				this_data.egm_tx_id = -1;
				
			return this_data;
		},
		setData: function(data){
			g2sDataMap.get("game_info").setData(data.game_info);
			if(data.egm_tx_id != -1)
				$("#node-input-egm_tx_id").val(data.egm_tx_id);
		},
		helper: function(helper_panel){
			let properties = $("<dl>").addClass("message-properties");

			properties.append($("<b>").text("Game Info"))
			.append(g2sDataMap.get("game_info").append_helper_properties(properties));
			
			properties.append($("<b>").text("Transaction Info"));
			g2sUtils.helperProp(properties, "EGM Tx Id", "Integer", "EGM transaction id of this action. Leave empty to allow the simualtor send the escrowed id used");
			
			helper_panel
			.append($("<p>").html("Simulates the end of the game cycle state. To see the entire flow of a game cycle, refer to G2S Section 6.5 playState Transition." + 
			"<br><br><b>NOTE</b> This is a multi part transaction. This action and subsequen game state transition action require a transaction id to be passed " +
            "in. User can specify their own, or leave empty to let the simulation generate the id. The id must increment for each subseque game play transation action").append("<br>"))
			.append($("<h3>").text("Inputs"))
			.append(properties);
		}
	});
	gpActionMap.set("Game Idle", {
		id: "Game Idle",
		method:"g2s.egm.G2S_gamePlay.game_idle",
		buildDataPanel: function(container){
			$("<div>").append($("<h3>").text("Game Information"))
				.append(g2sDataMap.get("game_info").dataPanel())
				.append($("<h3>").text("Transaction Information"))
					.append(g2sUtils.input({id:"node-input-egm_tx_id", type:"number", text: "EGM Tx Id", placeholder:"Transaction Id, empty for auto generation"}))
					.appendTo(container);
		},
		getData: function(){
			let this_data = {};
			this_data.game_info = g2sDataMap.get("game_info").getData();
			if($("#node-input-egm_tx_id").val().length > 0)
				this_data.egm_tx_id = Number($("#node-input-egm_tx_id").val());
			else
				this_data.egm_tx_id = -1;
				
			return this_data;
		},
		setData: function(data){
			g2sDataMap.get("game_info").setData(data.game_info);
			if(data.egm_tx_id != -1)
				$("#node-input-egm_tx_id").val(data.egm_tx_id);
		},
		helper: function(helper_panel){
			let properties = $("<dl>").addClass("message-properties");

			properties.append($("<b>").text("Game Info"))
			.append(g2sDataMap.get("game_info").append_helper_properties(properties));
			
			properties.append($("<b>").text("Transaction Info"));
			g2sUtils.helperProp(properties, "EGM Tx Id", "Integer", "EGM transaction id of this action. Leave empty to allow the simualtor send the escrowed id used");
			
			helper_panel
			.append($("<p>").html("Simulates teh state where the game is complete and a new game ccle can begin. To see the entire flow of a game cycle, refer to G2S Section 6.5 playState Transition." + 
			"<br><br><b>NOTE</b> This is a multi part transaction. This action and subsequen game state transition action require a transaction id to be passed " +
            "in. User can specify their own, or leave empty to let the simulation generate the id. The id must increment for each subseque game play transation action").append("<br>"))
			.append($("<h3>").text("Inputs"))
			.append(properties);
		}
	});
	classActionMap.set("G2S_gamePlay", gpActionMap);

	var idActionMap = new Map();
	idActionMap.set("Error", {
		id: "Error",
		method:"g2s.egm.G2S_idReader.errors.set_error",
		buildDataPanel: function(container){
			$("<div>").append($("<h3>").text("Device Information"))
				.append(g2sUtils.input({id:"node-input-device_uid", type:"text", text: "Device UID", placeholder:"Unique Identifer"}))
				.append($("<h3>").text("Error Information"))
				.append(g2sUtils.errorListInput([   {value:1, text:"Illegal Activity Detected"},
													{value:2, text:"Disconnected"},
													{value:3, text:"Firmware Error"},
													{value:4, text:"Mechanical Error"},
													{value:5, text:"Optical Error"},
													{value:6, text:"Non volatile memory Error"}]))
				.appendTo(container);
		},
		getData: function(){
			return {
				device_info:{
					uid:$("#node-input-device_uid").val()
				},
				error_info:{
					error_code: Number($("#node-input-error_code").val()),
					set_flag:$("#node-input-err_set_flag").prop('checked')
				}
			};
		},
		setData: function(data){
			$("#node-input-device_uid").val(data.device_info.uid);
			$("#node-input-error_code").val(data.error_info.error_code);
			$("#node-input-err_set_flag").prop('checked', data.error_info.set_flag);
		},
		getNodeLabel: function(data){
			let error_txt = "";
			switch(data.error_info.error_code){
				case 1:	error_txt = "Illegal Activity Detected"; break;
				case 2:	error_txt = "Disconnected";	break;
				case 3:	error_txt = "Firmware Error"; break;
				case 4: error_txt = "Mechanical Error"; break;
				case 5: error_txt = "Optical Error"; break;
				case 6: error_txt = "Non volatile memory Error"; break;
				default: error_txt = "Generic (" + data.error_info.error_code + ")";
			}
			return "G2S_idReader (" + data.device_info.uid + ")" + (data.error_info.set_flag ? "Set " : "Clear " ) + error_txt;
		},
		helper: function(helper_panel){
			let properties = $("<dl>").addClass("message-properties");
			
			g2sUtils.helperProp(properties, "Device UID", "String", "Unique Identifier string of the Id reader device to simulate (within the EGM simulator, this is the name fo the device to simulate)");
			g2sUtils.helperProp(properties, "Error Code", "Integer", "Error Code to simulate. Any error code value not in the drop down list is treated as a generic error");
			g2sUtils.helperProp(properties, "Set Flag", "Boolean", "Whether to set or clear the error code");
			
			helper_panel
			.append($("<p>").html("Simulates an error occuring on the specified IdReader device").append("<br>"))
			.append($("<h3>").text("Inputs"))
			.append(properties);
		}
	});
	idActionMap.set("Id Inserted", {
		id: "Id Inserted",
		method:"g2s.egm.G2S_idReader.id.inserted",
		buildDataPanel: function(container){
			$("<div>").append($("<h3>").text("Device Information"))
				.append(g2sUtils.input({id:"node-input-device_uid", type:"text", text: "Device UID", placeholder:"Unique Identifer"}))
				.append($("<h3>").text("Id Information"))
				.append(g2sUtils.input({id:"node-input-inserted_id", type:"text", text: "Id Number", placeholder:"Id"}))
				.appendTo(container);
		},
		getData: function(){
			return {
				device_info:{
					uid:$("#node-input-device_uid").val()
				},
				id_number: $("#node-input-inserted_id").val()
			};
		},
		setData: function(data){
			$("#node-input-device_uid").val(data.device_info.uid);
			$("#node-input-inserted_id").val(data.id_number);
		},
		getNodeLabel: function(data){
			return "G2S_idReader Id inserted (" + data.id_number + " in " + data.device_info.uid +")";
		},
		helper: function(helper_panel){
			let properties = $("<dl>").addClass("message-properties");
			
			g2sUtils.helperProp(properties, "Device UID", "String", "Unique Identifier string of the Id reader device to simulate (within the EGM simulator, this is the name fo the device to simulate)");
			g2sUtils.helperProp(properties, "Id Number", "String", "Identification number to simulate insertion with. This would be the id read, example the data on the magnetic stripe card at the configured track");
			
			helper_panel
			.append($("<p>").html("Simulates the insertion of an ID at the specified device").append("<br>"))
			.append($("<h3>").text("Inputs"))
			.append(properties);
		}
	});
	idActionMap.set("Id Removed", {
		id: "Id Removed",
		method:"g2s.egm.G2S_idReader.id.removed",
		buildDataPanel: function(container){
			$("<div>").append($("<h3>").text("Device Information"))
				.append(g2sUtils.input({id:"node-input-device_uid", type:"text", text: "Device UID", placeholder:"Unique Identifer"}))
				.appendTo(container);
		},
		getData: function(){
			return {
				device_info:{
					uid:$("#node-input-device_uid").val()
				}
			};
		},
		setData: function(data){
			$("#node-input-device_uid").val(data.device_info.uid);
		},
		getNodeLabel: function(data){
			return "G2S_idReader Id Removed (" + data.device_info.uid + ")";
		},
		helper: function(helper_panel){
			let properties = $("<dl>").addClass("message-properties");
			
			g2sUtils.helperProp(properties, "Device UID", "String", "Unique Identifier string of the Id reader device to simulate (within the EGM simulator, this is the name fo the device to simulate)");
			
			helper_panel
			.append($("<p>").html("Simulates the removal of an ID at the specified device").append("<br>"))
			.append($("<h3>").text("Inputs"))
			.append(properties);
		}
	});
	classActionMap.set("G2S_idReader", idActionMap);

	var mddActionMap = new Map();
	mddActionMap.set("Content Error", {
		id: "Content Error",
		method:"g2s.egm.IGT_mediaDisplay.content.error",
		buildDataPanel: function(container){
			$("<div>").append($("<h3>").text("Device Information"))
				.append(g2sUtils.input({id:"node-input-mdd_name", type:"text", text: "Display name", placeholder:"template name"}))
				.append($("<h3>").text("Error Information"))
				.append(g2sUtils.errorListInput([   {value:1, text:"Content transfer failed"},
													{value:2, text:"Content exceeds file size limitations"},
													{value:3, text:"Content runtime error"},
													{value:4, text:"Resource limits exceeded"},
													{value:5, text:"Invalid MD access token"},
													{value:6, text:"EMDI connection required/EMDI reconnect timer expired"},
													{value:7, text:"Certificate Validation Failed"},
													{value:8, text:"Host Unreachable"}], false))
				.appendTo(container);
		},
		getData: function(){
			return {
				mdd_name: $("#node-input-mdd_name").val(),
				error_code: Number($("#node-input-error_code").val())
			};
		},
		setData: function(data){
			$("#node-input-mdd_name").val(data.display_name);
			$("#node-input-error_code").val(data.error_code);
		},
		getNodeLabel: function(data){
			let error_txt = "";
			switch(data.error_code){
				case 1:	error_txt = "Content transfer failed"; break;
				case 2:	error_txt = "Content exceeds file size limitations";	break;
				case 3:	error_txt = "Content runtime error"; break;
				case 4: error_txt = "Resource limits exceeded"; break;
				case 5: error_txt = "Invalid MD access token"; break;
				case 6: error_txt = "EMDI connection required/EMDI reconnect timer expired"; break;
				case 7: error_txt = "Certificate Validation Failed"; break;
				case 8: error_txt = "Host Unreachable"; break;
				default: error_txt = "Generic (" + data.error_code + ")";
			}
			return "IGT_mediaDisplay (" + data.mdd_name + ")" + (data.set_flag ? "Set " : "Clear " ) + error_txt;
		},
		helper: function(helper_panel){
			let properties = $("<dl>").addClass("message-properties");
			
			g2sUtils.helperProp(properties, "Display name", "String", "Unique Identifier string of the Media Display Device (MDD) to simulate the error (within the EGM simulator, this is the name fo the device to simulate)");
			g2sUtils.helperProp(properties, "Error Code", "Integer", "Error Code to simulate. Any error code value not in the drop down list is treated as a generic error");
			g2sUtils.helperProp(properties, "Set Flag", "Boolean", "Whether to set or clear the error code");
			
			helper_panel
			.append($("<p>").html("Simulates an error within the Media Display Device (MDD)").append("<br>"))
			.append($("<h3>").text("Inputs"))
			.append(properties);
		}
	});
	mddActionMap.set("Content Loaded", {
		id: "Content Loaded",
		method:"g2s.egm.IGT_mediaDisplay.content.loaded",
		buildDataPanel: function(container){
			$("<div>").append($("<h3>").text("Content Information"))
				.append(g2sUtils.input({id:"node-input-content_id", type:"number", text: "Content Id", placeholder:"id"}))
				.appendTo(container);
		},
		getData: function(){
			return {
				content_id: Number($("#node-input-content_id").val())
			};
		},
		setData: function(data){
			$("#node-input-content_id").val(data.content_id);
		},
		getNodeLabel: function(data){
			return "IGT_mediaDisplay Content Loaded (" + data.content_id + ")";
		},
		helper: function(helper_panel){
			let properties = $("<dl>").addClass("message-properties");
			
			g2sUtils.helperProp(properties, "Content Id", "Integer", "Id of the content to notify G2S engine that it has now been loaded");
						
			helper_panel
			.append($("<p>").html("Simulates the completion of the loading of the content with the Media Display Device (MDD)").append("<br>"))
			.append($("<h3>").text("Inputs"))
			.append(properties);
		}
	});
	mddActionMap.set("Display shown", {
		id: "Display shown",
		method:"g2s.egm.IGT_mediaDisplay.media_display.shown",
		buildDataPanel: function(container){
			$("<div>").append($("<h3>").text("Device Information"))
				.append(g2sUtils.input({id:"node-input-mdd_name", type:"text", text: "Display name", placeholder:"template name"}))
				.appendTo(container);
		},
		getData: function(){
			return {
				mdd_name: $("#node-input-mdd_name").val()
			};
		},
		setData: function(data){
			$("#node-input-mdd_name").val(data.display_name);
		},
		getNodeLabel: function(data){
			return "IGT_mediaDisplay (" + data.mdd_name + ") is shown";
		},
		helper: function(helper_panel){
			let properties = $("<dl>").addClass("message-properties");
			
			g2sUtils.helperProp(properties, "Display name", "String", "Unique Identifier string of the Media Display Device (MDD) to simulate (within the EGM simulator, this is the name fo the device to simulate)");
						
			helper_panel
			.append($("<p>").html("Simulates the notification of a Media Display Device is now in a shown state").append("<br>"))
			.append($("<h3>").text("Inputs"))
			.append(properties);
		}
	});
	mddActionMap.set("Display hidden", {
		id: "Display hidden",
		method:"g2s.egm.IGT_mediaDisplay.media_display.hidden",
		buildDataPanel: function(container){
			$("<div>").append($("<h3>").text("Device Information"))
				.append(g2sUtils.input({id:"node-input-mdd_name", type:"text", text: "Display name", placeholder:"template name"}))
				.appendTo(container);
		},
		getData: function(){
			return {
				mdd_name: $("#node-input-mdd_name").val()
			};
		},
		setData: function(data){
			$("#node-input-mdd_name").val(data.display_name);
		},
		getNodeLabel: function(data){
			return "IGT_mediaDisplay (" + data.mdd_name + ") is hidden";
		},
		helper: function(helper_panel){
			let properties = $("<dl>").addClass("message-properties");
			
			g2sUtils.helperProp(properties, "Display name", "String", "Unique Identifier string of the Media Display Device (MDD) to simulate (within the EGM simulator, this is the name fo the device to simulate)");
						
			helper_panel
			.append($("<p>").html("Simulates the notification of a Media Display Device is now in a hidden state").append("<br>"))
			.append($("<h3>").text("Inputs"))
			.append(properties);
		}
	});
	mddActionMap.set("Display Top Most", {
		id: "Display Top Most",
		method:"g2s.egm.IGT_mediaDisplay.media_display.top_most",
		buildDataPanel: function(container){
			$("<div>").append($("<h3>").text("Device Information"))
				.append(g2sUtils.input({id:"node-input-mdd_name", type:"text", text: "Display name", placeholder:"template name"}))
				.appendTo(container);
		},
		getData: function(){
			return {
				mdd_name: $("#node-input-mdd_name").val()
			};
		},
		setData: function(data){
			$("#node-input-mdd_name").val(data.display_name);
		},
		getNodeLabel: function(data){
			return "IGT_mediaDisplay (" + data.mdd_name + ") is top most";
		},
		helper: function(helper_panel){
			let properties = $("<dl>").addClass("message-properties");
			
			g2sUtils.helperProp(properties, "Display name", "String", "Unique Identifier string of the Media Display Device (MDD) to simulate (within the EGM simulator, this is the name fo the device to simulate)");
						
			helper_panel
			.append($("<p>").html("Simulates the notification of a Media Display Device is now in the most most state").append("<br>"))
			.append($("<h3>").text("Inputs"))
			.append(properties);
		}
	});
	mddActionMap.set("Display Not Top Most", {
		id: "Display Not Top Most",
		method:"g2s.egm.IGT_mediaDisplay.media_display.not_top_most",
		buildDataPanel: function(container){
			$("<div>").append($("<h3>").text("Device Information"))
				.append(g2sUtils.input({id:"node-input-mdd_name", type:"text", text: "Display name", placeholder:"template name"}))
				.appendTo(container);
		},
		getData: function(){
			return {
				mdd_name: $("#node-input-mdd_name").val()
			};
		},
		setData: function(data){
			$("#node-input-mdd_name").val(data.display_name);
		},
		getNodeLabel: function(data){
			return "IGT_mediaDisplay (" + data.mdd_name + ") is not top most";
		},
		helper: function(helper_panel){
			let properties = $("<dl>").addClass("message-properties");
			
			g2sUtils.helperProp(properties, "Display name", "String", "Unique Identifier string of the Media Display Device (MDD) to simulate (within the EGM simulator, this is the name fo the device to simulate)");
						
			helper_panel
			.append($("<p>").html("Simulates the notification of a Media Display Device is now NOT in the most most state").append("<br>"))
			.append($("<h3>").text("Inputs"))
			.append(properties);
		}
	});
	mddActionMap.set("Display Is Modal", {
		id: "Display Is Modal",
		method:"g2s.egm.IGT_mediaDisplay.media_display.in_modal",
		buildDataPanel: function(container){
			$("<div>").append($("<h3>").text("Device Information"))
				.append(g2sUtils.input({id:"node-input-mdd_name", type:"text", text: "Display name", placeholder:"template name"}))
				.appendTo(container);
		},
		getData: function(){
			return {
				mdd_name: $("#node-input-mdd_name").val()
			};
		},
		setData: function(data){
			$("#node-input-mdd_name").val(data.display_name);
		},
		getNodeLabel: function(data){
			return "IGT_mediaDisplay (" + data.mdd_name + ") is modal";
		},
		helper: function(helper_panel){
			let properties = $("<dl>").addClass("message-properties");
			
			g2sUtils.helperProp(properties, "Display name", "String", "Unique Identifier string of the Media Display Device (MDD) to simulate (within the EGM simulator, this is the name fo the device to simulate)");
						
			helper_panel
			.append($("<p>").html("Simulates the notification of a Media Display Device is now shown in a Modal state").append("<br>"))
			.append($("<h3>").text("Inputs"))
			.append(properties);
		}
	});
	mddActionMap.set("Display Is Not Modal", {
		id: "Display Is Not Modal",
		method:"g2s.egm.IGT_mediaDisplay.media_display.in_modal",
		buildDataPanel: function(container){
			$("<div>").append($("<h3>").text("Device Information"))
				.append(g2sUtils.input({id:"node-input-mdd_name", type:"text", text: "Display name", placeholder:"template name"}))
				.appendTo(container);
		},
		getData: function(){
			return {
				mdd_name: $("#node-input-mdd_name").val()
			};
		},
		setData: function(data){
			$("#node-input-mdd_name").val(data.display_name);
		},
		getNodeLabel: function(data){
			return "IGT_mediaDisplay (" + data.mdd_name + ") is not modal";
		},
		helper: function(helper_panel){
			let properties = $("<dl>").addClass("message-properties");
			
			g2sUtils.helperProp(properties, "Display name", "String", "Unique Identifier string of the Media Display Device (MDD) to simulate (within the EGM simulator, this is the name fo the device to simulate)");
						
			helper_panel
			.append($("<p>").html("Simulates the notification of a Media Display Device is now NOT in a Modal state").append("<br>"))
			.append($("<h3>").text("Inputs"))
			.append(properties);
		}
	});
	mddActionMap.set("Display Suspended Game Play", {
		id: "Display Suspended Game Play",
		method:"g2s.egm.IGT_mediaDisplay.media_display.suspended_game_play",
		buildDataPanel: function(container){
			$("<div>").append($("<h3>").text("Device Information"))
				.append(g2sUtils.input({id:"node-input-mdd_name", type:"text", text: "Display name", placeholder:"template name"}))
				.appendTo(container);
		},
		getData: function(){
			return {
				mdd_name: $("#node-input-mdd_name").val()
			};
		},
		setData: function(data){
			$("#node-input-mdd_name").val(data.display_name);
		},
		getNodeLabel: function(data){
			return "IGT_mediaDisplay (" + data.mdd_name + ") suspended game play";
		},
		helper: function(helper_panel){
			let properties = $("<dl>").addClass("message-properties");
			
			g2sUtils.helperProp(properties, "Display name", "String", "Unique Identifier string of the Media Display Device (MDD) to simulate (within the EGM simulator, this is the name fo the device to simulate)");
						
			helper_panel
			.append($("<p>").html("Simulates the notification that game play has been suspended by the Media Display Device").append("<br>"))
			.append($("<h3>").text("Inputs"))
			.append(properties);
		}
	});
	mddActionMap.set("Display Cleared Suspended Game Play", {
		id: "Display Cleared Suspended Game Play",
		method:"g2s.egm.IGT_mediaDisplay.media_display.cleared_suspended_game_play",
		buildDataPanel: function(container){
			$("<div>").append($("<h3>").text("Device Information"))
				.append(g2sUtils.input({id:"node-input-mdd_name", type:"text", text: "Display name", placeholder:"template name"}))
				.appendTo(container);
		},
		getData: function(){
			return {
				mdd_name: $("#node-input-mdd_name").val()
			};
		},
		setData: function(data){
			$("#node-input-mdd_name").val(data.display_name);
		},
		getNodeLabel: function(data){
			return "IGT_mediaDisplay (" + data.mdd_name + ") cleared suspended game play";
		},
		helper: function(helper_panel){
			let properties = $("<dl>").addClass("message-properties");
			
			g2sUtils.helperProp(properties, "Display name", "String", "Unique Identifier string of the Media Display Device (MDD) to simulate (within the EGM simulator, this is the name fo the device to simulate)");
						
			helper_panel
			.append($("<p>").html("Simulates the notification that the suspended game play state has been cleared by the Media Display Device").append("<br>"))
			.append($("<h3>").text("Inputs"))
			.append(properties);
		}
	});
	mddActionMap.set("Content to Host Message", {
		id: "Content to Host Message",
		method:"g2s.egm.IGT_mediaDisplay.content.forward_content_msg",
		buildDataPanel: function(container){
			$("<div>").append($("<h3>").text("Device Information"))
				.append(g2sUtils.input({id:"node-input-mdd_name", type:"text", text: "Display name", placeholder:"template name"}))
				.append(g2sUtils.input({id:"node-input-content_id", type:"number", text: "Content Id", placeholder:"id"}))
				.append(g2sUtils.startRow({id:"node-input-content_data", text:"Message Content"})
					.append($("<input>").attr("type", "text").attr("id", "node-input-content_data"))
					.append($("<input>").attr("type", "hidden").attr("id", "node-input-content_type")))
				.appendTo(container);

			$('#node-input-content_data').typedInput({
			 	default: 'str',
			 	typeField: $("#node-input-content_type"),
			 	types: ['str','json']
			 });
		},
		getData: function(){
			return {
				mdd_name: $("#node-input-mdd_name").val(),
				content_id: Number($("#node-input-content_id").val()),
				content_data: $("#node-input-content_data").val(),
				content_type: $("#node-input-content_type").val()
			};
		},
		setData: function(data){
			$("#node-input-mdd_name").val(data.mdd_name);
			$("#node-input-content_id").val(data.content_data);
			$("#node-input-content_data").val(data.content_data);
			$("#node-input-content_type").val(data.content_type);
		},
		getNodeLabel: function(data){
			return "IGT_mediaDisplay (" + data.mdd_name + ") Forward Msg";
		},
		helper: function(helper_panel){
			let properties = $("<dl>").addClass("message-properties");
			
			g2sUtils.helperProp(properties, "Display name", "String", "Unique Identifier string of the Media Display Device (MDD) to simulate (within the EGM simulator, this is the name fo the device to simulate)");
			g2sUtils.helperProp(properties, "Content Id", "Integer", "Id of the content sending the host message");
			g2sUtils.helperProp(properties, "Message Content", "String|Json", "Host Message Content to be delivered");
			
			helper_panel
			.append($("<p>").html("Simulates the notification that the suspended game play state has been cleared by the Media Display Device").append("<br>"))
			.append($("<h3>").text("Inputs"))
			.append(properties);
		}
	});
	classActionMap.set("IGT_mediaDisplay", mddActionMap);

	var mysteryActionMap = new Map();
	mysteryActionMap.set("Any Pending Mysteries", {
		id: "Any Pending Mysteries",
		method: "g2s.egm.sim.mystery_mngr.any_mystery_pending",
		// Below is how this g2s API can display it's required data
		buildDataPanel: function(container){			
		},
		// returns the json representation of the data for this exposed API
		getData: function(){
			return {};
		},
		// recovery from a json representation of the data last set
		setData: function(data){			
		},
		// Allows this node to use this node's specific data to generate some meaningful label name for the flow nodes
		getNodeLabel: function(data){
			return "Any Pending Mysteries?";
		},
		helper: function(helper_panel){
			let properties = $("<dl>").addClass("message-properties");
			
			g2sUtils.helperProp(properties, "bonus_pending", "Boolean", "Whether there are any pending bonuses to be paid to the player");
						
			helper_panel
			.append($("<p>").html("Queries the G2S engine to see if there are any pending bonus (mystery class setMysteryAward)").append("<br>"))
			.append($("<h3>").text("Outputs"))
			.append(properties);
		}
	});
	mysteryActionMap.set("Get Next Mystery", {
		id: "Get Next Mystery",
		method: "g2s.egm.sim.mystery_mngr.get_next_mystery",
		// Below is how this g2s API can display it's required data
		buildDataPanel: function(container){			
		},
		// returns the json representation of the data for this exposed API
		getData: function(){
			return {};
		},
		// recovery from a json representation of the data last set
		setData: function(data){			
		},
		// Allows this node to use this node's specific data to generate some meaningful label name for the flow nodes
		getNodeLabel: function(data){
			return "Get Next Mystery";
		},
		helper: function(helper_panel){						
			let properties = $("<dl>").addClass("message-properties");
			
			properties.append($("<b>").text("Bonus Award Info"));
			g2sUtils.helperProp(properties, "award_id", "Integer", "Id of the next pending award");
			g2sUtils.helperProp(properties, "amount", "Integer", "Amount of the next pending award");
			g2sUtils.helperProp(properties, "pay_method", "String", "Expected pay method (where it is to be paid) of the next pending award");
			g2sUtils.helperProp(properties, "credit_type", "String", "Type of credits in the next pending award");
			g2sUtils.helperProp(properties, "expire_credits", "Boolean", "Whether the non-cashable credits types have an expiration in next pending award");
			g2sUtils.helperProp(properties, "expire_dt_ms", "Integer", "The expired date and time in milliseconds since epoch for the non cashable credit in next pending award");
						
			helper_panel
			.append($("<p>").html("Queries the G2S engine to return the information on the next bonus mystery award to be paid").append("<br>"))
			.append($("<h3>").text("Outputs"))
			.append(properties);
		}
	});
	mysteryActionMap.set("Award Paid", {
		id: "Award Paid",
		method:"g2s.egm.G2S_mystery.award.awarded",
		buildDataPanel: function(container){

		$("<div>").append($("<h3>").text("Award Information"))
			.append(g2sUtils.input({id:"node-input-award_id", type:"number", text: "Mystery Award Id", placeholder:"id"}))
			.append(g2sUtils.input({id:"node-input-amount_paid", type:"number", text: "Amount paid (millicents)", placeholder:"amount paid"}))
			.append(g2sUtils.selectInput([	{value:"", text:""},
											{value:"G2S_cashable", text:"Cashable"},
											{value:"G2S_nonCash", text:"Non-Cashable"},
											{value:"G2S_promo", text:"Promotional"}], {id:"node-input-amount_credit_type", text: "Credit Type"}))
			.append(g2sUtils.selectInput([	{value:"G2S_payCredit", text:"To Credit Bank"},
											{value:"G2S_payVoucher", text:"To a voucher"},
											{value:"G2S_payWat", text:"To a wagering account"},
											{value:"G2S_payHandpay", text:"To hand pay"}], {id:"node-input-pay_method_used", text: "Pay Method"}))
			.append(g2sUtils.input({id:"node-input-egm_tx_id", type:"number", text: "EGM Tx Id", placeholder:"Transaction Id, empty for auto generation"}))
			.appendTo(container);
		},
		getData: function(){
			let data = {}
			let _mystery_award_info = {};
			if($("#node-input-award_id").val().length > 0)
				_mystery_award_info.award_id = Number($("#node-input-award_id").val());
			if($("#node-input-amount_paid").val().length > 0)
				_mystery_award_info.amount = Number($("#node-input-amount_paid").val())
			if($("#node-input-amount_credit_type").val().length > 0)
				_mystery_award_info.credit_type = $("#node-input-amount_credit_type").val();
			if($("#node-input-pay_method_used").val().length > 0)
				_mystery_award_info.pay_method = $("#node-input-pay_method_used").val();
				
			data.mystery_award_info = _mystery_award_info;
			
			if($("#node-input-egm_tx_id").val().length > 0)
				data.egm_tx_id = Number($("#node-input-egm_tx_id").val());
			else
				data.egm_tx_id = -1;
				
			return data;
		},
		setData: function(data){
			if(data.mystery_award_info.award_id !== undefined)
				$("#node-input-award_id").val(data.mystery_award_info.award_id);
			if(data.mystery_award_info.amount_paid !== undefined)
				$("#node-input-amount_paid").val(data.mystery_award_info.amount);
			if(data.mystery_award_info.credit_type !== undefined)
				$("#node-input-amount_credit_type").val(data.mystery_award_info.credit_type);
			if(data.mystery_award_info.pay_method !== undefined)
				$("#node-input-pay_method_used").val(data.mystery_award_info.pay_method);
				
			if(data.egm_tx_id != -1)
				$("#node-input-egm_tx_id").val(data.egm_tx_id);
		},
		getNodeLabel: function(data){
			if(data.mystery_award_info.amount !== undefined)
				return "G2S_mystery awarded (" + data.mystery_award_info.amount + ")";
			else
				return "G2S_mystery awarded";
		},
		helper: function(helper_panel){
			let properties = $("<dl>").addClass("message-properties");
			
			g2sUtils.helperProp(properties, "Mystery Award Id", "Integer", "Id of the award that was paid");
			g2sUtils.helperProp(properties, "Amount paid", "Integer", "How much was paid to the player in millicents");
			g2sUtils.helperProp(properties, "Credit type", "String", "Type of credits used for this award. Only used when in an EGM owned mystery award");
			g2sUtils.helperProp(properties, "Pay Method", "String", "How the award was paid to the player");
			g2sUtils.helperProp(properties, "TxId of payment", "Integer", "EGM transaction id of this action. This id must differ from the last award payment to be accepted. Leave empty to have simulator " + 
			"generate a valid id");
			
			helper_panel
			.append($("<p>").html("Simulates the notification that a mystery award was paid to the player").append("<br>"))
			.append($("<h3>").text("Inputs"))
			.append(properties);
		}
	});
	mysteryActionMap.set("Award Failed", {
		id: "Award Failed",
		method:"g2s.egm.G2S_mystery.award.failed",
		buildDataPanel: function(container){

		$("<div>").append($("<h3>").text("Award Information"))
			.append(g2sUtils.input({id:"node-input-award_id", type:"number", text: "Mystery Award Id", placeholder:"id"}))
			.append(g2sUtils.input({id:"node-input-egm_tx_id", type:"number", text: "EGM Tx Id", placeholder:"Transaction Id, empty for auto generation"}))
			.append(g2sUtils.inputWithDataList([{value:"1", text:"Payment method not available"},
												{value:"2", text:"Type of credits cannot be accepted"},
												{value:"3", text:"Cannot mix non-cashable credits"},
												{value:"4", text:"Cannot mix non-cashable expirations"},
												{value:"5", text:"Non-cashable handpay not supported"},
												{value:"6", text:"Unable to award mystery jackpot"},
												{value:"99", text:"Unspecified reason"}], {id:"node-input-exception_code", text: "Exception Code"}))
			.appendTo(container);
		},
		getData: function(){
			let data = {};
			let _mystery_award_info = {};
			if($("#node-input-award_id").val().length > 0)
				_mystery_award_info.award_id = Number($("#node-input-award_id").val());
							
			data.mysery_award_info = _mystery_award_info;
			data.exception_code = $("#node-input-exception_code").prop('checked');
			if($("#node-input-egm_tx_id").val().length > 0)
				data.egm_tx_id = Number($("#node-input-egm_tx_id").val());
			else
				data.egm_tx_id = -1;
				
			return data;
		},
		setData: function(data){
			if(data.mysery_award_info.award_id !== undefined)
				$("#node-input-award_id").val(data.mysery_award_info.award_id);
				
			$("#node-input-exception_code").prop('checked', data.exception_code);
			
			if(data.egm_tx_id != -1)
				$("#node-input-egm_tx_id").val(data.egm_tx_id);
		},
		getNodeLabel: function(data){
			return "G2S_mystery award failed (" + data.exception_code + ")";
		},
		helper: function(helper_panel){
			let properties = $("<dl>").addClass("message-properties");
			
			g2sUtils.helperProp(properties, "Mystery Award Id", "Integer", "Id of the award that was paid");
			g2sUtils.helperProp(properties, "TxId of payment failure", "Integer", "EGM transaction id of this action. This id must differ from the last award payment to be accepted. Leave empty to have simulator " + 
			"generate a valid id");
			g2sUtils.helperProp(properties, "Exception Code", "Integer", "Exception Code for the reason why the award payment failed");
			
			helper_panel
			.append($("<p>").html("Simulates the notification that the payment of a pending mystery award failed").append("<br>"))
			.append($("<h3>").text("Inputs"))
			.append(properties);
		}
	});
	classActionMap.set("G2S_mystery", mysteryActionMap);

	var bonusActionMap = new Map();
	bonusActionMap.set("Any Pending Bonuses", {
		id: "Any Pending Bonuses",
		method: "g2s.egm.sim.bonus_mngr.any_bonus_pending",
		// Below is how this g2s API can display it's required data
		buildDataPanel: function(container){			
		},
		// returns the json representation of the data for this exposed API
		getData: function(){
			return {};
		},
		// recovery from a json representation of the data last set
		setData: function(data){			
		},
		// Allows this node to use this node's specific data to generate some meaningful label name for the flow nodes
		getNodeLabel: function(data){
			return "Any Pending Bonuses?";
		},
		helper: function(helper_panel){
			let properties = $("<dl>").addClass("message-properties");
			
			g2sUtils.helperProp(properties, "bonus_pending", "Boolean", "Whether there are any pending bonuses to be paid to the player");
						
			helper_panel
			.append($("<p>").html("Queries the G2S engine to see if there are any pending bonus (bonus class setBonusAward)").append("<br>"))
			.append($("<h3>").text("Outputs"))
			.append(properties);
		}
	});
	bonusActionMap.set("Get Next Bonus", {
		id: "Get Next Bonus",
		method: "g2s.egm.sim.bonus_mngr.get_next_bonus",
		// Below is how this g2s API can display it's required data
		buildDataPanel: function(container){			
		},
		// returns the json representation of the data for this exposed API
		getData: function(){
			return {};
		},
		// recovery from a json representation of the data last set
		setData: function(data){			
		},
		// Allows this node to use this node's specific data to generate some meaningful label name for the flow nodes
		getNodeLabel: function(data){
			return "Get Next Bonus";
		},
		helper: function(helper_panel){						
			let properties = $("<dl>").addClass("message-properties");
			
			properties.append($("<b>").text("Bonus Award Info"));
			g2sUtils.helperProp(properties, "award_id", "Integer", "Id of the next pending award");
			g2sUtils.helperProp(properties, "amount", "Integer", "Amount of the next pending award");
			g2sUtils.helperProp(properties, "pay_method", "String", "Expected pay method (where it is to be paid) of the next pending award");
			g2sUtils.helperProp(properties, "credit_type", "String", "Type of credits in the next pending award");
			g2sUtils.helperProp(properties, "expire_credits", "Boolean", "Whether the non-cashable credits types have an expiration in next pending award");
			g2sUtils.helperProp(properties, "expire_dt_ms", "Integer", "The expired date and time in milliseconds since epoch for the non cashable credit in next pending award");
						
			helper_panel
			.append($("<p>").html("Queries the G2S engine to see if there are any pending bonus (bonus class setBonusAward)").append("<br>"))
			.append($("<h3>").text("Outputs"))
			.append(properties);
		}
	});	
	bonusActionMap.set("Award Paid", {
		id: "Award Paid",
		method:"g2s.egm.G2S_bonus.award.awarded",
		buildDataPanel: function(container){

		$("<div>").append($("<h3>").text("Award Information"))
			.append(g2sUtils.input({id:"node-input-award_id", type:"number", text: "Bonus Award Id", placeholder:"id"}))
			.append(g2sUtils.input({id:"node-input-egm_tx_id", type:"number", text: "EGM Tx Id", placeholder:"Transaction Id, empty for auto generation"}))
			.append(g2sUtils.input({id:"node-input-amount_paid", type:"number", text: "Amount paid (millicents)", placeholder:"amount paid"}))
			.append(g2sUtils.selectInput([	{value:"G2S_payCredit", text:"To Credit Bank"},
											{value:"G2S_payVoucher", text:"To a voucher"},
											{value:"G2S_payWat", text:"To a wagering account"},
											{value:"G2S_payHandpay", text:"To hand pay"}], {id:"node-input-pay_method_used", text: "Pay Method"}))
			.append(g2sUtils.selectInput([	{value:"", text:""},
											{value:"G2S_cashable", text:"Cashable"},
											{value:"G2S_nonCash", text:"Non-Cashable"},
											{value:"G2S_promo", text:"Promotional"}], {id:"node-input-credit_type_used", text: "Credit Type"}))
			.appendTo(container);
		},
		getData: function(){
			let data = {};
			let _bonus_award_info = {};
			if($("#node-input-award_id").val().length > 0)
				_bonus_award_info.award_id = Number($("#node-input-award_id").val());
			if($("#node-input-amount_paid").val().length > 0)
				_bonus_award_info.amount_paid = Number($("#node-input-amount_paid").val());
			if($("#node-input-pay_method_used").val().length > 0)
				_bonus_award_info.pay_method = $("#node-input-pay_method_used").val();
			if($("#node-input-credit_type_used").val().length > 0)
				_bonus_award_info.credit_type = $("#node-input-credit_type_used").val();
				
			data.bonus_award_info = _bonus_award_info;
			if($("#node-input-egm_tx_id").val().length > 0)
				data.egm_tx_id = Number($("#node-input-egm_tx_id").val());
			else
				data.egm_tx_id = -1;
				
			return data;
		},
		setData: function(data){
			if(data.bonus_award_info.award_id !== undefined)
				$("#node-input-award_id").val(data.bonus_award_info.award_id);
			if(data.bonus_award_info.amount_paid !== undefined)
				$("#node-input-amount_paid").val(data.bonus_award_info.amount_paid);
			if(data.bonus_award_info.pay_method !== undefined)
				$("#node-input-pay_method_used").val(data.bonus_award_info.pay_method);
			if(data.bonus_award_info.credit_type !== undefined)
				$("#node-input-credit_type_used").val(data.bonus_award_info.credit_type);
				
			if(data.egm_tx_id != -1)
				$("#node-input-egm_tx_id").val(data.egm_tx_id);
		},
		getNodeLabel: function(data){
			if(data.bonus_award_info.amount_paid !== undefined)
				return "G2S_bonus awarded (" + data.bonus_award_info.amount_paid + ")";
			else
				return "G2S_bonus awarded";
		},
		helper: function(helper_panel){
			let properties = $("<dl>").addClass("message-properties");
			
			g2sUtils.helperProp(properties, "Bonus Award Id", "Integer", "Id of the award that was paid");
			g2sUtils.helperProp(properties, "Amount paid", "Integer", "How much was paid to the player in millicents");
			g2sUtils.helperProp(properties, "Pay Method", "String", "How the award was paid to the player");
			g2sUtils.helperProp(properties, "TxId of payment", "Integer", "EGM transaction id of this action. This id must differ from the last award payment to be accepted. Leave empty to have simulator " + 
			"generate a valid id");
			
			helper_panel
			.append($("<p>").html("Simulates the payment of a pending bonus award").append("<br>"))
			.append($("<h3>").text("Inputs"))
			.append(properties);
		}
	});
	bonusActionMap.set("Award Failed", {
		id: "Award Failed",
		method:"g2s.egm.G2S_bonus.award.failed",
		buildDataPanel: function(container){

		$("<div>").append($("<h3>").text("Award Information"))
			.append(g2sUtils.input({id:"node-input-award_id", type:"number", text: "Bonus Award Id", placeholder:"id"}))
			.append(g2sUtils.input({id:"node-input-egm_tx_id", type:"number", text: "EGM Tx Id", placeholder:"Transaction Id, empty for auto generation"}))
			.append(g2sUtils.errorListInput([	{value:"1", text:"Bnus Cancelled"},
												{value:"2", text:"Non-Cashable Handpay No supported"},
												{value:"3", text:"No Player Id Available"},
												{value:"4", text:"Incorrect Player Id"},
												{value:"5", text:"Cannot mix non-cash expirations"},
												{value:"6", text:"Cannot mix non-cash credits"},
												{value:"7", text:"Machine Not Playable"},
												{value:"8", text:"Pay method not available"},
												{value:"9", text:"Unknown reason"}], {id:"node-input-exception_code", text: "Exception Code"}))
			.appendTo(container);
		},
		getData: function(){
			let data = {};
			let _bonus_award_info = {}
			if($("#node-input-award_id").val().length > 0)
				_bonus_award_info.award_id = Number($("#node-input-award_id").val());
				
			data.bonus_award_info = _bonus_award_info;
			data.exception_code = $("#node-input-exception_code").prop('checked');
			if($("#node-input-egm_tx_id").val().length > 0)
				data.egm_tx_id = Number($("#node-input-egm_tx_id").val());
			else
				data.egm_tx_id = -1;
				
			return data;
		},
		setData: function(data){
			if(data.bonus_award_info.award_id !== undefined)
				$("#node-input-award_id").val(data.bonus_award_info.award_id);
			$("#node-input-exception_code").prop('checked', data.exception_code);
			
			if(data.egm_tx_id != -1)
				$("#node-input-egm_tx_id").val(data.egm_tx_id);
		},
		getNodeLabel: function(data){
			return "G2S_bonus award failed (" + data.exception_code + ")";
		},
		helper: function(helper_panel){
			let properties = $("<dl>").addClass("message-properties");
			
			g2sUtils.helperProp(properties, "Bonus Award Id", "Integer", "Id of the award that was paid");
			g2sUtils.helperProp(properties, "TxId of payment failure", "Integer", "EGM transaction id of this action. This id must differ from the last award payment to be accepted. Leave empty to have simulator " + 
			"generate a valid id");
			g2sUtils.helperProp(properties, "Exception Code", "Integer", "Exception Code for the reason why the award payment failed");
			
			helper_panel
			.append($("<p>").html("Simulates the notification that the payment of a pending bonus award failed").append("<br>"))
			.append($("<h3>").text("Inputs"))
			.append(properties);
		}
	});
	classActionMap.set("G2S_bonus", bonusActionMap);

	var printerActionMap = new Map();
	printerActionMap.set("Error", {
		id: "Error",
		method:"g2s.egm.G2S_printer.errors.set_error",
		buildDataPanel: function(container){
			$("<div>").append($("<h3>").text("Device Information"))
				.append(g2sUtils.input({id:"node-input-device_uid", type:"text", text: "Device UID", placeholder:"Unique Identifer"}))
				.append($("<h3>").text("Error Information"))
				.append(g2sUtils.errorListInput([   {value:1, text:"Paper Low"},
													{value:2, text:"Printer Opened"},
													{value:3, text:"Head Opened"},
													{value:4, text:"Paper Jam"},
													{value:5, text:"Paper Out"},
													{value:6, text:"No comms"},
													{value:7, text:"Firmware Failure"},
													{value:8, text:"Mech Failure"},
													{value:9, text:"Optical Failure"},
													{value:10, text:"NV Memory Failure"},
													{value:11, text:"Illegal Activity"}])).appendTo(container);
		},
		getData: function(){
			return {
				device_info: {
					uid: $("#node-input-device_uid").val()
				},
				error_info:{
					error_code: Number($("#node-input-error_code").val()),
					set_flag:$("#node-input-err_set_flag").prop('checked')}
				}
		},
		setData: function(data){
			$("#node-input-device_uid").val(data.device_info.uid);
			$("#node-input-error_code").val(data.error_info.error_code);
			$("#node-input-err_set_flag").prop('checked', data.error_info.set_flag);
		},
		getNodeLabel: function(data){
			let error_txt = "";
			switch(data.error_info.error_code){
				case 1:	error_txt = "Paper Low"; break;
				case 2:	error_txt = "Printer Opened"; break;
				case 3:	error_txt = "Head Opened";	break;
				case 4:	error_txt = "Paper Jam"; break;
				case 5: error_txt = "Paper Out"; break;
				case 6: error_txt = "No comms"; break;
				case 7: error_txt = "Firmware Failure"; break;
				case 8: error_txt = "Mech Failure"; break;
				case 9: error_txt = "Optical Failure"; break;
				case 10: error_txt = "NV Memory Failure"; break;
				case 11: error_txt = "Illegal Activity"; break;
				default: error_txt = "Generic (" + data.error_info.error_code + ")";
			}
			return "G2S_printer (" + (data.device_info.uid !== undefined ? data.device_info.uid : data.device_info.id) + ")" + (data.error_info.set_flag ? "Set " : "Clear " ) + error_txt;
		},
		helper: function(helper_panel){
			let properties = $("<dl>").addClass("message-properties");
			
			g2sUtils.helperProp(properties, "Device UID", "String", "Unique Identifier string of the printer device to simulate the error (within the EGM simulator, this is the name fo the device to simulate)");
			g2sUtils.helperProp(properties, "Error Code", "Integer", "Error Code to simulate. Any error code value not in the drop down list is treated as a generic error");
			g2sUtils.helperProp(properties, "Set Flag", "Boolean", "Whether to set or clear the error code");
			
			helper_panel
			.append($("<p>").html("Simulates an error within the Media Display Device (MDD)").append("<br>"))
			.append($("<h3>").text("Inputs"))
			.append(properties);
		}
	});
	printerActionMap.set("Print Complete", {
		id: "Print Complete",
		method:"g2s.egm.G2S_printer.print_complete",
		buildDataPanel: function(container){
			$("<div>").append($("<h3>").text("Device Information"))
				.append(g2sUtils.input({id:"node-input-device_uid", type:"text", text: "Device UID", placeholder:"Unique Identifer"}))
				.append($("<h3>").text("Transaction Information"))
				.append(g2sUtils.input({id:"node-input-src_tx_id", type:"text", text: "Source Tx Id", placeholder:"transaction id"}))
				.appendTo(container);
		},
		getData: function(){
			let data = {
				device_info:{
					uid:$("#node-input-device_uid").val()
				}
			};
			
			if($("#node-input-src_tx_id").val().length > 0)
				data.g2s_tx_id = Number($("#node-input-src_tx_id").val());
			else
				data.g2s_tx_id = -1;
				
			return data;
		},
		setData: function(data){
			$("#node-input-device_uid").val(data.device_info.uid);
			$("#node-input-src_tx_id").val(data.g2s_tx_id);
		},
		getNodeLabel: function(data){
			return "G2S_printer (" + (data.device_info.uid !== undefined ? data.device_info.uid : data.device_info.id) + ")  Print completed";
		},
		helper: function(helper_panel){
			let properties = $("<dl>").addClass("message-properties");
			
			g2sUtils.helperProp(properties, "Device UID", "String", "Unique Identifier string of the printer device to simulate the error (within the EGM simulator, this is the name fo the device to simulate)");
			g2sUtils.helperProp(properties, "Source Tx Id", "Integer", "G2S transaction Id that triggered teh print (example the issued voucher transaction Id. NOTE this is a complicated one to manually enter " +
			"since a transaction must exist. Actions which create transactio such has the G2S_voucher|Voucher issued, will return the transaction Id, and this node will consume if present. Hence it is best to leave this field empty");
					
			helper_panel
			.append($("<p>").html("Simualtes teh completion of a print job from teh specified printer").append("<br>"))
			.append($("<h3>").text("Inputs"))
			.append(properties);
		}
	});
	printerActionMap.set("Print Failed", {
		id: "Print Failed",
		method:"g2s.egm.G2S_printer.print_failed",
		buildDataPanel: function(container){
			$("<div>").append($("<h3>").text("Device Information"))
				.append(g2sUtils.input({id:"node-input-device_uid", type:"text", text: "Device UID", placeholder:"Unique Identifer"}))
				.append($("<h3>").text("Transaction Information"))
				.append(g2sUtils.input({id:"node-input-src_tx_id", type:"text", text: "Source Tx Id", placeholder:"transaction id"}))
				.appendTo(container);
		},
		getData: function(){
			let data = {
				device_info:{
					uid:$("#node-input-device_uid").val()
				}
			};
			
			if($("#node-input-src_tx_id").val().length > 0)
				data.g2s_tx_id = Number($("#node-input-src_tx_id").val());
			else
				data.g2s_tx_id = -1;
				
			return data;
		},
		setData: function(data){
			$("#node-input-device_uid").val(data.device_info.uid);
			$("#node-input-src_tx_id").val(data.g2s_tx_id);
		},
		getNodeLabel: function(data){
			return "G2S_printer (" + (data.device_info.uid !== undefined ? data.device_info.uid : data.device_info.id) + ")  Print failed";
		},
		helper: function(helper_panel){
			let properties = $("<dl>").addClass("message-properties");
			
			g2sUtils.helperProp(properties, "Device UID", "String", "Unique Identifier string of the printer device to simulate the error (within the EGM simulator, this is the name fo the device to simulate)");
			g2sUtils.helperProp(properties, "Source Tx Id", "Integer", "G2S transaction Id that triggered teh print (example the issued voucher transaction Id. NOTE this is a complicated one to manually enter " +
			"since a transaction must exist. Actions which create transactio such has the G2S_voucher|Voucher issued, will return the transaction Id, and this node will consume if present. Hence it is best to leave this field empty");
					
			helper_panel
			.append($("<p>").html("Simualtes the failure of a print job from the specified printer").append("<br>"))
			.append($("<h3>").text("Inputs"))
			.append(properties);
		}
	});
	printerActionMap.set("Print Transfer Failed", {
		id: "Print Transfer Failed",
		method:"g2s.egm.G2S_printer.print_transfer_failed",
		buildDataPanel: function(container){
			$("<div>").append($("<h3>").text("Device Information"))
				.append(g2sUtils.input({id:"node-input-device_uid", type:"text", text: "Device UID", placeholder:"Unique Identifer"}))
				.append($("<h3>").text("Transaction Information"))
				.append(g2sUtils.input({id:"node-input-failure_code", type:"number", text: "Failure Code", placeholder:"code"}))
				.append(g2sUtils.input({id:"node-input-src_tx_id", type:"text", text: "Source Tx Id", placeholder:"transaction id"}))
				.appendTo(container);
		},
		getData: function(){			
			let data = {
				device_info:{
					uid:$("#node-input-device_uid").val()
				},
				failure_code: $("#node-input-failure_code").val()
			};
			
			if($("#node-input-src_tx_id").val().length > 0)
				data.g2s_tx_id = Number($("#node-input-src_tx_id").val());
			else
				data.g2s_tx_id = -1;
				
			return data;
		},
		setData: function(data){
			$("#node-input-device_uid").val(data.device_info.uid);
			$("#node-input-src_tx_id").val(data.g2s_tx_id);
			$("#node-input-failure_code").val(data.failure_code);
		},
		getNodeLabel: function(data){
			return "G2S_printer (" + (data.device_info.uid !== undefined ? data.device_info.uid : data.device_info.id) + ")  Print Transfer failed";
		},
		helper: function(helper_panel){
			let properties = $("<dl>").addClass("message-properties");
			
			g2sUtils.helperProp(properties, "Device UID", "String", "Unique Identifier string of the printer device to simulate the error (within the EGM simulator, this is the name fo the device to simulate)");
			g2sUtils.helperProp(properties, "Failure Code", "Integer", "Reason code for the failed transfer of the print job");
			g2sUtils.helperProp(properties, "Source Tx Id", "Integer", "G2S transaction Id that triggered teh print (example the issued voucher transaction Id. NOTE this is a complicated one to manually enter " +
			"since a transaction must exist. Actions which create transactio such has the G2S_voucher|Voucher issued, will return the transaction Id, and this node will consume if present. Hence it is best to leave this field empty");
					
			helper_panel
			.append($("<p>").html("Simualtes the failure of a print job from the specified printer").append("<br>"))
			.append($("<h3>").text("Inputs"))
			.append(properties);
		}
	});
	classActionMap.set("G2S_printer", printerActionMap);

	var spcActionMap = new Map();
	spcActionMap.set("Level Init", {
		id: "Level Init",
		method:"g2s.egm.G2S_spc.level.init",
		buildDataPanel: function(container){
		$("<div>").append($("<h3>").text("SPC Information"))
			.append(g2sUtils.input({id:"node-input-group", type:"text", text: "Group Alias", placeholder:"group"}))
			.append(g2sUtils.input({id:"node-input-level_id", type:"number", text: "Level Id", placeholder:"level"}))
			.append(g2sUtils.input({id:"node-input-currentLevelAmt", type:"number", text: "Level Amt", placeholder:""}))
			.append(g2sUtils.input({id:"node-input-currentOverflowAmt", type:"number", text: "Overflow Amt", placeholder:""}))
			.append(g2sUtils.input({id:"node-input-currentStartupAmt", type:"number", text: "Startup Amt", placeholder:""}))			
			.append(g2sUtils.input({id:"node-input-totalAdjustAmt", type:"number", text: "Total Adjusted Amt", placeholder:""}))			
			.appendTo(container);
		},
		getData: function(){
			return {
				group: $("#node-input-group").val(),
				levelId: Number($("#node-input-level_id").val()),
				currentLevelAmt: Number($("#node-input-currentLevelAmt").val()),
				currentOverflowAmt: Number($("#node-input-currentOverflowAmt").val()),
				currentStartupAmt: Number($("#node-input-currentStartupAmt").val()),				
				totalAdjustAmt: Number($("#node-input-totalAdjustAmt").val())				
			};
		},
		setData: function(data){
			$("#node-input-group").val(data.group);
			$("#node-input-level_id").val(data.levelId);
			$("#node-input-currentLevelAmt").val(data.currentLevelAmt);
			$("#node-input-currentOverflowAmt").val(data.currentOverflowAmt);
			$("#node-input-currentStartupAmt").val(data.currentStartupAmt);			
			$("#node-input-totalAdjustAmt").val(data.totalAdjustAmt);
		},
		getNodeLabel: function(data){
			return "G2S_spc reset (" + data.group + "/" + data.levelId + ")";
		},
		helper: function(helper_panel){
			let properties = $("<dl>").addClass("message-properties");
			
			g2sUtils.helperProp(properties, "Group Alias", "String", "Unique Identifier string of the standalone progressive device to simulate (within the EGM simulator, this is the name fo the device to simulate)");
			g2sUtils.helperProp(properties, "Level Id", "Integer", "Id of the level being initialized");
			g2sUtils.helperProp(properties, "Level Amt", "Integer", "Amount the progressive level is being initialized to");
			g2sUtils.helperProp(properties, "Overflow Amt", "Integer", "Amount the progressive level overflow is being initialized to");
			g2sUtils.helperProp(properties, "Startup Amt", "Integer", "Amount the progressive level strtup value is being initialized to");
			g2sUtils.helperProp(properties, "Total Adjusted Amt", "Integer", "Current total adjustements the progressive level received");
					
			helper_panel
			.append($("<p>").html("Simualtes the initialization of a standalone progressive level").append("<br>"))
			.append($("<h3>").text("Inputs"))
			.append(properties);
		}
	});
	spcActionMap.set("Level Reset", {
		id: "Level Reset",
		method:"g2s.egm.G2S_spc.level.reset",
		buildDataPanel: function(container){
		$("<div>").append($("<h3>").text("SPC Information"))
			.append(g2sUtils.input({id:"node-input-group", type:"text", text: "Group Alias", placeholder:"group"}))
			.append(g2sUtils.input({id:"node-input-level_id", type:"number", text: "Level Id", placeholder:"level"}))
			.append(g2sUtils.input({id:"node-input-currentLevelAmt", type:"number", text: "Level Amt", placeholder:""}))
			.append(g2sUtils.input({id:"node-input-currentOverflowAmt", type:"number", text: "Overflow Amt", placeholder:""}))
			.append(g2sUtils.input({id:"node-input-currentStartupAmt", type:"number", text: "Startup Amt", placeholder:""}))
			.append(g2sUtils.input({id:"node-input-totalStartupAmt", type:"number", text: "Total Startup Amt", placeholder:""}))
			.append(g2sUtils.input({id:"node-input-totalAdjustAmt", type:"number", text: "Total Adjusted Amt", placeholder:""}))
			.append(g2sUtils.input({id:"node-input-totalContribAmt", type:"number", text: "Total Contribution Amt", placeholder:""}))
			.append(g2sUtils.input({id:"node-input-totalHitAmt", type:"number", text: "Total Hit Amt", placeholder:""}))
			.append(g2sUtils.input({id:"node-input-totalPaidAmt", type:"number", text: "Total Paid Amt", placeholder:""}))
			.appendTo(container);
		},
		getData: function(){
			return {
				group: $("#node-input-group").val(),
				levelId: Number($("#node-input-level_id").val()),
				currentLevelAmt: Number($("#node-input-currentLevelAmt").val()),
				currentOverflowAmt: Number($("#node-input-currentOverflowAmt").val()),
				currentStartupAmt: Number($("#node-input-currentStartupAmt").val()),
				totalStartupAmt: Number($("#node-input-totalStartupAmt").val()),
				totalAdjustAmt: Number($("#node-input-totalAdjustAmt").val()),
				totalContribAmt: Number($("#node-input-totalContribAmt").val()),
				totalHitAmt: Number($("#node-input-totalHitAmt").val()),
				totalPaidAmt: Number($("#node-input-totalPaidAmt").val())
			};
		},
		setData: function(data){
			$("#node-input-group").val(data.group);
			$("#node-input-level_id").val(data.levelId);
			$("#node-input-currentLevelAmt").val(data.currentLevelAmt);
			$("#node-input-currentOverflowAmt").val(data.currentOverflowAmt);
			$("#node-input-currentStartupAmt").val(data.currentStartupAmt);
			$("#node-input-totalStartupAmt").val(data.totalStartupAmt);
			$("#node-input-totalAdjustAmt").val(data.totalAdjustAmt);
			$("#node-input-totalContribAmt").val(data.totalContribAmt);
			$("#node-input-totalHitAmt").val(data.totalHitAmt);
			$("#node-input-totalPaidAmt").val(data.totalPaidAmt);
		},
		getNodeLabel: function(data){
			return "G2S_spc reset (" + data.group + "/" + data.levelId + ")";
		},
		helper: function(helper_panel){
			let properties = $("<dl>").addClass("message-properties");
			
			g2sUtils.helperProp(properties, "Group Alias", "String", "Unique Identifier string of the standalone progressive device to simulate (within the EGM simulator, this is the name fo the device to simulate)");
			g2sUtils.helperProp(properties, "Level Id", "Integer", "Id of the level being initialized");
			g2sUtils.helperProp(properties, "Level Amt", "Integer", "Amount the progressive level is being initialized to");
			g2sUtils.helperProp(properties, "Overflow Amt", "Integer", "Amount the progressive level overflow is being initialized to");
			g2sUtils.helperProp(properties, "Startup Amt", "Integer", "Amount the progressive level strtup value is being initialized to");
			g2sUtils.helperProp(properties, "Total Startup Amt", "Integer", "Current total startups the progressive level received");
			g2sUtils.helperProp(properties, "Total Adjusted Amt", "Integer", "Current total adjustements the progressive level received");
			g2sUtils.helperProp(properties, "Total Contribution Amt", "Integer", "Current total contributions the progressive level received");
			g2sUtils.helperProp(properties, "Total Hit Amt", "Integer", "Current total hit amount the progressive level received");
			g2sUtils.helperProp(properties, "Total Paid Amt", "Integer", "Current total paid amounts the progressive level received");
					
			helper_panel
			.append($("<p>").html("Simualtes the initialization of a standalone progressive level").append("<br>"))
			.append($("<h3>").text("Inputs"))
			.append(properties);
		}
	});
	spcActionMap.set("Level Hit", {
		id: "Level Hit",
		method:"g2s.egm.G2S_spc.level.hit",
		buildDataPanel: function(container){
			$("<div>").append($("<h3>").text("Award Information"))
				.append(g2sUtils.input({id:"node-input-group", type:"text", text: "Group Alias", placeholder:"group"}))
				.append(g2sUtils.input({id:"node-input-level_id", type:"number", text: "Level Id", placeholder:"level"}))
				.append($("<h3>").text("Game Information"))
				.append(g2sDataMap.get("game_info").dataPanel())
				.append(g2sUtils.input({id:"node-input-winlevelIndex", type:"number", text: "Win Level Index", placeholder:""}))
				.appendTo(container);
		},
		getData: function(){
			let this_data = {};
			this_data.game_info = g2sDataMap.get("game_info").getData();
			this_data.group = $("#node-input-group").val();
			this_data.levelId = Number($("#node-input-level_id").val());
			this_data.winLevelIndex = Number($("#node-input-winlevelIndex").val());

			return this_data
		},
		setData: function(data){
			$("#node-input-group").val(data.group);
			$("#node-input-level_id").val(data.levelId);
			$("#node-input-winlevelIndex").val(data.winlevelIndex);
			g2sDataMap.get("game_info").setData(data.game_info);
		},
		getNodeLabel: function(data){
			return "G2S_spc hit (" + data.group + "/" + data.levelId + ")";
		},
		helper: function(helper_panel){
			let properties = $("<dl>").addClass("message-properties");
			
			g2sUtils.helperProp(properties, "Group Alias", "String", "Unique Identifier string of the standalone progressive device to simulate (within the EGM simulator, this is the name fo the device to simulate)");
			g2sUtils.helperProp(properties, "Level Id", "Integer", "Id of the level being initialized");
			
			properties.append($("<b>").text("Game Information"));
			g2sDataMap.get("game_info").append_helper_properties(properties);
			
			g2sUtils.helperProp(properties, "Win Level Index", "Integer", "Game's win level index that triggerred the progressive win");
					
			helper_panel
			.append($("<p>").html("Simualtes the initialization of a standalone progressive level").append("<br>"))
			.append($("<h3>").text("Inputs"))
			.append(properties);
		}
	});
	spcActionMap.set("Level Update", {
		id: "Level Update",
		method:"g2s.egm.G2S_spc.level.update",
		buildDataPanel: function(container){
		$("<div>").append($("<h3>").text("SPC Information"))
			.append(g2sUtils.input({id:"node-input-group", type:"text", text: "Group Alias", placeholder:"group"}))
			.append(g2sUtils.input({id:"node-input-level_id", type:"number", text: "Level Id", placeholder:"level"}))
			.append(g2sUtils.input({id:"node-input-currentLevelAmt", type:"number", text: "Level Amt", placeholder:""}))
			.append(g2sUtils.input({id:"node-input-currentOverflowAmt", type:"number", text: "Overflow Amt", placeholder:""}))
			.append(g2sUtils.input({id:"node-input-totalContribAmt", type:"number", text: "Total Contribution Amt", placeholder:""}))
			.appendTo(container);
		},
		getData: function(){
			return {
				group: $("#node-input-group").val(),
				levelId: Number($("#node-input-level_id").val()),
				currentLevelAmt: Number($("#node-input-currentLevelAmt").val()),
				currentOverflowAmt: Number($("#node-input-currentOverflowAmt").val()),
				totalContribAmt: Number($("#node-input-totalContribAmt").val()),
			};
		},
		setData: function(data){
			$("#node-input-group").val(data.group);
			$("#node-input-level_id").val(data.levelId);
			$("#node-input-currentLevelAmt").val(data.currentLevelAmt);
			$("#node-input-currentOverflowAmt").val(data.currentOverflowAmt);
			$("#node-input-totalContribAmt").val(data.totalContribAmt);
		},
		getNodeLabel: function(data){
			return "G2S_spc update (" + data.group + "/" + data.levelId + ")";
		},
		helper: function(helper_panel){
			let properties = $("<dl>").addClass("message-properties");
			
			g2sUtils.helperProp(properties, "Group Alias", "String", "Unique Identifier string of the standalone progressive device to simulate (within the EGM simulator, this is the name fo the device to simulate)");
			g2sUtils.helperProp(properties, "Level Id", "Integer", "Id of the level being initialized");
			g2sUtils.helperProp(properties, "Level Amt", "Integer", "Amount the progressive level is being initialized to");
			g2sUtils.helperProp(properties, "Overflow Amt", "Integer", "Amount the progressive level overflow is being initialized to");
			g2sUtils.helperProp(properties, "Total Contribution Amt", "Integer", "Current total contributions the progressive level received");
					
			helper_panel
			.append($("<p>").html("Simualtes the initialization of a standalone progressive level").append("<br>"))
			.append($("<h3>").text("Inputs"))
			.append(properties);
		}
	});
	spcActionMap.set("Level Adjusted", {
		id: "Level Adjusted",
		method:"g2s.egm.G2S_spc.level.adjustment",
		buildDataPanel: function(container){
		$("<div>").append($("<h3>").text("SPC Information"))
			.append(g2sUtils.input({id:"node-input-group", type:"text", text: "Group Alias", placeholder:"group"}))
			.append(g2sUtils.input({id:"node-input-level_id", type:"number", text: "Level Id", placeholder:"level"}))
			.append(g2sUtils.input({id:"node-input-currentLevelAmt", type:"number", text: "Level Amt", placeholder:""}))
			.append(g2sUtils.input({id:"node-input-currentOverflowAmt", type:"number", text: "Overflow Amt", placeholder:""}))
			.append(g2sUtils.input({id:"node-input-totalContribAmt", type:"number", text: "Total Contribution Amt", placeholder:""}))
			.append(g2sUtils.input({id:"node-input-totalAdjustAmt", type:"number", text: "Total Adjusted Amt", placeholder:""}))
			.appendTo(container);
		},
		getData: function(){
			return {
				group: $("#node-input-group").val(),
				levelId: Number($("#node-input-level_id").val()),
				currentLevelAmt: Number($("#node-input-currentLevelAmt").val()),
				currentOverflowAmt: Number($("#node-input-currentOverflowAmt").val()),
				totalContribAmt: Number($("#node-input-totalContribAmt").val()),
				totalAdjustAmt: Number($("#node-input-totalAdjustAmt").val()),
			};
		},
		setData: function(data){
			$("#node-input-group").val(data.group);
			$("#node-input-level_id").val(data.levelId);
			$("#node-input-currentLevelAmt").val(data.currentLevelAmt);
			$("#node-input-currentOverflowAmt").val(data.currentOverflowAmt);
			$("#node-input-totalContribAmt").val(data.totalContribAmt);
			$("#node-input-totalAdjustAmt").val(data.totalAdjustAmt);
		},
		getNodeLabel: function(data){
			return "G2S_spc adjusted (" + data.group + "/" + data.levelId + ")";
		},
		helper: function(helper_panel){
			let properties = $("<dl>").addClass("message-properties");
			
			g2sUtils.helperProp(properties, "Group Alias", "String", "Unique Identifier string of the standalone progressive device to simulate (within the EGM simulator, this is the name fo the device to simulate)");
			g2sUtils.helperProp(properties, "Level Id", "Integer", "Id of the level being initialized");
			g2sUtils.helperProp(properties, "Level Amt", "Integer", "Amount the progressive level is being initialized to");
			g2sUtils.helperProp(properties, "Overflow Amt", "Integer", "Amount the progressive level overflow is being initialized to");
			g2sUtils.helperProp(properties, "Total Contribution Amt", "Integer", "Current total contributions the progressive level received");
			g2sUtils.helperProp(properties, "Total Adjusted Amt", "Integer", "Current total adjustements the progressive level received");
					
			helper_panel
			.append($("<p>").html("Simualtes the initialization of a standalone progressive level").append("<br>"))
			.append($("<h3>").text("Inputs"))
			.append(properties);
		}
	});
	classActionMap.set("G2S_spc", spcActionMap);

	var voucherActionMap = new Map();
	voucherActionMap.set("Get Validation Id", {
		id: "Get Validation Id",
		method: "g2s.egm.G2S_voucher.get_validation_id",
		// Below is how this g2s API can display it's required data
		buildDataPanel: function(container){
			$("<div>").append($("<h3>").text("Behavior Information"))
				.append(g2sUtils.checkboxInput({id:"node-input-wait_for_id", text: "Wait for an id"}))
				.appendTo(container);
		},
		// returns the json representation of the data for this exposed API
		getData: function(){
			return {
				wait: $("#node-input-wait_for_id").is(":checked")
			}
		},
		// recovery from a json representation of the data last set
		setData: function(data){
			$("#node-input-wait_for_id").prop('checked', data.wait);
		},
		// Allows this node to use this node's specific data to generate some meaningful label name for the flow nodes
		getNodeLabel: function(data){
			return "G2S_voucher Get Validation Id";
		},
		helper: function(helper_panel){
			let properties = $("<dl>").addClass("message-properties");
			
			g2sUtils.helperProp(properties, "Wait for an id", "Boolean", "Whether the call should block until there is an available validation Id, or if none are availabe to return immediately with the error status");
						
			helper_panel
			.append($("<p>").html("Queries the G2S engine for the next validation Id to use for a voucher being issued to the player").append("<br>"))
			.append($("<h3>").text("Outputs"))
			.append(properties);
		}
	});	
	voucherActionMap.set("Voucher Issued", {
		id: "Voucher Issued",
		method:"g2s.egm.G2S_voucher.on_validation_id_issued",
		buildDataPanel: function(container){
		$("<div>").append($("<h3>").text("Voucher Information"))
			.append(g2sUtils.input({id:"node-input-sequence_number", type:"number", text: "Sequence Number", placeholder:"Sequence Number"}))
			.append(g2sUtils.input({id:"node-input-cash", type:"number", text: "Cash Amt", placeholder:"Cashable amount"}))
			.append(g2sUtils.input({id:"node-input-promo", type:"number", text: "Promo Amt", placeholder:"Promotional amount"}))
			.append(g2sUtils.input({id:"node-input-non_cash", type:"number", text: "Non-Cash Amt", placeholder:"Non-Cashable amount"}))
			.append(g2sUtils.input({id:"node-input-validation_id", type:"text", text: "Issued Validation Id", placeholder:"Validation Id"}))
			.append(g2sUtils.input({id:"node-input-when_date", type:"datetime-local", text: "Date Time Issued", placeholder:"When was it issued"}))
			.append(g2sUtils.checkboxInput({id:"node-input-from_large_win", text: "From Large win"}))
			.append(g2sUtils.input({id:"node-input-src_ref_id", type:"number", text: "Source Reference", placeholder:"transaction id"}))
			.appendTo(container);
		},
		getData: function(){
		console.log("test cash: " + $("#node-input-cash").val());
			let amounts = {
				cash: Number($("#node-input-cash").val() | 0),
				promo: Number($("#node-input-promo").val() | 0),
				non_cash: Number($("#node-input-non_cash").val() | 0)
			};
			console.log("Test Cash: " + JSON.stringify(amounts));
			
			let data = {			
				src_ref_id: Number($("#node-input-src_ref_id").val()),
				from_a_large_win: $("#node-input-from_large_win").prop('checked')
			};
						
			if($("#node-input-validation_id").val() !== undefined)
				data.validation = {	id: $("#node-input-validation_id").val() };
				
			//if(amounts.cash !== 0 || amounts.promo !== 0 || amounts.non_cash !== 0)
			data.amounts = amounts; 
						
			if($("#node-input-sequence_number").val() !== undefined)
				data.sequence_num = Number($("#node-input-sequence_number").val());
			else
				data.sequence_num = 1;
			
			if($("#node-input-when_date").val() !== undefined){
				data.when_raw = $("#node-input-when_date").val();
				if($("#node-input-when_date").val() == undefined)
					data.when = new Date($("#node-input-when_date").val()).toISOString();
			}
			
			return data;
		},
		setData: function(data){
			$("#node-input-sequence_number").val(data.sequence_num);
			$("#node-input-cash").val(data.amounts.cash);
			$("#node-input-promo").val(data.amounts.promo);
			$("#node-input-non_cash").val(data.amounts.non_cash);
			$("#node-input-validation_id").val(data.validation.id);
			$("#node-input-when_date").val(data.when_raw);
			$("#node-input-src_ref_id").val(data.src_ref_id);
			console.log('checked ' + data.from_a_large_win);
			$("#node-input-from_large_win").prop('checked', data.from_a_large_win);
		},
		getNodeLabel: function(data){
			if(data.validation.id !== undefined && data.validation.id != "")
				return "G2S_voucher Voucher issued (" + data.validation.id + ")";
			else 
				return "G2S_voucher Voucher issued";
		},
		helper: function(helper_panel){
			let properties = $("<dl>").addClass("message-properties");
			
			g2sUtils.helperProp(properties, "Sequence Number", "Integer", "Sequence number of this voucher issuance.");
			g2sUtils.helperProp(properties, "Cashable amount", "Integer", "Amount of cash in millicents that was issued");
			g2sUtils.helperProp(properties, "Promotional amount", "Integer", "Amount of promotional credits in millicents that was issued");
			g2sUtils.helperProp(properties, "Non-Cashable amount", "Integer", "Amount of non cashable credits in millicents that was issued");
			g2sUtils.helperProp(properties, "Validation Id", "String", "Validation id used and printed on ticket being inserted. ");
			g2sUtils.helperProp(properties, "When was it issued", "Date Time", "Date and time of the voucher issuance. Leave empty to have simulator use the time at the issuance message");
			g2sUtils.helperProp(properties, "From Large win", "Boolean", "Whether this voucher issuance is a result from a large win on the EGM (i.e. exceeded the largeWinLimit on the cabinet)");
			g2sUtils.helperProp(properties, "Source Reference", "Integer", "G2S transaction if of the source of the issuance (example if this was a large win, this would be the transaction of the game play");
					
			helper_panel
			.append($("<p>").html("Simulates the issuance of a voucher to the player, Amounts and validation Id for the issued voucher will be merged if present in the flow from previous G2S nodes (example Bank Get Amounts for amount being issued)").append("<br>"))
			.append($("<h3>").text("Inputs"))
			.append(properties);
		}
	});
	voucherActionMap.set("Voucher Inserted", {
		id: "Voucher Inserted",
		method:"g2s.egm.G2S_voucher.on_validation_id_inserted",
		buildDataPanel: function(container){
		$("<div>").append($("<h3>").text("Voucher Information"))			
			.append(g2sUtils.input({id:"node-input-validation_id", type:"text", text: "Issued Validation Id", placeholder:"Validation Id"}))			
			.append(g2sUtils.input({id:"node-input-egm_tx_id", type:"number", text:"TxId of inserted voucher", placeholder:"Transaction Id, empty for auto generation"}))
			.appendTo(container);
		},
		getData: function(){
			let data = {};
			
			let validation_val = $("#node-input-validation_id").val();
			if(validation_val !== undefined && validation_val != ""){
				data.validation = {
					id: $("#node-input-validation_id").val()
				}
			}
			
			if($("#node-input-egm_tx_id").val().length > 0)
				data.egm_tx_id = Number($("#node-input-egm_tx_id").val());
			else
				data.egm_tx_id = -1;
				
			return data;
		},
		setData: function(data){
			$("#node-input-validation_id").val(data.validation.id);
			if(data.egm_tx_id != -1)
				$("#node-input-egm_tx_id").val(data.egm_tx_id);
			
		},
		getNodeLabel: function(data){
			if(data.validation !== undefined && (data.validation.id !== undefined && data.validation.id != ""))
				return "G2S_voucher Voucher inserted (" + data.validation.id + ")";
			else
				return "G2S_voucher Voucher inserted";
		},
		helper: function(helper_panel){
			let properties = $("<dl>").addClass("message-properties");
			
			g2sUtils.helperProp(properties, "Issued Validation Id", "String", "Sequence number of this voucher issuance.");
			g2sUtils.helperProp(properties, "TxId of inserted voucher", "Integer", "EGM transaction id of this action. This id must differ from the last voucher insertion. Leave empty to have simulator " + 
			"generate a valid id");

			let out_properties = $("<dl>").addClass("message-properties");
			g2sUtils.helperProp(out_properties, "cash.meter.value", "Integer", "Amount of cash in millicents that was issued");
			g2sUtils.helperProp(out_properties, "non_cash.meter.value", "Integer", "Amount of promotional credits in millicents that was issued");
			g2sUtils.helperProp(out_properties, "Non-Cashable amount", "Integer", "Amount of non cashable credits in millicents that was issued");
			g2sUtils.helperProp(out_properties, "promo.meter.value", "Integer", "Validation id used and printed on ticket being inserted. ");
			g2sUtils.helperProp(out_properties, "authorized", "Boolean", "Whether the voucher is authorized to be accepted by the EGM");
			g2sUtils.helperProp(out_properties, "action", "String", "Action to be taken by the EGM. If authorized, voucher can be stacked. If not authorized, the system may require the " + 
			"voucher to be stacked, but not credited or rejected back to the player.");
			
			helper_panel
			.append($("<p>").html("Simulates the insertion of a printed voucher into the EGM, the validation Id of the inserted voucher will be merged if present in the flow from previous G2S nodes " + 
			"(example from a issued voucher node)" +
			"<br><br><b>NOTE</b> This is part of a 2 part transaction. 1) inserting the ticket, then 2) stacking the stacking, or rejecting the ticket. This action " +
			"require a transaction id to be passed in. User can specify their own in either part of the 2 actions, or leave empty to " +
			"let the simulation geenrate the id. The id must remain the same between the 2 part of this action").append("<br>"))
			.append($("<h3>").text("Inputs"))
			.append(properties)
			.append($("<h3>").text("Ouputs"))
			.append(out_properties);
		}
	});
	voucherActionMap.set("Voucher Rejected", {
		id: "Voucher Rejected",
		method:"g2s.egm.G2S_voucher.on_validation_id_rejected",
		buildDataPanel: function(container){
		$("<div>").append($("<h3>").text("Voucher Information"))		
			.append(g2sUtils.input({id:"node-input-egm_tx_id", type:"number", text:"TxId of inserted voucher"}))
			.append(g2sUtils.inputWithDataList([{value:"1", text:"Printer presentation error – partial voucher issued"},
												{value:"5", text:"Redemption timed out by EGM – voucher rejected"},
												{value:"6", text:"Voucher exceeds credit limit – voucher rejected"},
												{value:"7", text:"Game state changed – voucher rejected"},
												{value:"9", text:"Cannot mix non-cash expirations"},
												{value:"10", text:"Cannot mix non-cash credits"},
												{value:"99", text:"Voucher rejected – reason unknown"}], {id:"node-input-exception_code", text: "Exception Code"}))
			.appendTo(container);
		},
		getData: function(){
			let data = {
				exception: $("#node-input-exception_code").val()
			};
			
			if($("#node-input-egm_tx_id").val().length > 0)
				data.egm_tx_id = Number($("#node-input-egm_tx_id").val());
			else
				data.egm_tx_id = -1;
				
			return data;
		},
		setData: function(data){
			$("#node-input-exception").val(data.exception_code);
			if(data.egm_tx_id != -1)
				$("#node-input-egm_tx_id").val(data.egm_tx_id);
			
		},
		getNodeLabel: function(data){
			return "G2S_voucher Voucher rejected";
		},
		helper: function(helper_panel){
			let properties = $("<dl>").addClass("message-properties");
			
			g2sUtils.helperProp(properties, "TxId of inserted voucher", "Integer", "EGM transaction id of this insertion. The id should correlate with the insertion that is being rejected. Leave empty to have simulator " + 
			"generate a valid id");
			g2sUtils.helperProp(properties, "Exception Code", "Integer", "Reason of the rejection");
			
			helper_panel
			.append($("<p>").html("Simulates the rejection of a printed voucher into the EGM." +
			"<br><br><b>NOTE</b> This is part of a 2 part transaction. 1) inserting the ticket, then 2) stacking the stacking, or rejecting the ticket. This action " +
			"require a transaction id to be passed in. User can specify their own in either part of the 2 actions, or leave empty to " +
			"let the simulation geenrate the id. The id must remain the same between the 2 part of this action").append("<br>"))
			.append($("<h3>").text("Inputs"))
			.append(properties);
		}
	});
	voucherActionMap.set("Voucher Stacked", {
		id: "Voucher Stacked",
		method:"g2s.egm.G2S_voucher.on_validation_id_stacked",
		buildDataPanel: function(container){
		$("<div>").append($("<h3>").text("Voucher Information"))		
			.append(g2sUtils.input({id:"node-input-egm_tx_id", type:"number", text:"TxId of inserted voucher"}))			
			.appendTo(container);
		},
		getData: function(){
			let data = {};
			
			if($("#node-input-egm_tx_id").val().length > 0)
				data.egm_tx_id = Number($("#node-input-egm_tx_id").val());
			else
				data.egm_tx_id = -1;
				
			return data;
		},
		setData: function(data){
			if(data.egm_tx_id != -1)
				$("#node-input-egm_tx_id").val(data.egm_tx_id);
			
		},
		getNodeLabel: function(data){			
			return "G2S_voucher Voucher stacked";
		},
		helper: function(helper_panel){
			let properties = $("<dl>").addClass("message-properties");
			
			g2sUtils.helperProp(properties, "TxId of inserted voucher", "Integer", "EGM transaction id of this insertion. The id should correlate with the insertion that is being stacked. Leave empty to have simulator " + 
			"generate a valid id");
			
			helper_panel
			.append($("<p>").html("Simulates the stacking of a printed voucher into the EGM." +
			"<br><br><b>NOTE</b> This is part of a 2 part transaction. 1) inserting the ticket, then 2) stacking the stacking, or rejecting the ticket. This action " +
			"require a transaction id to be passed in. User can specify their own in either part of the 2 actions, or leave empty to " +
			"let the simulation geenrate the id. The id must remain the same between the 2 part of this action").append("<br>"))
			.append($("<h3>").text("Inputs"))
			.append(properties);
		}
	});
	classActionMap.set("G2S_voucher", voucherActionMap);

	var certMngrActionMap = new Map();
	certMngrActionMap.set("Changed", {
		id: "Changed",
		method: "proto.sim.cert_manager.cert_changed",
		// Below is how this g2s API can display it's required data
		buildDataPanel: function(container){
			$("<div>").append($("<h3>").text("Certificate Information"))
				.append(g2sUtils.input({id:"node-input-cert_ou", type:"text", text:"Cert. OU"}))
				.appendTo(container);
		},
		// returns the json representation of the data for this exposed API
		getData: function(){			
			return {
				ou: $("#node-input-cert_ou").val()
			} 
		},
		// recovery from a json representation of the data last set
		setData: function(data){
			$("#node-input-cert_ou").val(data.ou);
		},
		// Allows this node to use this node's specific data to generate some meaningful label name for the flow nodes
		getNodeLabel: function(data){
			return "Cert Changed (" + data.ou + ")";
		},
		helper: function(helper_panel){
			let properties = $("<dl>").addClass("message-properties");
			
			g2sUtils.helperProp(properties, "Cert. OU", "String", "The Organization Unit of the certificate to notify the EGM that it changed");
			
			helper_panel
			.append($("<p>").html("Simulates when the certificat assigned ot the OU is detected to have changed").append("<br>"))
			.append($("<h3>").text("Inputs"))
			.append(properties);
		}
	});
	certMngrActionMap.set("Revoked", {
		id: "Revoked",
		method: "proto.sim.ocsp.revoke_cert",
		// Below is how this g2s API can display it's required data
		buildDataPanel: function(container){
			$("<div>").append($("<h3>").text("Certificate Information"))
				.append(g2sUtils.input({id:"node-input-cert_thumprint", type:"text", text:"Cert. Thumbprint"}))
				.appendTo(container);
		},
		// returns the json representation of the data for this exposed API
		getData: function(){			
			return {
				cert_thumbprint: $("#node-input-cert_thumprint").val()
			} 
		},
		// recovery from a json representation of the data last set
		setData: function(data){
			$("#node-input-cert_thumprint").val(data.cert_thumbprint);
		},
		// Allows this node to use this node's specific data to generate some meaningful label name for the flow nodes
		getNodeLabel: function(data){
			return "Cert Revoked (" + data.cert_thumbprint + ")";
		},
		helper: function(helper_panel){
			let properties = $("<dl>").addClass("message-properties");
			
			g2sUtils.helperProp(properties, "Cert. Thumbprint", "String", "The thumbprint of the revoked certificate");
			
			helper_panel
			.append($("<p>").html("Simulates when the certificat assigned to the thumbprint is detected to being revoked. Revocation here " + 
			"may not be a hard revoke from an OCSP and CRL List. Internal logic may cause the cert to be soft revoked and can be clear if the " +
			"condition allow for it. Example internal OCSP logic fails to get a new status on the certificate in time, will be regarded as being " +
			"soft revoked until a new status is received").append("<br>"))
			.append($("<h3>").text("Inputs"))
			.append(properties);
		}
	});
	certMngrActionMap.set("Clear Revoked Cert", {
		id: "Clear Revoked Cert",
		method: "proto.sim.ocsp.clear_revoke_cert",
		// Below is how this g2s API can display it's required data
		buildDataPanel: function(container){
			$("<div>").append($("<h3>").text("Certificate Information"))
				.append(g2sUtils.input({id:"node-input-cert_thumprint", type:"text", text:"Cert. Thumbprint"}))
				.appendTo(container);
		},
		// returns the json representation of the data for this exposed API
		getData: function(){			
			return {
				cert_thumbprint: $("#node-input-cert_thumprint").val()
			} 
		},
		// recovery from a json representation of the data last set
		setData: function(data){
			$("#node-input-cert_thumprint").val(data.cert_thumbprint);
		},
		// Allows this node to use this node's specific data to generate some meaningful label name for the flow nodes
		getNodeLabel: function(data){
			return "Clear Revoked (" + data.cert_thumbprint + ")";
		},
		helper: function(helper_panel){
			let properties = $("<dl>").addClass("message-properties");
			
			g2sUtils.helperProp(properties, "Cert. Thumbprint", "String", "The certificate  of the certificate to notify the EGM that it is revoked");
			
			helper_panel
			.append($("<p>").html("Simulates when the certificate assigned to the thumbprint is detected to no longer being revoked. Revocation here " + 
			"may not be a hard revoke from an OCSP and CRL List. Internal logic may cause the cert to be soft revoked and can be clear if the " +
			"condition allow for it. Example internal OCSP logic fails to get a new status on the certificate in time, will be regarded as being " +
			"soft revoked until a new status is received").append("<br>"))
			.append($("<h3>").text("Inputs"))
			.append(properties);
		}
	});
	certMngrActionMap.set("Clear CRL", {
		id: "Clear CRL",
		method: "proto.sim.ocsp.clear_crl",		
		// returns the json representation of the data for this exposed API		
		// Allows this node to use this node's specific data to generate some meaningful label name for the flow nodes
		getNodeLabel: function(data){
			return "Clear CRL";
		},
		helper: function(helper_panel){			
			helper_panel
			.append($("<p>").html("Clears the entire list of revocation list").append("<br>"));
		}
	});
	classActionMap.set("Certificates", certMngrActionMap);

	var simADRActionMap = new Map();
	simADRActionMap.set("Trigger ADR System Failure", {
		id: "Trigger ADR System Failure",
		method: "g2s.egm.G2S_adr.device_failure",		
		getNodeLabel: function(data){
			let label = "Trigger ADR Failure";
			if(!data.set_flag)
				label += " Cleared";
			return label;			
		},
		buildDataPanel: function(container){
			$("<div>").append($("<h3>").text("ADR System Failure"))
				.append(g2sUtils.checkboxInput({id:"node-input-adr_sim_crash", text:"Simulate ADR Failure"}))
				.appendTo(container);
		},
		getData: function(){
			return {				
				set_flag: $("#node-input-adr_sim_crash").prop('checked'),
			}; 
		},
		// recovery from a json representation of the data last set
		setData: function(data){
			$("#node-input-adr_sim_crash").prop('checked', data.set_flag);
		},
		helper: function(helper_panel){
			let properties = $("<dl>").addClass("message-properties");
			
			g2sUtils.helperProp(properties, "Simulate ADR Failure", "Boolean", "Whether this simulate the failure, or clearing the failure");
			
			helper_panel
			.append($("<p>").html("Request the G2S to simulate the ADR system running into some sytem failure").append("<br>"))
			.append($("<h3>").text("Inputs"))
			.append(properties);
		}
	});
	simADRActionMap.set("Create ADR", {
		id: "Create ADR",
		method: "g2s.egm.sim.adr.sim_create_adr",		
		getNodeLabel: function(data){
			return "Create ADR (" + data.id + ")";
		},
		buildDataPanel: function(container){
			$("<div>").append($("<h3>").text("ADR Information"))
				.append(g2sUtils.input({id:"node-input-adr_id", type:"text", text:"Id"}))
				.append(g2sUtils.input({id:"node-input-adr_description", type:"text", text:"Description"}))
				.append(g2sUtils.input({id:"node-input-adr_reason", type:"text", text:"Reason"}))
				.append(g2sUtils.checkboxInput({id:"node-input-adr_can_be_overwritten", text:"Can be overwritten"}))
				.append(g2sUtils.checkboxInput({id:"node-input-adr_sim_crash", text:"Simulate Crash"}))
				.appendTo(container);
		},
		getData: function(){
			return {
				id: $("#node-input-adr_id").val(),
				description: $("#node-input-adr_description").val(),
				reason: $("#node-input-adr_reason").val(),
				can_be_overwriten: $("#node-input-adr_can_be_overwritten").prop('checked'),
				sim_from_crash: $("#node-input-adr_sim_crash").prop('checked'),
			}; 
		},
		// recovery from a json representation of the data last set
		setData: function(data){
			$("#node-input-adr_id").val(data.id);
			$("#node-input-adr_description").val(data.description);
			$("#node-input-adr_reason").val(data.reason);
			$("#node-input-adr_can_be_overwritten").prop('checked', data.can_be_overwriten);
			$("#node-input-adr_sim_crash").prop('checked', data.sim_from_crash);
		},
		helper: function(helper_panel){
			let properties = $("<dl>").addClass("message-properties");
			
			g2sUtils.helperProp(properties, "Id", "String", "Unique id of this snapshot");
			g2sUtils.helperProp(properties, "Description", "String", "Description for this snapshot");
			g2sUtils.helperProp(properties, "Reason", "String", "Short reason code for this snapshot");
			g2sUtils.helperProp(properties, "Can be overwritten", "Boolean", "Whether this snapshot can be overriten by another snapshot in the future");
			g2sUtils.helperProp(properties, "Simulate Crash", "Boolean", "Whehter this snapshot is a result of a system crash");
			
			helper_panel
			.append($("<p>").html("Request the G2S to create an ADR snapshot with the report data set to the properties defined").append("<br>"))
			.append($("<h3>").text("Inputs"))
			.append(properties);
		}
	});
	simADRActionMap.set("Delete ADR", {
		id: "Delete ADR",
		method: "g2s.egm.sim.adr.sim_delete_adr",		
		getNodeLabel: function(data){
			return "Delete ADR (" + data.id + ")";
		},
		buildDataPanel: function(container){
			$("<div>").append($("<h3>").text("ADR Information"))
				.append(g2sUtils.input({id:"node-input-adr_id", type:"text", text:"Id"}))				
				.append(g2sUtils.input({id:"node-input-adr_reason", type:"text", text:"Reason"}))				
				.appendTo(container);
		},
		getData: function(){
			return {
				id: $("#node-input-adr_id").val(),				
				reason: $("#node-input-adr_reason").val()				
			}; 
		},
		// recovery from a json representation of the data last set
		setData: function(data){
			$("#node-input-adr_id").val(data.id);			
			$("#node-input-adr_reason").val(data.reason);			
		},
		helper: function(helper_panel){
			let properties = $("<dl>").addClass("message-properties");
			
			g2sUtils.helperProp(properties, "Id", "String", "Unique id of the snapshot to delete");			
			g2sUtils.helperProp(properties, "Reason", "String", "Short reason code for deleting this snapshot");			
			
			helper_panel
			.append($("<p>").html("Request the G2S to delete an ADR snapshot with the report data set to the properties defined").append("<br>"))
			.append($("<h3>").text("Inputs"))
			.append(properties);
		}
	});
	simADRActionMap.set("Create Screenshot", {
		id: "Create Screenshot",
		method: "g2s.egm.sim.adr.sim_create_screenshot",		
		getNodeLabel: function(data){
			return "Create Screenshot (" + data.id + ")";
		},
		buildDataPanel: function(container){
			$("<div>").append($("<h3>").text("Screenshot Information"))
				.append(g2sUtils.input({id:"node-input-ss_id", type:"text", text:"Id"}))
				.append(g2sUtils.input({id:"node-input-ss_description", type:"text", text:"Description"}))
				.append(g2sUtils.input({id:"node-input-ss_reason", type:"text", text:"Reason"}))
				.append(g2sUtils.checkboxInput({id:"node-input-ss_can_be_overwritten", text:"Can be overwritten"}))
				.appendTo(container);
		},
		getData: function(){
			return {
				id: $("#node-input-ss_id").val(),
				description: $("#node-input-ss_description").val(),
				reason: $("#node-input-ss_reason").val(),
				can_be_overwriten: $("#node-input-ss_can_be_overwritten").prop('checked')
			}; 
		},
		// recovery from a json representation of the data last set
		setData: function(data){
			$("#node-input-ss_id").val(data.id);
			$("#node-input-ss_description").val(data.description);
			$("#node-input-ss_reason").val(data.reason);
			$("#node-input-ss_can_be_overwritten").prop('checked', data.can_be_overwriten);
		},
		helper: function(helper_panel){
			let properties = $("<dl>").addClass("message-properties");
			
			g2sUtils.helperProp(properties, "Id", "String", "Unique id of this srceenshot");
			g2sUtils.helperProp(properties, "Description", "String", "Description for this srceenshot");
			g2sUtils.helperProp(properties, "Reason", "String", "Short reason code for this srceenshot");
			g2sUtils.helperProp(properties, "Can be overwritten", "Boolean", "Whether this srceenshot can be overriten by another srceenshot in the future");
			
			helper_panel
			.append($("<p>").html("Request the G2S to create an ADR srceenshot with the report data set to the properties defined").append("<br>"))
			.append($("<h3>").text("Inputs"))
			.append(properties);
		}
	});
	simADRActionMap.set("Delete Screenshot", {
		id: "Delete Screenshot",
		method: "g2s.egm.sim.adr.sim_delete_screenshot",		
		getNodeLabel: function(data){
			return "Delete Screenshot (" + data.id + ")";
		},
		buildDataPanel: function(container){
			$("<div>").append($("<h3>").text("Screenshot Information"))
				.append(g2sUtils.input({id:"node-input-ss_id", type:"text", text:"Id"}))				
				.append(g2sUtils.input({id:"node-input-ss_reason", type:"text", text:"Reason"}))				
				.appendTo(container);
		},
		getData: function(){
			return {
				id: $("#node-input-ss_id").val(),				
				reason: $("#node-input-ss_reason").val()				
			}; 
		},
		// recovery from a json representation of the data last set
		setData: function(data){
			$("#node-input-ss_id").val(data.id);			
			$("#node-input-ss_reason").val(data.reason);			
		},
		helper: function(helper_panel){
			let properties = $("<dl>").addClass("message-properties");
			
			g2sUtils.helperProp(properties, "Id", "String", "Unique id of the snapshot to delete");			
			g2sUtils.helperProp(properties, "Reason", "String", "Short reason code for deleting this snapshot");			
			
			helper_panel
			.append($("<p>").html("Request the G2S to delete a Screenshot with the report data set to the properties defined").append("<br>"))
			.append($("<h3>").text("Inputs"))
			.append(properties);
		}
	});
	classActionMap.set("G2S_adr", simADRActionMap);
	
	var simDelayMngrActionMap = new Map();
	simDelayMngrActionMap.set("Any Game Delays", {
		id: "Any Game Delays",
		method: "g2s.egm.sim.game_delay_mngr.any_game_delays",		
		getNodeLabel: function(data){
			return "Any Game Delays?";
		},				
		helper: function(helper_panel){		
			helper_panel
			.append($("<p>").html("Request the EGM Sim to check if any game delays have been applied to games").append("<br>"));
		}
	});
	simDelayMngrActionMap.set("Get Game Delay", {
		id: "Get Game Delay",
		method: "g2s.egm.sim.game_delay_mngr.get_game_delay",		
		getNodeLabel: function(data){
			return "Get Game Delay";
		},				
		helper: function(helper_panel){		
			helper_panel
			.append($("<p>").html("Request the EGM Sim to return the amount of game delay in milliseconds that is currently active").append("<br>"));
		}
	});
	classActionMap.set("Sim Game Delay Manager", simDelayMngrActionMap);

	var simBankerActionMap = new Map();
	simBankerActionMap.set("Cashout", {
		id: "Cashout",
		method: "g2s.egm.sim.banker.cashout",		
		getNodeLabel: function(data){
			return "Cashout";
		},
		helper: function(helper_panel){		
			helper_panel
			.append($("<p>").html("Request the G2S Sim to simulate a cashout being initiated by the player. This will find and use the proper location for the cashout. "+ 
			"Example, if WAT is enabled for cashout it will use this first, if not, it will look for voucher issuance being allowed. If all else fails and Handpay will be triggered").append("<br>"));
		}
	});
	simBankerActionMap.set("Get Bank Amts", {
		id: "Get Bank Amts",
		method: "g2s.egm.sim.banker.get_amts",		
		getNodeLabel: function(data){
			return "Get Bank Amounts";
		},
		helper: function(helper_panel){
			let properties = $("<dl>").addClass("message-properties");
			
			g2sUtils.helperProp(properties, "amount.cash", "Integer", "Amount of cash in the bank");
			g2sUtils.helperProp(properties, "amount.promo", "Integer", "Amount of promotional cash in the bank");
			g2sUtils.helperProp(properties, "amount.non_cash", "Integer", "Amount of non cashable credits in the bank");
			
			helper_panel
			.append($("<p>").html("Request the G2S Sim to return the amounts in the bank").append("<br>"))
			.append($("<h3>").text("Outputs"))
			.append(properties);
		}
	});
	simBankerActionMap.set("KeyOff Handpay", {
		id: "KeyOff Handpay",
		method: "g2s.egm.sim.banker.keyoff",		
		getNodeLabel: function(data){
			if(data.keyoff_type != "")
				return "Keyoff to " + data.keyoff_type;
			else
				return "Keyoff Pending Handpay";
		},
		buildDataPanel: function(container){
			$("<div>").append($("<h3>").text("Keyoff Information"))
				.append(g2sUtils.selectInput([{value:"G2S_localHandpay", text:"Local Handpay"}], {id:"node-input-keyoff_type", text: "Keyoff type"}))			
				.appendTo(container);
		},
		getData: function(){
			return {
				keyoff_type: $("#node-input-keyoff_type").val()				
			}; 
		},
		// recovery from a json representation of the data last set
		setData: function(data){
			$("#node-input-keyoff_type").val(data.keyoff_type);
		},
		helper: function(helper_panel){
			let properties = $("<dl>").addClass("message-properties");
			
			g2sUtils.helperProp(properties, "Keyoff type", "String", "Key off type (See G2S handpay for details on handpay types");
			
			helper_panel
			.append($("<p>").html("Simulates the manual handpay key offs at the EGM").append("<br>"))
			.append($("<h3>").text("Inputs"))
			.append(properties);
		}
	});
	classActionMap.set("Sim Banker", simBankerActionMap);
		
	var simGameLinkActionMap = new Map();
	simGameLinkActionMap.set("Send Game Msg", {
		id: "Send Game Msg",
		method: "g2s.egm.G2S_gameLink.publish",		
		getNodeLabel: function(data){
			return "Send Game Msg " + data.destination;
		},
		buildDataPanel: function(container){
			$("<div>").append($("<h3>").text("Message Information"))
				.append(g2sUtils.input({id:"node-input-topic", type:"text", text:"Topic"}))
				.append(g2sUtils.input({id:"node-input-data", type:"text", text:"Base64 Data"}))
				.append(g2sUtils.input({id:"node-input-data_length", type:"number", text:"Original Data Length"}))
				.append($("<h3>").text("Headers"))
				.append($("<div>").addClass("form-row")
					.append($("<ol>").attr("id", "node-input-headers-container")))
				.appendTo(container);

			$("#node-input-headers-container").css('min-height','200px')
				.css('min-width','400px').editableList({
				addItem: function(container,i,opt) {
					var dflt_name = "";
					var dflt_value = "";
					if(opt.hasOwnProperty("name"))
						dflt_name = opt.name;
						
					if(opt.hasOwnProperty("value"))
						dflt_value = opt.value;
						
					container.css({
                        overflow: 'hidden',
                        whiteSpace: 'nowrap'
                    });
						
					var row = $('<div/>').css("width", "70%").appendTo(container);
					$('<input class="node-input-rule-value" type="text" id="header_name" placeholder="name">').css("margin-right", "2px").val(dflt_name).appendTo(row);
					$('<input class="node-input-rule-value" type="text" id="header_value" placeholder="value">').val(dflt_value).appendTo(row);
				},
				removeItem: function(opt) {
				},
				removable: true
			});
		},
		// returns the json representation of the data for this exposed API
		getData: function(){
			var header_list = $("#node-input-headers-container").editableList('items');
            let current_headers = [];

			header_list.each(function(i) {
				var header_name = $(this).find("#header_name").val();
				var header_value = $(this).find("#header_value").val();
				current_headers.push({name:header_name, value:header_value});
			});
			console.log(JSON.stringify(current_headers));
			return {
				destination: $("#node-input-topic").val(),
				data: $("#node-input-data").val(),
				data_length: $("#node-input-data_length").val(),
				headers:current_headers
			}; 
		},
		// recovery from a json representation of the data last set
		setData: function(data){
			console.log(JSON.stringify(data));
			$("#node-input-topic").val(data.destination);
			$("#node-input-data").val(data.data);
			$("#node-input-data_length").val(data.data_length);
			
			for (var i=0;i < data.headers.length; i++) {
                $("#node-input-headers-container").editableList('addItem',data.headers[i]);
			}
		},
		helper: function(helper_panel){
			let properties = $("<dl>").addClass("message-properties");
			
			g2sUtils.helperProp(properties, "Topic", "String", "Topic assigned for this game link game message");
			g2sUtils.helperProp(properties, "Base64 Data", "String", "Base64 encoded data to send for the game msg");
			g2sUtils.helperProp(properties, "Original Data Length", "Integer", "Original length of the raw data before being encoded to base64");
			
			helper_panel
			.append($("<p>").html("Simulates teh sending of a game message to the topic.").append("<br>"))
			.append($("<h3>").text("Inputs"))
			.append(properties);
		}
	});
	classActionMap.set("G2S_gameLink", simGameLinkActionMap);

	var commonQueryMap = new Map();
	commonQueryMap.set("Get Device Status", {
		id: "Get Device Status",
		method: "g2s.egm.devices.get_status",
		// Below is how this g2s API can display it's required data
		buildDataPanel: function(container){
			$("<div>").append($("<h3>").text("Device Information"))
				.append(g2sDataMap.get("device_info").dataPanel())
				.appendTo(container);
		},
		// returns the json representation of the data for this exposed API
		getData: function(){
			return {device_info: g2sDataMap.get("device_info").getData()};
		},
		// recovery from a json representation of the data last set
		setData: function(data){
			g2sDataMap.get("device_info").setData(data.device_info);
		},
		// Allows this node to use this node's specific data to generate some meaningful label name for the flow nodes
		getNodeLabel: function(data){
			return "Get Status (" + data.device_info.class_name + "/" + ((data.device_info.uid && data.device_info.uid != "") ? data.device_info.uid : data.device_info.id) + ")";
		},
		helper: function(helper_panel){
			let properties = $("<dl>").addClass("message-properties");
			
			g2sDataMap.get("device_info").append_helper_properties(properties);
			
			helper_panel
			.append($("<p>").html("Request the G2S engine to return the current device status for the specified device").append("<br>"))
			.append($("<h3>").text("Inputs"))
			.append(properties)
			.append($("<h3>").text("Output"))
			.append($("<p>").html("The output of this query depends on the requested device. Each device returns a json formated string representing " +
			"it's status. Most of the data here reflects the G2S device status, butmay include more")); // TODO link to actual documentation of the status json data....
		}
	});		
	commonQueryMap.set("Get EGM Id", {
		id: "Get EGM Id",
		method: "g2s.egm.G2S_cabinet.get_egm_id",		
		// Allows this node to use this node's specific data to generate some meaningful label name for the flow nodes
		getNodeLabel: function(data){
			return "Get EGM Id";
		},
		helper: function(helper_panel){
			let properties = $("<dl>").addClass("message-properties");
			
			helper_panel
			.append($("<p>").html("Gets the assigned EGM id for this EGM instance")); // TODO link to actual documentation of the status json data....
		}
	});	
	commonQueryMap.set("Get Meter Value", {
		id: "Get Meter Value",
		method: "g2s.egm.meters.get_meter",
		// Below is how this g2s API can display it's required data
		buildDataPanel: function(container){
			$("<div>").append($("<h3>").text("Device Information"))
				.append(g2sDataMap.get("device_info").dataPanel())
				.append($("<h3>").text("Meter Information"))
				.append(g2sUtils.input({id:"node-input-meter_name", type:"text", text:"Meter Name"}))
				.appendTo(container);
		},
		// returns the json representation of the data for this exposed API
		getData: function(){
			let this_data = {
				device_info: g2sDataMap.get("device_info").getData(),
				meter_name: $("#node-input-meter_name").val()
			};
			console.log(JSON.stringify(this_data));
			return this_data;
		},
		// recovery from a json representation of the data last set
		setData: function(data){
			g2sDataMap.get("device_info").setData(data.device_info);
			$("#node-input-meter_name").val(data.meter_name);
		},
		// Allows this node to use this node's specific data to generate some meaningful label name for the flow nodes
		getNodeLabel: function(data){
			return "Get Meter (" + data.device_info.class_name + "/" + (data.device_info.uid !== undefined ? data.device_info.uid : data.device_info.id) + "/" + data.meter_name + ")";
		},
		helper: function(helper_panel){
			let properties = $("<dl>").addClass("message-properties");
			
			g2sDataMap.get("device_info").append_helper_properties(properties);
			
			g2sUtils.helperProp(properties, "Meter Name", "String", "Name of the G2S meter to retrieve");
			
			let out_properties = $("<dl>").addClass("message-properties")
			g2sUtils.helperProp(out_properties, "meter.value", "Integer", "Value of the meter queried");
			helper_panel
			.append($("<p>").html("Requests the G2S engine to return the current value of the specified meter for the specifed device").append("<br>"))
			.append($("<h3>").text("Inputs"))
			.append(properties)
			.append($("<h3>").text("Output"))
			.append(out_properties);
		}
	});
	classActionMap.set("Common", commonQueryMap);	
	
	/////////////////////////////////////////
	// End of G2S exposed API 'nodes'
	/////////////////////////////////////////
	RED.nodes.registerType('g2sActionData',{
        category: 'g2s',
        color: '#a6bbcf',
		defaults: {
			g2s_date_type_name: {value:""},
			data_type: {value:"", type:"string", required:true},
			g2s_data: {value:{}},
		},
        inputs:1,
        outputs:1,
		align:"left",
        icon: "file.png",
		paletteLabel:"ActionData",
        label: function(){
			if(this.g2s_date_type_name && this.g2s_date_type_name != "")
				return this.g2s_date_type_name;
			else if(this.data_type){
				let this_type = g2sDataMap.get(this.data_type);
				if(this_type.getNodeLabel !== undefined)
					return this_type.getNodeLabel(this.g2s_data);

				return this.data_type;
			}

			return "g2sActionData";
		},
		oneditsave: function(){
			this.data_type = $("#node-input-g2s_data_type option:selected").val();
			let this_data_type = g2sDataMap.get(this.data_type);
			this.g2s_data = this_data_type.getData();
		},
		oneditprepare: function(){
			var current_data_type = JSON.parse(JSON.stringify(this.data_type));
			var current_data = JSON.parse(JSON.stringify(this.g2s_data));

			console.log("current_data_type: ", current_data_type);
			console.log("current_data: ", current_data);

			function showDataTypePanel(){				
				if(current_data_type != ""){					
					let data_panel = $("#g2s_action_data_type_panel");
					data_panel.empty();					
					let this_data_type = g2sDataMap.get(current_data_type);					
					if(this_data_type.dataPanel){						
						data_panel.append(this_data_type.dataPanel());						
						data_panel.show();
					}
					else
						data_panel.hide();
				}
				else{
					data_panel.empty();
					data_panel.hide();
				}
			}

			if(current_data_type == ""){
				current_data_type = g2sDataMap.entries().next().value[0];
			}

			let sorted_type_ids = Array.from(g2sDataMap.keys()).sort();
			sorted_type_ids.forEach(function(value){
				$("#node-input-g2s_data_type").append(new Option(value, value, false, value == current_data_type));
			});

			showDataTypePanel(current_data_type);

			if(!jQuery.isEmptyObject(current_data))
				g2sDataMap.get(current_data_type).setData(current_data);

			$("#node-input-g2s_data_type").change(function(){
				let new_data_type = $("#node-input-g2s_data_type option:selected").val();
			 	if(new_data_type != current_data_type){
					current_data_type = new_data_type;
			 		showDataTypePanel(current_data_type);
			 	}
			});
		}
	});

	RED.nodes.registerType('g2sAction',{
        category: 'g2s',
        color: '#D8BFD8',
		defaults: {
			g2s_action_name: {value:""},

			class_name: {value:"", type:"string", required:true},

			action_data: {value:{}},
			action:{value:{class_name:"", class_action:"", action_method:""}},
			use_this_transport: {value:false, required:false},
			use_mqtt: {value:false, required:false},

			xmlrpc_config: {type:"xmlrpc-client", required:false},

			mqtt_config: {type:"mqtt-broker", required:false},
			mqtt_egm_group: {type:"g2sEGMGroupConfig", required:false},
            mqtt_qos: {value:"", required:false},
            mqtt_retain: {value:"", required:false},
			sync_with_group: {value:true, required:false},
			sync_with_group_timeout: {value:5, required:false}
		},
        inputs:1,
        outputs:1,
		align:"right",
        icon: "bridge.png",
		paletteLabel:"Action",
        label: function(){
			if(this.g2s_action_name && this.g2s_action_name != "")
				return this.g2s_action_name;
			else if(this.action.class_name != "" && this.action.class_action != ""){
				let this_class = classActionMap.get(this.action.class_name);
				if(this_class !== undefined){
					let this_action = this_class.get(this.action.class_action);
					if(this_action !== undefined && this_action.getNodeLabel !== undefined && this.action_data !== undefined && !$.isEmptyObject(this.action_data)){
						return this_action.getNodeLabel(this.action_data);
					}
					else if(this_action === undefined)
						console.log("Could not find associated action with: " + this.action.class_action + " from " + this.action.class_name);
					else
						return (this.action.class_name + " " + this.action.class_action);
				}
			}
			
			return "g2sAction";
		},
		oneditsave: function(){
			this.action.class_name = $("#node-input-class_name option:selected").val();
			this.action.class_action = $("#node-input-class_action option:selected").val();

			let this_action = classActionMap.get(this.action.class_name).get(this.action.class_action);
			this.action.action_method = this_action.method;
			this.action_data = this_action.getData();
		},
		oneditprepare: function(){
			var node = this;
			var current_action = JSON.parse(JSON.stringify(this.action));
			var current_action_data = JSON.parse(JSON.stringify(this.action_data));
			
			function showCurrentActionSelection(){
				if(current_action.class_action != ""){
					let data_panel = $("#class_action_data_panel");
					data_panel.empty();
					let this_action = classActionMap.get(current_action.class_name).get(current_action.class_action);
					if(this_action.buildDataPanel){
						this_action.buildDataPanel(data_panel);
						data_panel.show();
					}
					else
						data_panel.hide();
				}
				else{
					data_panel.empty();
					data_panel.hide();
				}
			}

			function setCurrentActionSelection(className, action){
				current_action = {class_name:className, class_action:action.id, action_method:action.method};
				showCurrentActionSelection();
			}

			function populateClassActionSelect(class_name, default_action){
				$("#node-input-class_action").empty();

				let class_actions = classActionMap.get(class_name);

				if(class_actions){
					let sorted_actions_ids = Array.from(class_actions.keys()).sort();

					sorted_actions_ids.forEach(function(value){
						$("#node-input-class_action").append(new Option(value, value, false, value == default_action));
					});
				}
			}

			function switchToMqttConfig(){
				$("#egm_xmlrpc_config").hide();
				$("#egm_mqtt_config").show();
			}

			function switchToXmlRpcConfig(){
				$("#egm_mqtt_config").hide();
				$("#egm_xmlrpc_config").show();
			}

			if(node.use_mqtt)
				switchToMqttConfig();
			else
				switchToXmlRpcConfig();

			$("#node-input-class_name").empty();
			let sorted_class_ids = Array.from(classActionMap.keys()).sort();
			sorted_class_ids.forEach(function(value){
				$("#node-input-class_name").append(new Option(value, value, false, value == current_action.class_name));
			});

			if(current_action.class_name == ""){
				current_action.class_name = $("#node-input-class_name option:selected").val();
			}

			if(current_action.class_action == ""){
				current_action.class_action = classActionMap.get(current_action.class_name).entries().next().value[1].id;
			}

			populateClassActionSelect(current_action.class_name, current_action.class_action)
			showCurrentActionSelection();

			if(!$.isEmptyObject(current_action_data))
				classActionMap.get(current_action.class_name).get(current_action.class_action).setData(current_action_data);

			$("#node-input-class_name").change(function(){
				let new_class_name = $("#node-input-class_name option:selected").val();
				if(new_class_name != current_action.class_name){
					current_action.class_name = new_class_name;
					current_action.class_action = classActionMap.get(current_action.class_name).entries().next().value[1].id;
					populateClassActionSelect(current_action.class_name, current_action.class_action);
					setCurrentActionSelection(current_action.class_name, classActionMap.get(current_action.class_name).get(current_action.class_action));
				}
			});

			$("#node-input-class_action").change(function(){
				let new_class_action = $("#node-input-class_action option:selected").val();				
				if(new_class_action != current_action.class_action){
					current_action.class_action = new_class_action;
					setCurrentActionSelection(current_action.class_name, classActionMap.get(current_action.class_name).get(current_action.class_action));
				}
			});

			$("#node-input-use_mqtt").click(function(){
				if($(this).is(':checked'))
					switchToMqttConfig();
				else
					switchToXmlRpcConfig();
			});
		}
	});

	RED.nodes.registerType('g2sRPCTransport',{
        category: 'g2s',
        color: '#AC009E',
		defaults: {
			g2s_transport_name: {value:""},

			use_mqtt: {value:false, required:false},

			xmlrpc_config: {type:"xmlrpc-client", required:false},

			mqtt_config: {type:"mqtt-broker", required:false},
			mqtt_egm_group: {type:"g2sEGMGroupConfig", required:false},
            mqtt_qos: {value:"", required:false},
			mqtt_retain: {value:false, required:false},
			sync_with_group: {value:true, required:false},
			sync_with_group_timeout: {value:5, required:false},

			save_to_flow: {value:false, required:false}
		},
        inputs:1,
        outputs:1,
		align:"left",
        icon: "file.png",
		paletteLabel:"Transport",
        label: function(){
			if(this.g2s_transport_name && this.g2s_transport_name != "")
				return this.g2s_transport_name;

			return "(" + (this.use_mqtt ? "MQTT" : "XML-Rpc") + ") Transport";
		},
		oneditprepare: function(){
			function switchToMqttConfig(){
				$("#egm_xmlrpc_config").hide();
				$("#egm_mqtt_config").show();
			}

			function switchToXmlRpcConfig(){
				$("#egm_mqtt_config").hide();
				$("#egm_xmlrpc_config").show();
			}

			if(this.use_mqtt)
				switchToMqttConfig();
			else
				switchToXmlRpcConfig();

			$("#node-input-use_mqtt").click(function(){
				if($(this).is(':checked'))
					switchToMqttConfig();
				else
					switchToXmlRpcConfig();
			});
		}
	});
	RED.nodes.registerType('g2sEGMGroupConfig',{
        category: 'config',
        color: '#AC009E',
		defaults: {
			name: {value:"", type:"string", required:false},
			group_name: {value:"", type:"string", required:true},
			mqtt_config: {type:"mqtt-broker", required:false},
            egm_list: {value:[]},
			enroll_pki: {value:false, required:false},
			pki_scep_url: {value:"", type:"string", required:false},
			pki_key_size: {value:2048, type:"number", required:false},
			pki_nonce: {value:"", type:"string", required:false},
			use_batch_egm_mngr: {value:false, required:false},
			egm_config_name: {value:"", type:"string", required:false},
			g2s_cc_override: {value:"", type:"string", required:false}
		},
		label: function() {
            return this.group_name||this.name||"g2sEGMGroup";
        },
		oneditprepare: function() {
			var node = this;			
			var validating_group_name = false;
			var refreshing_egm_configs = false;
			var last_validated_group_name = this.group_name;
			var current_egm_config = this.egm_config_name;

			function evalMQTTConfigInput(){
				$("#node-config-input-mqtt_config").prop("disabled", !(!validating_group_name && !refreshing_egm_configs));
			}

			function ValidateGroupId(){
				var new_group = $("#node-config-input-group_name").val();

				if(!validating_group_name && (last_validated_group_name != new_group)){
					validating_group_name = true;
					$("#egm_group_name_busy").show();
					evalMQTTConfigInput();

					let req_data = {
						group_id: new_group,
						mqtt_config:$("#node-config-input-mqtt_config").val()
					}
					
					$.getJSON("reserve_egm_group", req_data, function(data){
						if(data.success && data.success == "false"){							
							$('#node-config-input-group_name').fadeTo(100, 0.3, function() { $(this).fadeTo(500, 1.0); });
							$('#node-config-input-group_name').val("").attr("placeholder", new_group);
							$("#node-config-input-bad_group_name").show();							
						}
						else if(data.status == 404){
							$("#egm_group_name_busy").hide();			
							alert("Failed to reserve group name from server");	
						}
						else{							
							last_validated_group_name = new_group;
							$("#node-config-input-bad_group_name").hide();							
						}

						validating_group_name = false;
						$("#egm_group_name_busy").hide();
						evalMQTTConfigInput();

					}).fail(function(){			
						$("#egm_group_name_busy").hide();			
						alert("Failed to reserve group name from server");
						// TODO how to handle this.. if it fails, what will try the validation again? In most if not all scenarios, changing somethign will retrigger it.
						validating_group_name = false;
						evalMQTTConfigInput();
					});					
				}
			};

			function refreshAvailableEGMConfigs(){
				if($("#node-config-input-mqtt_config").val() != "" && !refreshing_egm_configs){
					refreshing_egm_configs = true;
					$("#egm_config_name_busy").show();
					let this_select = $("#node-config-input-egm_config_name");
					this_select.empty();
					this_select.prop("disabled");

					evalMQTTConfigInput();

					let req_data = {
						mqtt_config:$("#node-config-input-mqtt_config").val(),
					}
					
					$.getJSON("get_available_egm_configs", req_data, function(data){
						refreshing_egm_configs = false;
						$("#egm_config_name_busy").hide();
						if(data.available_egm_configs !== undefined){							
							let this_select = $("#node-config-input-egm_config_name");
							
							this_select.empty();						
							data.available_egm_configs.forEach(function(item){
								this_select.append($("<option>").attr("value", item.config).text(item.config));
							});
							this_select.prop("disabled", false);

							if(current_egm_config == "")
								$("#node-config-input-egm_config_name").val($("#node-config-input-egm_config_name option:first").val());
							else{
								$("#node-config-input-egm_config_name").val($("#node-config-input-egm_config_name option:first").val());
								current_egm_config = ""
							}
						}
						else
							console.log(JSON.stringify(data));

						evalMQTTConfigInput();
					}).fail(function(){
						refreshing_egm_configs = false;
						$("#egm_config_name_busy").hide();
						alert("Failed to get Available EGM config list from server");
						$("#node-config-input-egm_config_name").prop("disabled", false);
						evalMQTTConfigInput();
					});
				}
			}

			$("#generate_egm_list_button").button();
			$("#generate_egm_list_button").click(function(event){
				let req_data = {
					count: Number($("#generate_egm_list_count").val()),
					gsa_prefix:$("#generate_egm_list_gsa_prefix").val(),
					mqtt_config:$("#node-config-input-mqtt_config").val(),
				}
				if(req_data.count > 0 && req_data.gsa_prefix != "" && req_data.mqtt_config != ""){
					$("#generate_egm_list_button_busy").show();

					$.getJSON("gen_egm_list", req_data, function(data){	
						$("#generate_egm_list_button_busy").hide();
						data.egm_id_list.forEach(function(gen_egm_id){
							$("#node-config-egm_list_container").editableList('addItem', {egm_id:gen_egm_id.egm_id});
						});
					}).fail(function(){
						alert("Failed to get EGM list from server");
						$("#generate_egm_list_button_busy").hide();
					});
				}
				else{
					if(req_data.count <= 0){
						$('#generate_egm_list_count').fadeTo(100, 0.3, function() { $(this).fadeTo(500, 1.0); });
					}
					if(req_data.gsa_prefix == ""){
						$('#generate_egm_list_gsa_prefix').fadeTo(100, 0.3, function() { $(this).fadeTo(500, 1.0); });
					}
					if(req_data.mqtt_config == ""){
						$('#node-config-input-mqtt_config').fadeTo(100, 0.3, function() { $(this).fadeTo(500, 1.0); });
					}
				}
			});

			$("#node-config-egm_list_container").css('min-height','200px').css('min-width','450px').editableList({
				addItem: function(container,i,opt) {
					var dflt_id = "";
					if(opt.hasOwnProperty("egm_id"))
						dflt_id = opt.egm_id;

					container.css({
                        overflow: 'hidden',
                        whiteSpace: 'nowrap'
                    });
                    var row = $('<div/>').appendTo(container);
					$('<label><i class="icon-tag"></i> EGM Id</label>').appendTo(row);
					$('<input type="text" placeholder="G2S EGM Identification">').val(dflt_id).appendTo(row);
				},
				removeItem: function(opt) {
				},
				removable: true
			});

			$("#node-config-input-use_batch_egm_mngr").click(function(event){
				if(this.checked){
					refreshAvailableEGMConfigs();
					$("#batch_egm_mngr_utils").show();
					
					if($("#node-config-input-group_name").val() != ""){
						ValidateGroupId();
					}
				}
				else 
					$("#batch_egm_mngr_utils").hide();
			});

			if(this.use_batch_egm_mngr){
				$("#batch_egm_mngr_utils").show();

				if($("#node-config-input-group_name").val() != ""){
					ValidateGroupId();
				}
			}

			$("#node-config-input-mqtt_config").change(function(event){				
				if($("#node-config-input-use_batch_egm_mngr").prop("checked")){
					// Value _ADD_ is used for adding a new config to the list, ignore that one.
					if($("#node-config-input-mqtt_config").val() != "_ADD_" && !($("#node-config-input-mqtt_config").val() == node.mqtt_config && $("#node-config-input-group_name").val() == node.group_name)){
						if($("#node-config-input-group_name").val() != ""){							
							ValidateGroupId();
						}

						refreshAvailableEGMConfigs();
					}
				}
			});

			$("#node-config-input-group_name").focusout(function(event){				
				if($("#node-config-input-use_batch_egm_mngr").prop("checked")){
					ValidateGroupId();
				}
			});

			$("#node-config-input-enroll_pki").click(function(event){
				if(this.checked)
					$("#pki_config").show();
				else 
					$("#pki_config").hide();
			});

			for (var i=0;i < this.egm_list.length; i++) {
                $("#node-config-egm_list_container").editableList('addItem', {egm_id:this.egm_list[i]});
			}
			
			if(this.enroll_pki)
				$("#pki_config").show();

			$("#egm_config_name_busy").hide();
			$("#egm_group_name_busy").hide();

			refreshAvailableEGMConfigs();
		},
		oneditsave: function() {
			var egms = $("#node-config-egm_list_container").editableList('items');
			var node = this;
            node.egm_list = [];

			var num = 0;
			egms.each(function(i) {
				var egm_id = $(this).find("input").val();
				node.egm_list.push(egm_id);
			});
		}
	});
	RED.nodes.registerType('g2sEgmEventMngrConfig',{
        category: 'config',
        defaults: {
			name: {value:""},

			use_mqtt: {value:false, required:false},

			xmlrpc_client_config: {type:"xmlrpc-client", required:false},
			xmlrpc_server_config: {type:"xmlrpc-server", required:false},

			mqtt_config: {type:"mqtt-broker", required:false},
			mqtt_egm_group: {type:"g2sEGMGroupConfig", required:false},
            mqtt_qos: {value:"", required:false},
			mqtt_retain: {value:false, required:false},
        },
        label: function() {
            return this.name||"";
		},
		oneditprepare: function(){
			function switchToMqttConfig(){
				$("#egm_xmlrpc_config").hide();
				$("#egm_mqtt_config").show();
			}

			function switchToXmlRpcConfig(){
				$("#egm_mqtt_config").hide();
				$("#egm_xmlrpc_config").show();
			}

			if(this.use_mqtt)
				switchToMqttConfig();
			else
				switchToXmlRpcConfig();

			$("#node-config-input-use_mqtt").click(function(){
				if($(this).is(':checked'))
					switchToMqttConfig();
				else
					switchToXmlRpcConfig();
			});
		}
    });
    RED.nodes.registerType('g2sOnEGMEvent',{
        category: 'g2s',
        defaults: {
            name: {value:""},
            event_id: {value:"G2S_all",required:true},
			device_class: {value:"G2S_all",required:true},
			device_id: {value:"-1",required:true},
            g2s_egm_evt_mngr: {type:"g2sEgmEventMngrConfig", required:true},
        },
        color:"#bfd8d8",
        inputs:0,
		outputs:1,
		paletteLabel:"OnEvent",
        icon: "xmlrpc.png",
        label: function() {
            return this.name||this.device_class + "/" + this.device_id + "/" + this.event_id||"onEvent";
		},
		oneditprepare: function(){
			let data_list = $("<datalist>").attr("id", "g2s_class_name_data_list");

			let sorted_classes = SUPPORTED_G2S_CLASSES;
			sorted_classes.sort(function(a,b){return a.value.localeCompare(b.value);});
			sorted_classes.forEach(function(item){
				data_list.append($("<option>").attr("value", item.value).text(item.text));
			});

			$("#g2s_class_name").append(data_list);
			$("#node-input-device_class").attr("list", "g2s_class_name_data_list");
		}
	});
	RED.nodes.registerType('g2sCtrlEGMEvent',{
        category: 'g2s',
        defaults: {
            name: {value:""},
            event_id: {value:"G2S_all",required:true},
			device_class: {value:"G2S_all",required:true},
			device_id: {value:"-1",required:true},
            g2s_egm_evt_mngr: {type:"g2sEgmEventMngrConfig", required:true},
        },
        color:"#bfd8d8",
        inputs:1,
		outputs:1,
		paletteLabel:"CtrlEvent",
        icon: "xmlrpc.png",
        label: function() {
            return this.name||this.device_class + "/" + this.device_id + "/" + this.event_id||"CtrlEvent";
		},
		oneditprepare: function(){
			let data_list = $("<datalist>").attr("id", "g2s_class_name_data_list");

			let sorted_classes = SUPPORTED_G2S_CLASSES;
			sorted_classes.sort(function(a,b){return a.value.localeCompare(b.value);});
			sorted_classes.forEach(function(item){
				data_list.append($("<option>").attr("value", item.value).text(item.text));
			});

			$("#g2s_class_name").append(data_list);
			$("#node-input-device_class").attr("list", "g2s_class_name_data_list");
		}
    });
		
	RED.nodes.registerType('g2sEgmGameLinkMngrConfig',{
        category: 'config',
        defaults: {
			name: {value:""},

			use_mqtt: {value:false, required:false},

			xmlrpc_client_config: {type:"xmlrpc-client", required:false},
			xmlrpc_server_config: {type:"xmlrpc-server", required:false},

			mqtt_config: {type:"mqtt-broker", required:false},
			mqtt_egm_group: {type:"g2sEGMGroupConfig", required:false},
            mqtt_qos: {value:"", required:false},
			mqtt_retain: {value:false, required:false},
        },
        label: function() {
            return this.name||"";
		},
		oneditprepare: function(){
			function switchToMqttConfig(){
				$("#egm_xmlrpc_config").hide();
				$("#egm_mqtt_config").show();
			}

			function switchToXmlRpcConfig(){
				$("#egm_mqtt_config").hide();
				$("#egm_xmlrpc_config").show();
			}

			if(this.use_mqtt)
				switchToMqttConfig();
			else
				switchToXmlRpcConfig();

			$("#node-config-input-use_mqtt").click(function(){
				if($(this).is(':checked'))
					switchToMqttConfig();
				else
					switchToXmlRpcConfig();
			});
		}
    });
    
	RED.nodes.registerType('g2sOnEGMGameLinkTopic',{
        category: 'g2s',
        defaults: {
            name: {value:""},
            topic: {value:"",required:true},
			g2s_egm_gl_topic_mngr: {type:"g2sEgmGameLinkMngrConfig", required:true},
        },
        color:"#bfd8d8",
        inputs:0,
		outputs:1,
		paletteLabel:"onGLMsg",
        icon: "xmlrpc.png",
        label: function() {
            return this.topic || "onGLHostMsg";
		}
	});
	
	RED.nodes.registerType('g2sCtrlGameLinkTopic',{
        category: 'g2s',
        defaults: {
            name: {value:""},
            topic: {value:"G2S_all",required:true},			
            g2s_egm_evt_mngr: {type:"g2sEgmEventMngrConfig", required:true},
        },
        color:"#bfd8d8",
        inputs:1,
		outputs:1,
		paletteLabel:"CtrlGLMsg",
        icon: "xmlrpc.png",
        label: function() {
            return this.topic || "CtrlGLHostMsg";
		}
    });
	
	RED.nodes.registerType('EMDIMsg',{
        category: 'g2s',
        color: '#FFCC66', 
		defaults: {
			label_name: {value:"", required:false},
			to_xml: {value: ""},
		},		
        inputs:1,
        outputs:1,
		align:"left",
        icon: "template.png",
		paletteLabel:"EMDIMsg",
        label:function(){
			if(this.label_name)
				return this.label_name;
			
			return "EMDI Msg";
		}
	});
	
	function onG2SDataTypeHelpChange(){
		let helper_panel = $("#g2s_data_type_help_panel");
		helper_panel.html("");
		let current_val = $("#node-input-g2s_data_type_help").val();
		if(current_val != "")
			g2sDataMap.get(current_val).helper(helper_panel);
	}
	function onG2SActionClassHelpChange(){
		let current_class_val = $("#node-input-class_name_helper").val();
		
		let action_select = $("#node-input-class_action_helper");
			
		action_select.html("");
		
		if(current_class_val != ""){
			let class_actions = classActionMap.get(current_class_val);

			if(class_actions){
				let sorted_actions_ids = Array.from(class_actions.keys()).sort();
				sorted_actions_ids.forEach(function(value){
					action_select.append(new Option(value, value, false));
				});
				
				action_select.val(sorted_actions_ids[0]).change();
			}
		}
	}
	function onG2SActionTypeHelpChange(){
		let helper_panel = $("#g2s_action_type_help_panel");
		helper_panel.html("");
		
		let current_action_val = $("#node-input-class_action_helper").val();
		let current_class_val = $("#node-input-class_name_helper").val();
		
		let helper_f = classActionMap.get(current_class_val).get(current_action_val).helper;
		if(helper_f !== undefined)
			helper_f(helper_panel);
	}
</script>

<script type="text/x-red" data-template-name="g2sEGMGroupConfig">
	<div class="form-row">
        <label for="node-config-input-name"><i class="fa fa-tag"></i>  Name</label>
        <input type="text" id="node-config-input-name">
    </div>
	<div class="form-row">
		<label for="node-config-input-group_name"><i class="icon-tag"></i> Group Name</label>
		<input type="text" id="node-config-input-group_name">
		<i style="display:inline-block;margin-right: 10px" id="egm_group_name_busy" class='fa fa-spinner fa-spin'></i>
		<p id="node-config-input-bad_group_name" style="display:none;color:red;"><small><i>Group name already used</i></small></p>
	</div>
	<div class="form-row">
		<label for="node-config-input-use_batch_egm_mngr"><i class="icon-tag"></i> Use EGM Manager</label>
		<input type="checkbox" id="node-config-input-use_batch_egm_mngr" style="display:inline-block; width:auto; vertical-align:top;"></input>
	</div>
	<div id="batch_egm_mngr_utils" style="display:none">		
		<div>
			<div class="form-row">
				<label for="node-config-input-mqtt_config"><i class="fa fa-globe"></i> MQTT Config</label>
				<input type="text" id="node-config-input-mqtt_config"></input>
			</div>
			<div class="form-row">
				<label for="node-config-input-egm_config_name"><i class="icon-tag"></i> EGM Config</label>				
				<select id="node-config-input-egm_config_name"></select>
				<i style="display:inline-block;margin-right: 10px" id="egm_config_name_busy" class='fa fa-spinner fa-spin'></i>
			</div>
			<div class="form-row">
				<label for="node-config-input-g2s_cc_override"><i class="icon-tag"></i> g2sCC</label>
				<input type="text" id="node-config-input-g2s_cc_override">
			</div>
			<div class="form-row">
				<label for="node-config-input-enroll_pki"><i class="icon-tag"></i> PKI</label>
				<input type="checkbox" id="node-config-input-enroll_pki" style="display:inline-block; width:auto; vertical-align:top;"></input>
			</div>
			<div class="form-row" id="pki_config" style="display:none">
				<div style="border-style: solid; border-width: 1px;border-radius: 4px;border-color: lightgray">
					<div style="margin:5px;">
						<h3>Public Key Infrastructure</h3>
						<div class="form-row">
							<i class="icon-tag"><small>NOTE To allow EGM group enrollement the NONCE MUST be set to have a single multiuse password</small></i>
						</div>
						<div class="form-row">
							<label for="node-config-input-pki_key_size"><i class="icon-tag"></i> Key size</label>
							<input type="number" id="node-config-input-pki_key_size"min="1" value="1"></input>
						</div>
						<div class="form-row">
							<label for="node-config-input-pki_scep_url"><i class="icon-tag"></i> SCEP Url</label>
							<input type="text" id="node-config-input-pki_scep_url">
						</div>
						<div class="form-row">
							<label for="node-config-input-pki_nonce"><i class="icon-tag"></i> Nonce</label>
							<input type="text" id="node-config-input-pki_nonce">
						</div>
					</div>
				</div>
			</div>
			<div style="border-style: solid; border-width: 1px;border-radius: 4px;border-color: lightgray">
				<div style="margin:5px">
					<div>
						<i><small>Below generation will request the batch egm manager to generate a list of EGM ids for the group.</small></i>
					</div>
					<div>
						<button id="generate_egm_list_button" type="submit" value="Generate" class="ui-button ui-widget ui-corner-all" style="width:120px;text-align:right;display:inline;margin-right:25px"><i style="display:none;margin-right: 10px" id="generate_egm_list_button_busy" class='fa fa-spinner fa-spin'></i>Generate</button>

						<label for="generate_egm_list_count" style="display:inline"><i class="icon-tag"></i> #</label>
						<input type="number" id="generate_egm_list_count" min="1" value="1" style="width:80px;display:inline"></input>
										
						<label for="generate_egm_list_gsa_prefix;" style="display:inline"><i class="icon-tag"></i> GSA Prefix</label>
						<input type="text" id="generate_egm_list_gsa_prefix" style="width:100px;display:inline">
					</div>
				</div>
			</div>
		</div>		
	</div>
	<h3>EGM List</h3>
    <div class="form-row">
        <ol id="node-config-egm_list_container"></ol>
	</div>		
</script>

<script type="text/x-red" data-help-name="g2sEGMGroupConfig">
    <p>Configuration Node to allow groups of EGM to be created. Groups of EGM can be created to allows flow to work on a 
	group of EGMs, rather than 1 EGM. Groups only work when the MQTT transport is used. When a group of EGMs is used with a node, 
	the flow will wait until all nodes are in sync after completing the specified node action</p>
	<h3>Inputs - Win Information</h3>
	<dl class="message-properties">
		<dt>Group Name
			<span class="property-type">String</span>
		</dt>
		<dd>Name of the EGM group. This is the name of the group for which the flows will sync too. If the EGM manager is used, this must be unique within the Node Red instance.</dd>
		<dt>Use EGM Manager
			<span class="property-type">Boolean</span>
		</dt>
		<dd>whether to use the EGM manager or not. If not using the EGM manager, the group will be assumed as already existing and running within the node red server instance. 
		If the EGM manager is to be used, the define EGM group will be started and stops with the flows.</dd>
		<dt>EGM List
			<span class="property-type">Array</span>
		</dt>
		<dd>This is the defined EGM group. Only used if the EGM manager is to be used with this group. This will define the EGM ids to start with the EGM group</dd>
	</dl>	
</script>

<script type="text/x-red" data-template-name="g2sRPCTransport">
	<div class="form-row">
        <label for="node-input-g2s_transport_name"><i class="fa fa-tag"></i> Name</label>
        <input type="text" id="node-input-g2s_transport_name">
	</div>
	<div class="form-row">
		<label for="node-input-save_to_flow"><i class="icon-tag"></i> Save as flow variable</label>
		<input type="checkbox" id="node-input-save_to_flow" style="display:inline-block; width:auto; vertical-align:top;"></input>
	</div>
	<div class="form-row">
		<label for="node-input-use_mqtt"><i class="icon-tag"></i> Use MQTT</label>
		<input type="checkbox" id="node-input-use_mqtt" style="display:inline-block; width:auto; vertical-align:top;"></input>
	</div>
	<div class="form-row" id="egm_mqtt_config">
		<h3>MQTT</h3>
		<div class="form-row">
			<div class="form-row">
				<label for="node-input-mqtt_config"><i class="fa fa-globe"></i> MQTT Config</label>
				<input type="text" id="node-input-mqtt_config"></input>
			</div>
			<div class="form-row">
				<label for="node-input-mqtt_egm_group"><i class="fa fa-globe"></i> EGM Group</label>
				<input type="text" id="node-input-mqtt_egm_group" style="display:inline-block; width:auto; vertical-align:top;"></input>
			</div>
			<div class="form-row">
				<label for="node-input-mqtt_qos"><i class="fa fa-empire"></i> QOs</label>
				<select id="node-input-mqtt_qos" style="width:125px !important">
					<option value=""></option>
					<option value="0">0</option>
					<option value="1">1</option>
					<option value="2">2</option>
				</select>
			</div>
			<div class="form-row">
				<label for="node-input-mqtt_retain"><i class="fa fa-empire"></i> Retain</label>
				<input type="checkbox" id="node-input-mqtt_retain" style="display:inline-block; width:auto; vertical-align:top;"></input>
			</div>
			<div class="form-row">
				<label for="node-input-sync_with_group"><i class="fa fa-globe"></i> Sync With EGM Group</label>
				<input type="checkbox" id="node-input-sync_with_group" style="display:inline-block; width:auto; vertical-align:top;"></input>
			</div>
			<div class="form-row">
				<label for="node-input-sync_with_group_timeout"><i class="fa fa-tag"></i> Sync timeout</label>
				<input type="number" id="node-input-sync_with_group_timeout" placeholder="5">
			</div>
		</div>
	</div>
	<div class="for-row" id="egm_xmlrpc_config">
		<h3>XML-RPC</h3>
		<div class="form-row">
			<label for="node-input-xmlrpc_config"><i class="fa fa-globe"></i> XML-RPC Config</label>
			<input type="text" id="node-input-xmlrpc_config"></input>
		</div>
	</div>
</script>

<script type="text/x-red" data-help-name="g2sRPCTransport">
	<p>G2S RPC Transport node allows the flow to define which transport to use for the flow. By default each g2s node an define which transport to use for it's action. 
	If the traneport is not using the default transport, it can be tedious to configure each node. Using the transport node allows the transport to be defined once for the 
	flow. This node can also be configured to be used for the entire tab flows.</p>
	<h3>Inputs</h3>
	<dl class="message-properties">
		<dt>Save as flow variable
			<span class="property-type">Boolean</span>
		</dt>
		<dd>When saved as flow variable all nodes within the same flow tab will use this transport definition</dd>
		<dt>Use MQTT
			<span class="property-type">Boolean</span>
		</dt>
		<dd>Whether to use the MQTT as the transport. Usually used with groupd of EGM. NOTE to use this transport an MQTT broker must exist on the network</dd>
	</dl>
	<h3>XML-RPC Configuration</h3>
	<dl class="message-properties">
		<dt>XML-RPC Configuration
			<span class="property-type">Configuration</span>
		</dt>
		<dd>Node is documented within the xml-rpc client node.</dd>
	</dl>
	<h3>MQTT Configuration</h3>
	<dl class="message-properties">
		<dt>MQTT Configuration
			<span class="property-type">Configuration</span>
		</dt>
		<dd>Node is documented within the MQTT client node.</dd>
		<dt>EGM Group Configuration
			<span class="property-type">Configuration</span>
		</dt>
		<dd>Defines the EGM group this transport is to sync with</dd>
		<dt>QOs
			<span class="property-type">Integer</span>
		</dt>
		<dd>Quality of service for the messages sent through this transport. See MQTT client node for more detail</dd>
		<dt>Retain
			<span class="property-type">Boolean</span>
		</dt>
		<dd>whetehr the transport should send message witth he retain flag. See MQTT client node for more detail</dd>
		<dt>Sync With EGM Group
			<span class="property-type">Boolean</span>
		</dt>
		<dd>Whether the transport should try to synchronize with the entire EGM group. If true, then the flow will halt until all EGMs have completed teh specified node action</dd>
		<dt>Sync Tiemout
			<span class="property-type">Integer</span>
		</dt>
		<dd>Number of seconds to wait for the EGM group to be in sync before failing and continuing the flow</dd>
	</dl>
</script>

<script type="text/x-red" data-template-name="g2sActionData">
	<div class="form-row">
		<label for="node-input-g2s_data_type"><i class="icon-tag"></i> Data Type</label>
        <select id="node-input-g2s_data_type"></select>
	</div>
	<div class="form-row">
        <label for="node-input-g2s_date_type_name"><i class="fa fa-tag"></i> Name</label>
        <input type="text" id="node-input-g2s_date_type_name">
    </div>
	<div id="g2s_action_data_type_panel" style="border: 3px solid lightgray; border-radius: 8px;padding: 8px;e"></div>
</script>

<script type="text/x-red" data-help-name="g2sActionData">
    <p>Node allows to predefine some G2S data to be used by subsequent nodes in the flow. Select of the data points for more information</p>
	<div class="form-row">
		<label for="node-input-g2s_data_type_help"><i class="icon-tag"></i> Data Type</label>
        <select id="node-input-g2s_data_type_help" onchange="onG2SDataTypeHelpChange()">
			<option value="">Choose...</option>
			<option value="game_info">Game Info</option>
			<option value="device_info">Device Info</option>					
		</select>
	</div>		
	<div id="g2s_data_type_help_panel"></div>	
</script>

<script type="text/x-red" data-template-name="g2sAction">
	<div class="form-row">
		<label for="node-input-class_name"><i class="icon-tag"></i> Class</label>
        <select id="node-input-class_name"></select>
	</div>
	<div class="form-row">
		<label for="node-input-class_action"><i class="icon-tag"></i> Action</label>
        <select id="node-input-class_action"></select>
	</div>
	<div class="form-row">
        <label for="node-input-g2s_action_name"><i class="fa fa-tag"></i> Name</label>
        <input type="text" id="node-input-g2s_action_name">
    </div>
	<div id="class_action_data_panel" style="border: 3px solid lightgray; border-radius: 8px;padding: 8px;e"></div>
	<div style="border: 3px solid lightgray; border-radius: 8px;padding: 8px;margin-top: 20px">
		<h3>Transport Information</h3>
		<div class="form-row">
			<label for="node-input-use_this_transport"><i class="icon-tag"></i> Use This transport</label>
			<input type="checkbox" id="node-input-use_this_transport" style="display:inline-block; width:auto; vertical-align:top;"></input>
		</div>
		<div class="form-row">
			<label for="node-input-use_mqtt"><i class="icon-tag"></i> Use MQTT</label>
			<input type="checkbox" id="node-input-use_mqtt" style="display:inline-block; width:auto; vertical-align:top;"></input>
		</div>
		<div class="form-row" id="egm_mqtt_config">
			<h3>MQTT</h3>
			<div class="form-row">
				<div class="form-row">
					<label for="node-input-mqtt_config"><i class="fa fa-globe"></i> MQTT Config</label>
					<input type="text" id="node-input-mqtt_config"></input>
				</div>
				<div class="form-row">
					<label for="node-input-mqtt_egm_group"><i class="fa fa-globe"></i> EGM Group</label>
					<input type="text" id="node-input-mqtt_egm_group" style="display:inline-block; width:auto; vertical-align:top;"></input>
				</div>
				<div class="form-row">
					<label for="node-input-mqtt_qos"><i class="fa fa-empire"></i> QOs</label>
					<select id="node-input-mqtt_qos" style="width:125px !important">
						<option value=""></option>
						<option value="0">0</option>
						<option value="1">1</option>
						<option value="2">2</option>
					</select>
				</div>
				<div class="form-row">
					<label for="node-input-mqtt_retain"><i class="fa fa-empire"></i> Retain</label>
					<input type="checkbox" id="node-input-mqtt_retain" style="display:inline-block; width:auto; vertical-align:top;"></input>
				</div>
				<div class="form-row">
					<label for="node-input-sync_with_group"><i class="icon-tag"></i> Sync With EGM Group</label>
					<input type="checkbox" id="node-input-sync_with_group" style="display:inline-block; width:auto; vertical-align:top;"></input>
				</div>
				<div class="form-row">
					<label for="node-input-sync_with_group_timeout"><i class="fa fa-tag"></i> Sync timeout</label>
					<input type="number" id="node-input-sync_with_group_timeout" placeholder="5">
				</div>
			</div>
		</div>
		<div class="for-row" id="egm_xmlrpc_config">
			<h3>XML-RPC</h3>
			<div class="form-row">
				<label for="node-input-xmlrpc_config"><i class="fa fa-globe"></i> XML-RPC Config</label>
				<input type="text" id="node-input-xmlrpc_config"></input>
			</div>
		</div>
	</div>
</script>

<script type="text/x-red" data-help-name="g2sAction">
    <p>G2S Action node will call the associated RPC method within the running G2S engine(s). The node will send the associated data and return any 
	result back from the G2S engine.</p>
	<p>When the MQTT transport and an EGM group is associated with it, the node may be configured to wait for all EGMs to complete the action.</p>
	<p>For detailed action documentation, select the action to view.</p>
	<p>See G2S Transport documentation for details on the node's transport configuration</p>
	<div class="form-row">
		<label for="node-input-class_name_helper"><i class="icon-tag"></i> Class</label>
        <select id="node-input-class_name_helper" onchange="onG2SActionClassHelpChange()">
			<option value="">Choose...</option>
			<option value="Certificates">Certificates</option>
			<option value="Common">Common</option>
			<option value="G2S_adr">G2S_adr</option>
			<option value="G2S_bonus">G2S_bonus</option>
			<option value="G2S_cabinet">G2S_cabinet</option>
			<option value="G2S_coinAcceptor">G2S_coinAcceptor</option>
			<option value="G2S_communications">G2S_communications</option>
			<option value="G2S_gameLink">G2S_gameLink</option>
			<option value="G2S_gamePlay">G2S_gamePlay</option>
			<option value="G2S_idReader">G2S_idReader</option>
			<option value="G2S_mystery">G2S_mystery</option>
			<option value="G2S_noteAcceptor">G2S_noteAcceptor</option>
			<option value="G2S_printer">G2S_printer</option>
			<option value="G2S_spc">G2S_spc</option>
			<option value="G2S_voucher">G2S_voucher</option>
			<option value="IGT_mediaDisplay">IGT_mediaDisplay</option>
			<option value="Sim Banker">Sim Banker</option>		
		</select>
	</div>
	<div class="form-row">
		<label for="node-input-class_action_helper"><i class="icon-tag"></i> Action</label>
        <select id="node-input-class_action_helper" onchange="onG2SActionTypeHelpChange()"></select>
	</div>
	<div id="g2s_action_type_help_panel"></div>
</script>

<script type="text/x-red" data-template-name="g2sEgmEventMngrConfig">
	<div class="form-row">
        <label for="node-config-input-name"><i class="fa fa-tag"></i> Name</label>
        <input type="text" id="node-config-input-name">
	</div>
	<div class="form-row">
		<label for="node-config-input-use_mqtt"><i class="icon-tag"></i> Use MQTT</label>
		<input type="checkbox" id="node-config-input-use_mqtt" style="display:inline-block; width:auto; vertical-align:top;"></input>
	</div>
	<div class="form-row" id="egm_mqtt_config">
		<h3>MQTT</h3>
		<div class="form-row">
			<div class="form-row">
				<label for="node-config-input-mqtt_config"><i class="fa fa-globe"></i> MQTT Config</label>
				<input type="text" id="node-config-input-mqtt_config"></input>
			</div>
			<div class="form-row">
				<label for="node-config-input-mqtt_egm_group"><i class="fa fa-globe"></i> EGM Group</label>
				<input type="text" id="node-config-input-mqtt_egm_group"></input>
			</div>
			<div class="form-row">
				<label for="node-config-input-mqtt_qos"><i class="fa fa-empire"></i> QOs</label>
				<select id="node-config-input-mqtt_qos" style="width:125px !important">
					<option value=""></option>
					<option value="0">0</option>
					<option value="1">1</option>
					<option value="2">2</option>
				</select>
			</div>
			<div class="form-row">
				<label for="node-config-input-mqtt_qos"><i class="fa fa-empire"></i> Retain</label>
				<div class="form-row">
					<label for="node-input-mqtt_retain"><i class="fa fa-empire"></i> Retain</label>
					<input type="checkbox" id="node-input-mqtt_retain" style="display:inline-block; width:auto; vertical-align:top;"></input>
				</div>
			</div>
		</div>
	</div>
	<div class="for-row" id="egm_xmlrpc_config">
		<h3>XML-RPC</h3>
		<div class="form-row">
			<label for="node-config-input-xmlrpc_server_config"><i class="fa fa-globe"></i> EGM XML-RPC Server</label>
			<input type="text" id="node-config-input-xmlrpc_server_config"></input>
		</div>
		<div class="form-row">
			<label for="node-config-input-xmlrpc_client_config"><i class="fa fa-globe"></i> XML-RPC Config</label>
			<input type="text" id="node-config-input-xmlrpc_client_config"></input>
		</div>
	</div>
</script>

<script type="text/x-red" data-help-name="g2sEgmEventMngrConfig">
	<p>EGM Event manager manages the event code subscription for the EGM(s) using the specified transport. If MQTT is used, an MQTT Broker must be running 
	within the network. Using MQTT can allow registering to multiple EGMs within the specified EGM group.</p>
	<h3>Inputs</h3>
	<dl class="message-properties">
		<dt>Use MQTT
			<span class="property-type">Boolean</span>
		</dt>
		<dd>Whether to use the MQTT as the transport. Usually used with groupd of EGM. NOTE to use this transport an MQTT broker must exist on the network</dd>
	</dl>
	<h3>XML-RPC Configuration</h3>
	<dl class="message-properties">
		<dt>XML-RPC Server
			<span class="property-type">Configuration</span>
		</dt>
		<dd>Defines teh XML RC server, this is where the EGM will send events which are registered to. It is recommended to have 1 seperate server per running EGM client</dd>
		<dt>XML-RPC Client
			<span class="property-type">Configuration</span>
		</dt>
		<dd>The XML RPC configuration for the EGM itself</dd>
	</dl>
	<h3>MQTT Configuration</h3>
	<dl class="message-properties">
		<dt>MQTT Configuration
			<span class="property-type">Configuration</span>
		</dt>
		<dd>Node is documented within the MQTT client node.</dd>
		<dt>EGM Group Configuration
			<span class="property-type">Configuration</span>
		</dt>
		<dd>Defines the EGM group this transport is to sync with</dd>
		<dt>QOs
			<span class="property-type">Integer</span>
		</dt>
		<dd>Quality of service for the messages sent through this transport. See MQTT client node for more detail</dd>
		<dt>Retain
			<span class="property-type">Boolean</span>
		</dt>
		<dd>whetehr the transport should send message witth he retain flag. See MQTT client node for more detail</dd>
		<dt>Sync With EGM Group
			<span class="property-type">Boolean</span>
		</dt>
		<dd>Whether the transport should try to synchronize with the entire EGM group. If true, then the flow will halt until all EGMs have completed teh specified node action</dd>
		<dt>Sync Tiemout
			<span class="property-type">Integer</span>
		</dt>
		<dd>Number of seconds to wait for the EGM group to be in sync before failing and continuing the flow</dd>
	</dl>
</script>

<script type="text/x-red" data-template-name="g2sOnEGMEvent">
    <div class="form-row">
        <label for="node-input-g2s_egm_evt_mngr"><i class="fa fa-globe"></i> Event Manager</label>
        <input type="text" id="node-input-g2s_egm_evt_mngr">
    </div>
    <div class="form-row">
        <label for="node-input-event_id"><i class="fa fa-tasks"></i> Event</label>
        <input type="text" id="node-input-event_id">
    </div>
	<div id="g2s_class_name" class="form-row">
		<label for="node-input-device_class"><i class="fa fa-tasks"></i> Class Name</label>
        <input type="text" id="node-input-device_class">
    </div>
	<div class="form-row">
        <label for="node-input-device_id"><i class="fa fa-tasks"></i> Device Id</label>
        <input type="number" id="node-input-device_id">
    </div>
    <div class="form-row">
        <label for="node-input-name"><i class="fa fa-tag"></i> Name</label>
        <input type="text" id="node-input-name">
    </div>
</script>

<script type="text/x-red" data-help-name="g2sOnEGMEvent">
    <p>Registers to be notified of G2S Events as they occur in the EGM</p>
	<h3>Inputs</h3>
	<dl class="message-properties">
		<dt>Event Manager
			<span class="property-type">Config Item</span>
		</dt>
		<dd>Which EGM Manager to use. The EGM manager manages subsciptions for a specific EGM or group depending on the manager configuration</dd>
		<dt>Event
			<span class="property-type">String</span>
		</dt>
		<dd>Event code to register to. This is the G2S event code to register too. Wildcard (G2S_all) can be used to register to all events within a class and device</dd>
		<dt>Class Name
			<span class="property-type">String</span>
		</dt>
		<dd>G2S class name to register for the event code from the specified device. Wildcard (G2S_all) can be used to specify all classes</dd>
		<dt>Device id
			<span class="property-type">Integer</span>
		</dt>
		<dd>G2S device Id to register for the vent code. Wildcard (-1) can bwe used to register to all device wihtin the specified class</dd>
	</dl>
</script>

<script type="text/x-red" data-template-name="g2sCtrlEGMEvent">
    <div class="form-row">
        <label for="node-input-g2s_egm_evt_mngr"><i class="fa fa-globe"></i> Event Manager</label>
        <input type="text" id="node-input-g2s_egm_evt_mngr">
    </div>
    <div class="form-row">
        <label for="node-input-event_id"><i class="fa fa-tasks"></i> Event</label>
        <input type="text" id="node-input-event_id">
    </div>
	<div id="g2s_class_name" class="form-row">
		<label for="node-input-device_class"><i class="fa fa-tasks"></i> Class Name</label>
        <input type="text" id="node-input-device_class">
    </div>
	<div class="form-row">
        <label for="node-input-device_id"><i class="fa fa-tasks"></i> Device Id</label>
        <input type="number" id="node-input-device_id">
    </div>
    <div class="form-row">
        <label for="node-input-name"><i class="fa fa-tag"></i> Name</label>
        <input type="text" id="node-input-name">
    </div>
</script>

<script type="text/x-red" data-help-name="g2sCtrlEGMEvent">
    <p>Registers to be notified of G2S Events as they occur in the EGM. This node only starts to observer when a message with the payload 
	'start' is send to the node, and can be told to stop observing the event by sending it a message with a payload of 'stop'.</p>
	<h3>Inputs</h3>
	<dl class="message-properties">
		<dt>Event Manager
			<span class="property-type">Config Item</span>
		</dt>
		<dd>Which EGM Manager to use. The EGM manager manages subsciptions for a specific EGM or group depending on the manager configuration</dd>
		<dt>Event
			<span class="property-type">String</span>
		</dt>
		<dd>Event code to register to. This is the G2S event code to register too. Wildcard (G2S_all) can be used to register to all events within a class and device</dd>
		<dt>Class Name
			<span class="property-type">String</span>
		</dt>
		<dd>G2S class name to register for the event code from the specified device. Wildcard (G2S_all) can be used to specify all classes</dd>
		<dt>Device id
			<span class="property-type">Integer</span>
		</dt>
		<dd>G2S device Id to register for the vent code. Wildcard (-1) can bwe used to register to all device wihtin the specified class</dd>
	</dl>
</script>

<script type="text/x-red" data-template-name="g2sEgmGameLinkMngrConfig">
	<div class="form-row">
        <label for="node-config-input-name"><i class="fa fa-tag"></i> Name</label>
        <input type="text" id="node-config-input-name">
	</div>
	<div class="form-row">
		<label for="node-config-input-use_mqtt"><i class="icon-tag"></i> Use MQTT</label>
		<input type="checkbox" id="node-config-input-use_mqtt" style="display:inline-block; width:auto; vertical-align:top;"></input>
	</div>
	<div class="form-row" id="egm_mqtt_config">
		<h3>MQTT</h3>
		<div class="form-row">
			<div class="form-row">
				<label for="node-config-input-mqtt_config"><i class="fa fa-globe"></i> MQTT Config</label>
				<input type="text" id="node-config-input-mqtt_config"></input>
			</div>
			<div class="form-row">
				<label for="node-config-input-mqtt_egm_group"><i class="fa fa-globe"></i> EGM Group</label>
				<input type="text" id="node-config-input-mqtt_egm_group"></input>
			</div>
			<div class="form-row">
				<label for="node-config-input-mqtt_qos"><i class="fa fa-empire"></i> QOs</label>
				<select id="node-config-input-mqtt_qos" style="width:125px !important">
					<option value=""></option>
					<option value="0">0</option>
					<option value="1">1</option>
					<option value="2">2</option>
				</select>
			</div>
			<div class="form-row">
				<label for="node-config-input-mqtt_qos"><i class="fa fa-empire"></i> Retain</label>
				<div class="form-row">
					<label for="node-input-mqtt_retain"><i class="fa fa-empire"></i> Retain</label>
					<input type="checkbox" id="node-input-mqtt_retain" style="display:inline-block; width:auto; vertical-align:top;"></input>
				</div>
			</div>
		</div>
	</div>
	<div class="for-row" id="egm_xmlrpc_config">
		<h3>XML-RPC</h3>
		<div class="form-row">
			<label for="node-config-input-xmlrpc_server_config"><i class="fa fa-globe"></i> EGM XML-RPC Server</label>
			<input type="text" id="node-config-input-xmlrpc_server_config"></input>
		</div>
		<div class="form-row">
			<label for="node-config-input-xmlrpc_client_config"><i class="fa fa-globe"></i> XML-RPC Config</label>
			<input type="text" id="node-config-input-xmlrpc_client_config"></input>
		</div>
	</div>
</script>

<script type="text/x-red" data-help-name="g2sEgmGameLinkMngrConfig">
    <p>Used to listen to specific Link Game Topics from the EGM's Link Game G2S class support. </p>
	<h3>Inputs</h3>
	<dl class="message-properties">
		<dt>Use MQTT
			<span class="property-type">Boolean</span>
		</dt>
		<dd>Whether to use the MQTT as the transport. Usually used with groupd of EGM. NOTE to use this transport an MQTT broker must exist on the network</dd>
	</dl>
	<h3>XML-RPC Configuration</h3>
	<dl class="message-properties">
		<dt>XML-RPC Server
			<span class="property-type">Configuration</span>
		</dt>
		<dd>Defines teh XML RC server, this is where the EGM will send events which are registered to. It is recommended to have 1 seperate server per running EGM client</dd>
		<dt>XML-RPC Client
			<span class="property-type">Configuration</span>
		</dt>
		<dd>The XML RPC configuration for the EGM itself</dd>
	</dl>
	<h3>MQTT Configuration</h3>
	<dl class="message-properties">
		<dt>MQTT Configuration
			<span class="property-type">Configuration</span>
		</dt>
		<dd>Node is documented within the MQTT client node.</dd>
		<dt>EGM Group Configuration
			<span class="property-type">Configuration</span>
		</dt>
		<dd>Defines the EGM group this transport is to sync with</dd>
		<dt>QOs
			<span class="property-type">Integer</span>
		</dt>
		<dd>Quality of service for the messages sent through this transport. See MQTT client node for more detail</dd>
		<dt>Retain
			<span class="property-type">Boolean</span>
		</dt>
		<dd>whetehr the transport should send message witth he retain flag. See MQTT client node for more detail</dd>
		<dt>Sync With EGM Group
			<span class="property-type">Boolean</span>
		</dt>
		<dd>Whether the transport should try to synchronize with the entire EGM group. If true, then the flow will halt until all EGMs have completed teh specified node action</dd>
		<dt>Sync Tiemout
			<span class="property-type">Integer</span>
		</dt>
		<dd>Number of seconds to wait for the EGM group to be in sync before failing and continuing the flow</dd>
	</dl>
</script>

<script type="text/x-red" data-template-name="g2sOnEGMGameLinkTopic">
    <div class="form-row">
        <label for="node-input-g2s_egm_gl_topic_mngr"><i class="fa fa-globe"></i> GameLink Topic Manager</label>
        <input type="text" id="node-input-g2s_egm_gl_topic_mngr">
    </div>
    <div class="form-row">
        <label for="node-input-topic"><i class="fa fa-tasks"></i> Topic</label>
        <input type="text" id="node-input-topic">
    </div>	
    <div class="form-row">
        <label for="node-input-name"><i class="fa fa-tag"></i> Name</label>
        <input type="text" id="node-input-name">
    </div>
</script>

<script type="text/x-red" data-help-name="g2sOnEGMGameLinkTopic">
    <p>Registers to be notified of G2S Game Link messages for a specific topic. When a message is sent to the specified topic a message will be sent 
	with the payload containing the base64 encoded data sent by the sender</p>
	<h3>Inputs</h3>
	<dl class="message-properties">
		<dt>GameLink Topic Manager
			<span class="property-type">Config Item</span>
		</dt>
		<dd>Which EGM Manager to use. The EGM manager manages subsciptions for a specific EGM or group depending on the manager configuration</dd>
		<dt>Topic
			<span class="property-type">String</span>
		</dt>
		<dd>Topic to listen to</dd>		
	</dl>
</script>

<script type="text/x-red" data-template-name="g2sCtrlGameLinkTopic">
    <div class="form-row">
        <label for="node-input-g2s_egm_gl_topic_mngr"><i class="fa fa-globe"></i> Game Link Topic Manager</label>
        <input type="text" id="node-input-g2s_egm_gl_topic_mngr">
    </div>
    <div class="form-row">
        <label for="node-input-event_id"><i class="fa fa-tasks"></i> Topic</label>
        <input type="text" id="node-input-event_id">
    </div>
    <div class="form-row">
        <label for="node-input-name"><i class="fa fa-tag"></i> Name</label>
        <input type="text" id="node-input-name">
    </div>
</script>

<script type="text/x-red" data-help-name="g2sCtrlGameLinkTopic">
    <p>Registers to be notified of G2S Game Link messages for a specific topic. When a message is sent to the specified topic a message will be sent 
	with the payload containing the base64 encoded data sent by the sender.
	<br>This node only starts to observer when a message with the payload 
	'start' is send to the node, and can be told to stop observing the event by sending it a message with a payload of 'stop'.</p>
	<h3>Inputs</h3>
	<dl class="message-properties">
		<dt>GameLink Topic Manager
			<span class="property-type">Config Item</span>
		</dt>
		<dd>Which EGM Manager to use. The EGM manager manages subsciptions for a specific EGM or group depending on the manager configuration</dd>
		<dt>Topic
			<span class="property-type">String</span>
		</dt>
		<dd>Topic to listen to</dd>		
	</dl>
</script>


<script type="text/x-red" data-template-name="EMDIMsg">
	<div class="form-row">
        <label for="node-input-label_name"><i class="icon-tag"></i> Name</label>
        <input type="text" id="node-input-label_name" placeholder="">
	</div>	
	<div class="form-row">
		<label for="node-input-to_xml">To XML</label>
		<input type="checkbox" id="node-input-to_xml" style="display:inline-block; width:auto; vertical-align:top;">
	  </div>
</script>

<script type="text/x-red" data-help-name="EMDIMsg">
    <p>Converts the emdi msg from xml to json, or json to xml</p>
	<h3>Inputs</h3>
	<dl class="message-properties">		
		<dt>payload
			<span class="property-type">string</span>
		</dt>
		<dd>Content to be sent to the host. Supported types:</dd>
		<dt>XML</dt>
		<dt>Json</dt>
	</dl>
	<h3>Output</h3>
	<dl class="message-properties">
		<dt>payload
			<span class="property-type">string</span>
		</dt>
		<dd>payload to be sent as input to the websocket node</dd>
	</dl>
</script>